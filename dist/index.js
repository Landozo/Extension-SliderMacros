(()=>{"use strict";var e={208:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(601),o=t.n(r),a=t(314),s=t.n(a)()(o());s.push([e.id,'/* ============================================\n   SLIDER MACROS - SETTINGS PANEL STYLES\n   ============================================ */\n\n/* --- Settings Drawer Background --- */\n#slider_macros_settings .inline-drawer-content {\n    background: var(--SmartThemeBlurTintColor, rgba(0, 0, 0, 0.15));\n    padding: 12px;\n    border-radius: 0 0 8px 8px;\n}\n\n/* --- Toolbar --- */\n.slider_macros_toolbar {\n    margin-bottom: 12px;\n}\n\n.slider_macros_toolbar_row {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.slider_macros_toolbar_row>select {\n    flex: 1;\n    min-width: 0;\n}\n\n.slider_macros_toolbar_actions {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n}\n\n.slider_macros_toolbar_divider {\n    width: 1px;\n    height: 20px;\n    background: var(--SmartThemeBorderColor, #444);\n    margin: 0 4px;\n}\n\n/* --- Create Buttons --- */\n.slider_macros_create_row {\n    display: flex;\n    gap: 8px;\n    margin-bottom: 16px;\n}\n\n.slider_macros_btn_create {\n    flex: 1;\n    justify-content: center;\n    padding: 10px 16px;\n    border: 2px dashed var(--SmartThemeBorderColor, #555);\n    background: transparent;\n    transition: all 0.2s ease;\n}\n\n.slider_macros_btn_create_group {\n    border-color: var(--SmartThemeQuoteColor, #666);\n}\n\n.slider_macros_btn_create:hover {\n    border-color: var(--SmartThemeQuoteColor, #888);\n    background: rgba(255, 255, 255, 0.05);\n}\n\n/* --- Slider List --- */\n.slider_macros_list {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n\n.slider_macros_list .empty-message {\n    text-align: center;\n    opacity: 0.6;\n    font-size: 0.9em;\n    padding: 24px 16px;\n    border: 1px dashed var(--SmartThemeBorderColor, #444);\n    border-radius: 8px;\n    background: rgba(0, 0, 0, 0.2);\n}\n\n/* ============================================\n   COLLAPSIBLE SLIDER CARDS\n   ============================================ */\n\n.slider_macros_card {\n    background: var(--SmartThemeChatTintColor, rgba(20, 20, 30, 0.95));\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 8px;\n    overflow: hidden;\n    transition: border-color 0.2s ease, box-shadow 0.2s ease;\n}\n\n.slider_macros_card:hover {\n    border-color: var(--SmartThemeQuoteColor, #666);\n}\n\n/* --- Card Header (Always Visible) --- */\n.slider_macros_card_header {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    padding: 10px clamp(4px, 12px, 12px);\n    background: rgba(255, 255, 255, 0.03);\n    cursor: pointer;\n    user-select: none;\n}\n\n.slider_macros_card_header:hover {\n    background: rgba(255, 255, 255, 0.06);\n}\n\n/* Toggle Chevron */\n.slider_macros_card_toggle {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 20px;\n    flex-shrink: 0;\n}\n\n.slider_macros_card_chevron {\n    font-size: 0.85em;\n    color: var(--SmartThemeQuoteColor, #888);\n    transition: transform 0.2s ease;\n}\n\n.slider_macros_card[data-expanded="true"] .slider_macros_card_chevron {\n    transform: rotate(90deg);\n}\n\n/* Summary Info */\n.slider_macros_card_summary {\n    display: flex;\n    align-items: center;\n    gap: clamp(4px, 10px, 10px);\n    flex: 1;\n    min-width: 150px;\n    overflow: hidden;\n}\n\n.slider_macros_card_name {\n    font-weight: 600;\n    font-size: 0.95em;\n    color: var(--SmartThemeBodyColor, #eee);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.slider_macros_card_macro {\n    font-size: 0.8em;\n    color: var(--SmartThemeQuoteColor, #888);\n    font-family: monospace;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 2px 6px;\n    border-radius: 4px;\n    white-space: nowrap;\n}\n\n.slider_macros_card_macro:empty {\n    display: none;\n}\n\n.slider_macros_card_macro:not(:empty)::before {\n    content: \'{{\';\n}\n\n.slider_macros_card_macro:not(:empty)::after {\n    content: \'}}\';\n}\n\n.slider_macros_card_type_badge {\n    font-size: 0.7em;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    color: var(--SmartThemeQuoteColor, #777);\n    background: rgba(255, 255, 255, 0.08);\n    padding: 3px 8px;\n    border-radius: 10px;\n    white-space: nowrap;\n}\n\n/* Group Badge on Slider Cards */\n.slider_macros_card_group_badge {\n    display: none;\n    align-items: center;\n    gap: 4px;\n    font-size: 0.7em;\n    color: var(--SmartThemeEmColor, #7b9fcf);\n    background: rgba(100, 150, 220, 0.15);\n    padding: 3px 8px;\n    border-radius: 10px;\n    white-space: nowrap;\n    border: 1px solid rgba(100, 150, 220, 0.3);\n}\n\n.slider_macros_card_group_badge[data-visible="true"] {\n    display: flex;\n}\n\n.slider_macros_card_group_badge i {\n    font-size: 0.9em;\n    opacity: 0.8;\n}\n\n.slider_macros_card_group_name {\n    max-width: 100px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n/* Header Controls */\n.slider_macros_card_controls {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    flex-shrink: 0;\n}\n\n.slider_macros_toggle {\n    display: inline-flex;\n    align-items: center;\n    cursor: pointer;\n    width: auto;\n    margin: 0px;\n    padding-right: clamp(0px, 2px, 4px);\n}\n\n.slider_macros_toggle input[type="checkbox"] {\n    width: 16px;\n    height: 16px;\n    margin: 0;\n    padding: 0;\n}\n\n.slider_macros_btn_icon {\n    opacity: 0.5;\n    padding: 4px 6px;\n    min-width: unset;\n}\n\n.slider_macros_btn_icon:hover {\n    opacity: 1;\n}\n\n/* --- Card Body (Collapsible) --- */\n.slider_macros_card_body {\n    display: none;\n    padding: 12px;\n    border-top: 1px solid var(--SmartThemeBorderColor, #333);\n    background: rgba(0, 0, 0, 0.15);\n}\n\n.slider_macros_card[data-expanded="true"] .slider_macros_card_body {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n/* --- Field Styles --- */\n.slider_macros_field_group {\n    display: flex;\n    gap: 10px;\n}\n\n.slider_macros_field_group>.slider_macros_field {\n    flex: 2;\n    min-width: 120px;\n}\n\n.slider_macros_field_group>.slider_macros_field_wide {\n    flex: 3;\n    min-width: 180px;\n}\n\n.slider_macros_field {\n    display: flex;\n    flex-direction: column;\n    gap: 4px;\n}\n\n.slider_macros_field_row {\n    display: flex;\n    gap: 10px;\n}\n\n.slider_macros_field_compact {\n    flex: 1;\n    min-width: 0;\n}\n\n.slider_macros_field_half {\n    flex: 1;\n    min-width: 0;\n}\n\n.slider_macros_label {\n    font-size: 0.8em;\n    color: var(--SmartThemeQuoteColor, #aaa);\n    font-weight: 500;\n}\n\n.slider_macros_optional {\n    opacity: 0.6;\n    font-weight: 400;\n}\n\n/* Macro Variable Input with decorators */\n.slider_macros_macro_input_row {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.slider_macros_macro_input {\n    display: flex;\n    align-items: center;\n    gap: 0;\n    flex: 1;\n}\n\n.slider_macros_macro_input input {\n    flex: 1;\n    border-radius: 0;\n    text-align: center;\n    font-family: monospace;\n}\n\n.slider_macros_macro_prefix,\n.slider_macros_macro_suffix {\n    padding: 6px 8px;\n    background: rgba(0, 0, 0, 0.4);\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    font-family: monospace;\n    font-size: 0.9em;\n    color: var(--SmartThemeQuoteColor, #888);\n}\n\n.slider_macros_macro_prefix {\n    border-right: none;\n    border-radius: 4px 0 0 4px;\n}\n\n.slider_macros_macro_suffix {\n    border-left: none;\n    border-radius: 0 4px 4px 0;\n}\n\n.slider_macros_btn_search_macro {\n    flex-shrink: 0;\n    padding: 6px 10px;\n}\n\n.slider_macros_macro_status {\n    margin-top: 4px;\n    font-size: 0.85em;\n    min-height: 1.2em;\n}\n\n.slider_macros_macro_status.exists {\n    color: var(--SmartThemeQuoteColor, #f90);\n}\n\n.slider_macros_macro_status.exists::before {\n    content: "⚠ ";\n}\n\n.slider_macros_macro_status.available {\n    /*    color: var(--SmartThemeChatTintColor, #4a4); <-- Not working? -Lando */\n    color: var(--SmartThemeQuoteColor, #4a4);\n}\n\n.slider_macros_macro_status.available::before {\n    content: "✓ ";\n}\n\n.slider_macros_macro_status.protected {\n    color: #e74c3c;\n    font-weight: 600;\n}\n\n/* Variable Binding Section */\n.slider_macros_variable_input_row {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    width: 100%;\n    min-width: 0;\n}\n\n.slider_macros_variable_scope {\n    width: 90px;\n    min-width: 90px;\n    flex: 1;\n}\n\n.slider_macros_variable_input {\n    display: flex;\n    align-items: center;\n    flex: 2;\n    min-width: 0;\n    overflow: hidden;\n}\n\n.slider_macros_variable_input input {\n    width: 100%;\n    min-width: 0;\n    font-family: monospace;\n}\n\n.slider_macros_btn_search_variable,\n.slider_macros_btn_load_variable {\n    flex-shrink: 0;\n    padding: 6px 10px;\n}\n\n.slider_macros_variable_status {\n    margin-top: 4px;\n    font-size: 0.85em;\n    min-height: 1.2em;\n}\n\n.slider_macros_variable_status.found {\n    color: var(--SmartThemeQuoteColor, #4a4);\n}\n\n.slider_macros_variable_status.found::before {\n    content: "✓ ";\n}\n\n.slider_macros_variable_status.not-found {\n    color: var(--SmartThemeQuoteColor, #888);\n}\n\n.slider_macros_sync_toggle {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    cursor: pointer;\n}\n\n.slider_macros_sync_toggle input[type="checkbox"] {\n    width: clamp(10px, 16px, 16px);\n    height: clamp(10px, 16px, 16px);\n}\n\n.slider_macros_sync_hint {\n    font-size: 0.8em;\n    color: var(--SmartThemeQuoteColor, #888);\n    margin-top: 4px;\n}\n\n/* Variable config section (shown when sync is enabled) */\n.slider_macros_variable_config {\n    margin-top: 10px;\n    padding: 10px;\n    background: rgba(0, 0, 0, 0.2);\n    border-radius: 6px;\n    border: 1px solid var(--SmartThemeBorderColor, #333);\n    overflow: hidden;\n    width: 100%;\n    box-sizing: border-box;\n}\n\n/* Mode Toggle Buttons */\n.slider_macros_mode_toggle {\n    display: flex;\n    gap: 4px;\n}\n\n.slider_macros_mode_btn {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 6px;\n    padding: 6px 12px;\n    border-radius: 4px;\n    transition: all 0.2s ease;\n    opacity: 0.6;\n}\n\n.slider_macros_mode_btn.active {\n    opacity: 1;\n    background: var(--SmartThemeBlurTintColor, rgba(255, 255, 255, 0.1));\n    border-color: var(--SmartThemeQuoteColor, #888);\n}\n\n.slider_macros_mode_btn:hover {\n    opacity: 0.9;\n}\n\n.slider_macros_mode_hint {\n    font-size: 0.8em;\n    color: var(--SmartThemeQuoteColor, #888);\n    margin-top: 6px;\n}\n\n.slider_macros_mode_hint .macro-hint,\n.slider_macros_mode_hint .variable-hint {\n    display: none;\n}\n\n/* Force Sync Toggle */\n.slider_macros_force_sync_field {\n    margin-top: 10px;\n    padding-top: 10px;\n    border-top: 1px solid var(--SmartThemeBorderColor, #333);\n}\n\n.slider_macros_force_toggle {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    cursor: pointer;\n}\n\n.slider_macros_force_toggle input[type="checkbox"] {\n    width: clamp(10px, 16px, 16px);\n    height: clamp(10px, 16px, 16px);\n}\n\n/* Force create status color */\n.slider_macros_variable_status.force-create {\n    color: var(--SmartThemeQuoteColor, #f90);\n}\n\n/* Duplicate Button */\n.slider_macros_btn_duplicate {\n    color: var(--SmartThemeQuoteColor, #888);\n    transition: color 0.2s ease, background 0.2s ease;\n    margin-right: auto;\n}\n\n.slider_macros_btn_duplicate:hover {\n    color: var(--SmartThemeBodyColor, #fff);\n    background: rgba(255, 255, 255, 0.1);\n}\n\n/* Macro Search Popup */\n.slider_macros_search_container {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    min-width: 300px;\n    max-width: 600px;\n}\n\n.slider_macros_search_description {\n    font-size: 0.8em;\n    color: var(--SmartThemeQuoteColor, #aaa);\n    text-align: left;\n    padding: 10px 0px 0px 0px;\n    white-space: normal;\n    overflow-wrap: break-word;\n}\n\n.pulse_opacity {\n    animation: pulse_fade 2s infinite ease-in-out;\n    margin: 0;\n    white-space: normal;\n    overflow-wrap: break-word;\n}\n\n@keyframes pulse_fade {\n    0% {\n        opacity: 1;\n        /* Fully visible */\n    }\n\n    50% {\n        opacity: 0.5;\n        /* Half opacity at the midpoint */\n    }\n\n    100% {\n        opacity: 1;\n        /* Fully visible again */\n    }\n}\n\n.slider_macros_search_input_row {\n    display: flex;\n    gap: 8px;\n}\n\n.slider_macros_search_input_row input {\n    flex: 1;\n}\n\n.slider_macros_search_results {\n    max-height: 300px;\n    overflow-y: auto;\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 4px;\n    background: rgba(0, 0, 0, 0.2);\n}\n\n.slider_macros_search_result {\n    padding: 10px 12px;\n    cursor: pointer;\n    border-bottom: 1px solid var(--SmartThemeBorderColor, #333);\n    transition: background 0.15s ease;\n}\n\n.slider_macros_search_result:last-child {\n    border-bottom: none;\n}\n\n.slider_macros_search_result:hover {\n    background: rgba(255, 255, 255, 0.05);\n}\n\n.slider_macros_search_result_name {\n    font-family: monospace;\n    font-weight: 600;\n    color: var(--SmartThemeBodyColor, #fff);\n}\n\n.slider_macros_search_result_source {\n    font-size: 0.75em;\n    padding: 2px 6px;\n    border-radius: 3px;\n    margin-left: 8px;\n    background: rgba(100, 100, 255, 0.3);\n    color: var(--SmartThemeQuoteColor, #aaa);\n}\n\n.slider_macros_search_result_source.legacy {\n    background: rgba(255, 150, 50, 0.3);\n}\n\n.slider_macros_search_result_source.core {\n    background: rgba(100, 100, 255, 0.3);\n}\n\n.slider_macros_search_result_source.extension {\n    background: rgba(100, 200, 100, 0.3);\n}\n\n.slider_macros_search_result_source.variable {\n    background: rgba(200, 100, 200, 0.3);\n    color: var(--SmartThemeEmColor, #c9a);\n}\n\n.slider_macros_search_result.variable {\n    border-left: 3px solid rgba(200, 100, 200, 0.6);\n}\n\n.slider_macros_search_result_header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    flex-wrap: wrap;\n}\n\n.slider_macros_search_result_protected {\n    font-size: 0.7em;\n    padding: 2px 6px;\n    border-radius: 3px;\n    background: rgba(231, 76, 60, 0.3);\n    color: #e74c3c;\n    font-weight: 600;\n}\n\n.slider_macros_search_result.protected {\n    border-left: 3px solid rgba(231, 76, 60, 0.6);\n}\n\n/* .slider_macros_search_result_desc {\n    font-size: 0.85em;\n    color: var(--SmartThemeQuoteColor, #888);\n    margin-top: 4px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    text-align: left;\n} */\n\n.slider_macros_search_result_desc {\n    font-size: 0.85em;\n    color: var(--SmartThemeQuoteColor, #888);\n    margin-top: 4px;\n    text-align: left;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 2;\n    line-clamp: 2;\n    overflow: hidden;\n    line-height: 1.3;\n}\n\n.slider_macros_search_result_value {\n    font-size: 0.8em;\n    color: var(--SmartThemeChatTintColor, #4a4);\n    margin-top: 2px;\n    font-family: monospace;\n}\n\n.slider_macros_search_empty {\n    padding: 20px;\n    text-align: center;\n    color: var(--SmartThemeQuoteColor, #888);\n}\n\n/* Type sections */\n.slider_macros_type_section {\n    padding-top: 10px;\n    border-top: 1px dashed var(--SmartThemeBorderColor, #333);\n    margin-top: 4px;\n}\n\n/* Delete Row */\n.slider_macros_card_delete_row {\n    padding-top: 12px;\n    margin-top: 8px;\n    border-top: 1px solid var(--SmartThemeBorderColor, #333);\n    display: flex;\n    justify-content: flex-end;\n}\n\n.slider_macros_btn_danger_full {\n    color: var(--SmartThemeQuoteColor, #888);\n    transition: color 0.2s ease, background 0.2s ease;\n}\n\n.slider_macros_btn_danger_full:hover {\n    color: #e74c3c;\n    background: rgba(231, 76, 60, 0.1);\n}\n\n/* --- Disabled State --- */\n.slider_macros_card[data-disabled="true"] {\n    opacity: 0.5;\n}\n\n.slider_macros_card[data-disabled="true"] .slider_macros_card_header {\n    background: rgba(0, 0, 0, 0.1);\n}\n\n/* ============================================\n   COMPLETION PANEL SLIDER STYLES\n   ============================================ */\n\n.slider_macros_container .range-block {\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n    width: 100%;\n}\n\n.slider_macros_container .range-block-range-and-counter {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    width: 100%;\n}\n\n.slider_macros_container .range-block-range {\n    flex: 1;\n    width: 100%;\n    display: flex;\n    align-items: center;\n}\n\n.slider_macros_container .range-block-range input[type="range"] {\n    width: 100% !important;\n    margin: 0;\n    margin-right: 10px;\n    max-width: none;\n    flex-grow: 1;\n}\n\n.slider_macros_container .range-block-counter {\n    width: 60px;\n    min-width: 60px;\n    flex: 0 0 60px;\n    text-align: right;\n    display: flex;\n    justify-content: flex-end;\n}\n\n/* ============================================\n   DROPDOWN OPTIONS CONFIG (Settings Panel)\n   ============================================ */\n\n.slider_macros_dropdown_options {\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n    margin-bottom: 8px;\n}\n\n.slider_macros_dropdown_option_row {\n    display: flex;\n    align-items: flex-start;\n    gap: 6px;\n}\n\n.slider_macros_dropdown_key {\n    flex: 1;\n    min-width: 0;\n    margin-top: 6px; /* Align with first line of textarea */\n}\n\n.slider_macros_dropdown_arrow {\n    color: var(--SmartThemeQuoteColor, #888);\n    font-size: 0.9em;\n    flex-shrink: 0;\n    margin-top: 10px; /* Align with first line of textarea */\n}\n\n.slider_macros_dropdown_value {\n    flex: 1.5;\n    min-width: 0;\n    font-family: monospace;\n    resize: vertical;\n    min-height: 32px;\n    max-height: calc(4 * 1.4em + 16px); /* 4 lines max with padding */\n    line-height: 1.4;\n    overflow-y: auto;\n}\n\n.slider_macros_btn_remove_option {\n    opacity: 0.5;\n    padding: 4px 8px;\n    min-width: unset;\n    margin-top: 4px; /* Align with first line of textarea */\n    align-self: flex-start;\n}\n\n.slider_macros_btn_remove_option:hover {\n    opacity: 1;\n    color: #e74c3c;\n}\n\n.slider_macros_btn_add_option {\n    width: 100%;\n    justify-content: center;\n    padding: 6px 12px;\n    border: 1px dashed var(--SmartThemeBorderColor, #555);\n    background: transparent;\n    opacity: 0.7;\n}\n\n.slider_macros_btn_add_option:hover {\n    opacity: 1;\n    border-color: var(--SmartThemeQuoteColor, #888);\n}\n\n/* ============================================\n   COLOR INPUT CONFIG (Settings Panel)\n   ============================================ */\n\n.slider_macros_color_default {\n    width: 60px;\n    height: 32px;\n    padding: 2px;\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 4px;\n    cursor: pointer;\n}\n\n/* ============================================\n   COMPLETION PANEL - DROPDOWN SELECT\n   ============================================ */\n\n.slider_macros_dropdown_select {\n    width: 100%;\n    flex: 1;\n}\n\n/* ============================================\n   COMPLETION PANEL - COLOR PICKER\n   ============================================ */\n\n.slider_macros_color_wrapper {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 12px;\n    width: 100%;\n    padding: 8px 0;\n}\n\n.slider_macros_color_input {\n    width: 60px;\n    height: 36px;\n    padding: 2px;\n    border: 2px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 6px;\n    cursor: pointer;\n    flex-shrink: 0;\n    transition: border-color 0.2s ease, box-shadow 0.2s ease;\n}\n\n.slider_macros_color_input:hover {\n    border-color: var(--SmartThemeQuoteColor, #666);\n    box-shadow: 0 0 8px rgba(255, 255, 255, 0.1);\n}\n\n.slider_macros_color_hex {\n    width: 100px;\n    text-align: center;\n    font-family: monospace;\n    font-size: 1em;\n    text-transform: uppercase;\n    padding: 8px 12px;\n}\n\n/* ============================================\n   COMPLETION PANEL - CHECKBOX\n   ============================================ */\n\n.slider_macros_checkbox_label {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    cursor: pointer;\n}\n\n.slider_macros_checkbox_label input[type="checkbox"] {\n    width: 18px;\n    height: 18px;\n    cursor: pointer;\n}\n\n.slider_macros_checkbox_text {\n    font-weight: 500;\n    color: var(--SmartThemeBodyColor, #eee);\n}\n\n/* ============================================\n   SETTINGS PANEL - GROUP CARDS\n   ============================================ */\n\n.slider_macros_group_card {\n    background: var(--SmartThemeChatTintColor, rgba(20, 20, 30, 0.95));\n    border: 2px solid var(--SmartThemeQuoteColor, #666);\n    border-radius: 8px;\n    overflow: hidden;\n    transition: border-color 0.2s ease, box-shadow 0.2s ease;\n}\n\n.slider_macros_group_card:hover {\n    border-color: var(--SmartThemeBodyColor, #888);\n}\n\n.slider_macros_group_card_header {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    padding: 12px 14px;\n    background: rgba(255, 255, 255, 0.05);\n    cursor: pointer;\n    user-select: none;\n}\n\n.slider_macros_group_card_header:hover {\n    background: rgba(255, 255, 255, 0.08);\n}\n\n.slider_macros_group_card_summary {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    flex: 1;\n    min-width: 0;\n    overflow: hidden;\n}\n\n.slider_macros_group_icon {\n    color: var(--SmartThemeQuoteColor, #888);\n    font-size: 1em;\n}\n\n.slider_macros_group_card_name {\n    font-weight: 600;\n    font-size: 1em;\n    color: var(--SmartThemeBodyColor, #eee);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.slider_macros_group_card_count {\n    font-size: 0.85em;\n    color: var(--SmartThemeQuoteColor, #888);\n    white-space: nowrap;\n}\n\n.slider_macros_group_card[data-expanded="true"] .slider_macros_card_chevron {\n    transform: rotate(90deg);\n}\n\n.slider_macros_group_card_body {\n    display: none;\n    padding: 12px;\n    border-top: 1px solid var(--SmartThemeBorderColor, #333);\n    background: rgba(0, 0, 0, 0.15);\n}\n\n.slider_macros_group_card[data-expanded="true"] .slider_macros_group_card_body {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.slider_macros_group_sliders {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    margin-top: 8px;\n}\n\n/* ============================================\n   COMPLETION PANEL - COLLAPSIBLE GROUPS\n   ============================================ */\n\n.slider_macros_group {\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 8px;\n    margin-bottom: 8px;\n    overflow: hidden;\n    background: rgba(0, 0, 0, 0.1);\n}\n\n.slider_macros_group_header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 12px;\n    background: rgba(255, 255, 255, 0.03);\n    cursor: pointer;\n    user-select: none;\n    transition: background 0.2s ease;\n}\n\n.slider_macros_group_header:hover {\n    background: rgba(255, 255, 255, 0.06);\n}\n\n.slider_macros_group_chevron {\n    font-size: 0.85em;\n    color: var(--SmartThemeQuoteColor, #888);\n    transition: transform 0.2s ease;\n}\n\n.slider_macros_group[data-collapsed="true"] .slider_macros_group_chevron {\n    transform: rotate(-90deg);\n}\n\n.slider_macros_group_name {\n    font-weight: 600;\n    font-size: 0.95em;\n    color: var(--SmartThemeBodyColor, #eee);\n    flex: 1;\n}\n\n.slider_macros_group_count {\n    font-size: 0.8em;\n    color: var(--SmartThemeQuoteColor, #888);\n}\n\n.slider_macros_group_content {\n    padding: 8px;\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    border-top: 1px solid var(--SmartThemeBorderColor, #333);\n}\n\n.slider_macros_group[data-collapsed="true"] .slider_macros_group_content {\n    display: none;\n}',""]);const i=s},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",r=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),r&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),r&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,r,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);r&&s[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),n.push(d))}},n}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var n=[];function t(e){for(var t=-1,r=0;r<n.length;r++)if(n[r].identifier===e){t=r;break}return t}function r(e,r){for(var a={},s=[],i=0;i<e.length;i++){var l=e[i],c=r.base?l[0]+r.base:l[0],d=a[c]||0,u="".concat(c," ").concat(d);a[c]=d+1;var p=t(u),m={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)n[p].references++,n[p].updater(m);else{var f=o(m,r);r.byIndex=i,n.splice(i,0,{identifier:u,updater:f,references:1})}s.push(u)}return s}function o(e,n){var t=n.domAPI(n);t.update(e);return function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,o){var a=r(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var i=t(a[s]);n[i].references--}for(var l=r(e,o),c=0;c<a.length;c++){var d=t(a[c]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}a=l}}},659:e=>{var n={};e.exports=function(e,t){var r=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),n.styleTagTransform(r,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={id:r,exports:{}};return e[r](a,a.exports,t),a.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0;const r=Symbol.for("yaml.alias"),o=Symbol.for("yaml.document"),a=Symbol.for("yaml.map"),s=Symbol.for("yaml.pair"),i=Symbol.for("yaml.scalar"),l=Symbol.for("yaml.seq"),c=Symbol.for("yaml.node.type"),d=e=>!!e&&"object"==typeof e&&e[c]===r,u=e=>!!e&&"object"==typeof e&&e[c]===o,p=e=>!!e&&"object"==typeof e&&e[c]===a,m=e=>!!e&&"object"==typeof e&&e[c]===s,f=e=>!!e&&"object"==typeof e&&e[c]===i,_=e=>!!e&&"object"==typeof e&&e[c]===l;function g(e){if(e&&"object"==typeof e)switch(e[c]){case a:case l:return!0}return!1}function h(e){if(e&&"object"==typeof e)switch(e[c]){case r:case a:case i:case l:return!0}return!1}const v=e=>(f(e)||g(e))&&!!e.anchor,y=Symbol("break visit"),b=Symbol("skip children"),x=Symbol("remove node");function w(e,n){const t=k(n);if(u(e)){S(null,e.contents,t,Object.freeze([e]))===x&&(e.contents=null)}else S(null,e,t,Object.freeze([]))}function S(e,n,t,r){const o=N(e,n,t,r);if(h(o)||m(o))return O(e,r,o),S(e,o,t,r);if("symbol"!=typeof o)if(g(n)){r=Object.freeze(r.concat(n));for(let e=0;e<n.items.length;++e){const o=S(e,n.items[e],t,r);if("number"==typeof o)e=o-1;else{if(o===y)return y;o===x&&(n.items.splice(e,1),e-=1)}}}else if(m(n)){r=Object.freeze(r.concat(n));const e=S("key",n.key,t,r);if(e===y)return y;e===x&&(n.key=null);const o=S("value",n.value,t,r);if(o===y)return y;o===x&&(n.value=null)}return o}async function C(e,n){const t=k(n);if(u(e)){await E(null,e.contents,t,Object.freeze([e]))===x&&(e.contents=null)}else await E(null,e,t,Object.freeze([]))}async function E(e,n,t,r){const o=await N(e,n,t,r);if(h(o)||m(o))return O(e,r,o),E(e,o,t,r);if("symbol"!=typeof o)if(g(n)){r=Object.freeze(r.concat(n));for(let e=0;e<n.items.length;++e){const o=await E(e,n.items[e],t,r);if("number"==typeof o)e=o-1;else{if(o===y)return y;o===x&&(n.items.splice(e,1),e-=1)}}}else if(m(n)){r=Object.freeze(r.concat(n));const e=await E("key",n.key,t,r);if(e===y)return y;e===x&&(n.key=null);const o=await E("value",n.value,t,r);if(o===y)return y;o===x&&(n.value=null)}return o}function k(e){return"object"==typeof e&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function N(e,n,t,r){return"function"==typeof t?t(e,n,r):p(n)?t.Map?.(e,n,r):_(n)?t.Seq?.(e,n,r):m(n)?t.Pair?.(e,n,r):f(n)?t.Scalar?.(e,n,r):d(n)?t.Alias?.(e,n,r):void 0}function O(e,n,t){const r=n[n.length-1];if(g(r))r.items[e]=t;else if(m(r))"key"===e?r.key=t:r.value=t;else{if(!u(r)){const e=d(r)?"alias":"scalar";throw new Error(`Cannot replace node with ${e} parent`)}r.contents=t}}w.BREAK=y,w.SKIP=b,w.REMOVE=x,C.BREAK=y,C.SKIP=b,C.REMOVE=x;const T={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"};class L{constructor(e,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},L.defaultYaml,e),this.tags=Object.assign({},L.defaultTags,n)}clone(){const e=new L(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new L(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:L.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},L.defaultTags)}return e}add(e,n){this.atNextDocument&&(this.yaml={explicit:L.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},L.defaultTags),this.atNextDocument=!1);const t=e.trim().split(/[ \t]+/),r=t.shift();switch(r){case"%TAG":{if(2!==t.length&&(n(0,"%TAG directive should contain exactly two parts"),t.length<2))return!1;const[e,r]=t;return this.tags[e]=r,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==t.length)return n(0,"%YAML directive should contain exactly one part"),!1;const[e]=t;if("1.1"===e||"1.2"===e)return this.yaml.version=e,!0;return n(6,`Unsupported YAML version ${e}`,/^\d+\.\d+$/.test(e)),!1}default:return n(0,`Unknown directive ${r}`,!0),!1}}tagName(e,n){if("!"===e)return"!";if("!"!==e[0])return n(`Not a valid tag: ${e}`),null;if("<"===e[1]){const t=e.slice(2,-1);return"!"===t||"!!"===t?(n(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(">"!==e[e.length-1]&&n("Verbatim tags must end with a >"),t)}const[,t,r]=e.match(/^(.*!)([^!]*)$/s);r||n(`The ${e} tag has no suffix`);const o=this.tags[t];if(o)try{return o+decodeURIComponent(r)}catch(e){return n(String(e)),null}return"!"===t?e:(n(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[n,t]of Object.entries(this.tags))if(e.startsWith(t))return n+e.substring(t.length).replace(/[!,[\]{}]/g,(e=>T[e]));return"!"===e[0]?e:`!<${e}>`}toString(e){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],t=Object.entries(this.tags);let r;if(e&&t.length>0&&h(e.contents)){const n={};w(e.contents,((e,t)=>{h(t)&&t.tag&&(n[t.tag]=!0)})),r=Object.keys(n)}else r=[];for(const[o,a]of t)"!!"===o&&"tag:yaml.org,2002:"===a||e&&!r.some((e=>e.startsWith(a)))||n.push(`%TAG ${o} ${a}`);return n.join("\n")}}function I(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const n=JSON.stringify(e);throw new Error(`Anchor must not contain whitespace or control characters: ${n}`)}return!0}function M(e,n,t,r){if(r&&"object"==typeof r)if(Array.isArray(r))for(let n=0,t=r.length;n<t;++n){const t=r[n],o=M(e,r,String(n),t);void 0===o?delete r[n]:o!==t&&(r[n]=o)}else if(r instanceof Map)for(const n of Array.from(r.keys())){const t=r.get(n),o=M(e,r,n,t);void 0===o?r.delete(n):o!==t&&r.set(n,o)}else if(r instanceof Set)for(const n of Array.from(r)){const t=M(e,r,n,n);void 0===t?r.delete(n):t!==n&&(r.delete(n),r.add(t))}else for(const[n,t]of Object.entries(r)){const o=M(e,r,n,t);void 0===o?delete r[n]:o!==t&&(r[n]=o)}return e.call(n,t,r)}function A(e,n,t){if(Array.isArray(e))return e.map(((e,n)=>A(e,String(n),t)));if(e&&"function"==typeof e.toJSON){if(!t||!v(e))return e.toJSON(n,t);const r={aliasCount:0,count:1,res:void 0};t.anchors.set(e,r),t.onCreate=e=>{r.res=e,delete t.onCreate};const o=e.toJSON(n,t);return t.onCreate&&t.onCreate(o),o}return"bigint"!=typeof e||t?.keep?e:Number(e)}L.defaultYaml={explicit:!1,version:"1.2"},L.defaultTags={"!!":"tag:yaml.org,2002:"};class B{constructor(e){Object.defineProperty(this,c,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:n,maxAliasCount:t,onAnchor:r,reviver:o}={}){if(!u(e))throw new TypeError("A document argument is required");const a={anchors:new Map,doc:e,keep:!0,mapAsMap:!0===n,mapKeyWarned:!1,maxAliasCount:"number"==typeof t?t:100},s=A(this,"",a);if("function"==typeof r)for(const{count:e,res:n}of a.anchors.values())r(n,e);return"function"==typeof o?M(o,{"":s},"",s):s}}class F extends B{constructor(e){super(r),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let n;return w(e,{Node:(e,t)=>{if(t===this)return w.BREAK;t.anchor===this.source&&(n=t)}}),n}toJSON(e,n){if(!n)return{source:this.source};const{anchors:t,doc:r,maxAliasCount:o}=n,a=this.resolve(r);if(!a){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(e)}let s=t.get(a);if(s||(A(a,null,n),s=t.get(a)),!s||void 0===s.res){throw new ReferenceError("This should not happen: Alias anchor was not resolved?")}if(o>=0&&(s.count+=1,0===s.aliasCount&&(s.aliasCount=V(r,a,t)),s.count*s.aliasCount>o)){throw new ReferenceError("Excessive alias count indicates a resource exhaustion attack")}return s.res}toString(e,n,t){const r=`*${this.source}`;if(e){if(I(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(e)}if(e.implicitKey)return`${r} `}return r}}function V(e,n,t){if(d(n)){const r=n.resolve(e),o=t&&r&&t.get(r);return o?o.count*o.aliasCount:0}if(g(n)){let r=0;for(const o of n.items){const n=V(e,o,t);n>r&&(r=n)}return r}if(m(n)){const r=V(e,n.key,t),o=V(e,n.value,t);return Math.max(r,o)}return 1}const j=e=>!e||"function"!=typeof e&&"object"!=typeof e;class q extends B{constructor(e){super(i),this.value=e}toJSON(e,n){return n?.keep?this.value:A(this.value,e,n)}toString(){return String(this.value)}}q.BLOCK_FOLDED="BLOCK_FOLDED",q.BLOCK_LITERAL="BLOCK_LITERAL",q.PLAIN="PLAIN",q.QUOTE_DOUBLE="QUOTE_DOUBLE",q.QUOTE_SINGLE="QUOTE_SINGLE";const P="tag:yaml.org,2002:";function D(e,n,t){if(u(e)&&(e=e.contents),h(e))return e;if(m(e)){const n=t.schema[a].createNode?.(t.schema,null,t);return n.items.push(e),n}(e instanceof String||e instanceof Number||e instanceof Boolean||"undefined"!=typeof BigInt&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:r,onAnchor:o,onTagObj:s,schema:i,sourceObjects:c}=t;let d;if(r&&e&&"object"==typeof e){if(d=c.get(e),d)return d.anchor||(d.anchor=o(e)),new F(d.anchor);d={anchor:null,node:null},c.set(e,d)}n?.startsWith("!!")&&(n=P+n.slice(2));let p=function(e,n,t){if(n){const e=t.filter((e=>e.tag===n)),r=e.find((e=>!e.format))??e[0];if(!r)throw new Error(`Tag ${n} not found`);return r}return t.find((n=>n.identify?.(e)&&!n.format))}(e,n,i.tags);if(!p){if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),!e||"object"!=typeof e){const n=new q(e);return d&&(d.node=n),n}p=e instanceof Map?i[a]:Symbol.iterator in Object(e)?i[l]:i[a]}s&&(s(p),delete t.onTagObj);const f=p?.createNode?p.createNode(t.schema,e,t):"function"==typeof p?.nodeClass?.from?p.nodeClass.from(t.schema,e,t):new q(e);return n?f.tag=n:p.default||(f.tag=p.tag),d&&(d.node=f),f}function R(e,n,t){let r=t;for(let e=n.length-1;e>=0;--e){const t=n[e];if("number"==typeof t&&Number.isInteger(t)&&t>=0){const e=[];e[t]=r,r=e}else r=new Map([[t,r]])}return D(r,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}class G extends B{constructor(e,n){super(e),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(e){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(n.schema=e),n.items=n.items.map((n=>h(n)||m(n)?n.clone(e):n)),this.range&&(n.range=this.range.slice()),n}addIn(e,n){if((e=>null==e||"object"==typeof e&&!!e[Symbol.iterator]().next().done)(e))this.add(n);else{const[t,...r]=e,o=this.get(t,!0);if(g(o))o.addIn(r,n);else{if(void 0!==o||!this.schema)throw new Error(`Expected YAML collection at ${t}. Remaining path: ${r}`);this.set(t,R(this.schema,r,n))}}}deleteIn(e){const[n,...t]=e;if(0===t.length)return this.delete(n);const r=this.get(n,!0);if(g(r))return r.deleteIn(t);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${t}`)}getIn(e,n){const[t,...r]=e,o=this.get(t,!0);return 0===r.length?!n&&f(o)?o.value:o:g(o)?o.getIn(r,n):void 0}hasAllNullValues(e){return this.items.every((n=>{if(!m(n))return!1;const t=n.value;return null==t||e&&f(t)&&null==t.value&&!t.commentBefore&&!t.comment&&!t.tag}))}hasIn(e){const[n,...t]=e;if(0===t.length)return this.has(n);const r=this.get(n,!0);return!!g(r)&&r.hasIn(t)}setIn(e,n){const[t,...r]=e;if(0===r.length)this.set(t,n);else{const e=this.get(t,!0);if(g(e))e.setIn(r,n);else{if(void 0!==e||!this.schema)throw new Error(`Expected YAML collection at ${t}. Remaining path: ${r}`);this.set(t,R(this.schema,r,n))}}}}const U=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function Q(e,n){return/^\n+$/.test(e)?e.substring(1):n?e.replace(/^(?! *$)/gm,n):e}const z=(e,n,t)=>e.endsWith("\n")?Q(t,n):t.includes("\n")?"\n"+Q(t,n):(e.endsWith(" ")?"":" ")+t,K="flow",J="block",H="quoted";function W(e,n,t="flow",{indentAtStart:r,lineWidth:o=80,minContentWidth:a=20,onFold:s,onOverflow:i}={}){if(!o||o<0)return e;o<a&&(a=0);const l=Math.max(1+a,1+o-n.length);if(e.length<=l)return e;const c=[],d={};let u,p,m=o-n.length;"number"==typeof r&&(r>o-Math.max(2,a)?c.push(0):m=o-r);let f=!1,_=-1,g=-1,h=-1;t===J&&(_=Y(e,_,n.length),-1!==_&&(m=_+l));for(let r;r=e[_+=1];){if(t===H&&"\\"===r){switch(g=_,e[_+1]){case"x":_+=3;break;case"u":_+=5;break;case"U":_+=9;break;default:_+=1}h=_}if("\n"===r)t===J&&(_=Y(e,_,n.length)),m=_+n.length+l,u=void 0;else{if(" "===r&&p&&" "!==p&&"\n"!==p&&"\t"!==p){const n=e[_+1];n&&" "!==n&&"\n"!==n&&"\t"!==n&&(u=_)}if(_>=m)if(u)c.push(u),m=u+l,u=void 0;else if(t===H){for(;" "===p||"\t"===p;)p=r,r=e[_+=1],f=!0;const n=_>h+1?_-2:g-1;if(d[n])return e;c.push(n),d[n]=!0,m=n+l,u=void 0}else f=!0}p=r}if(f&&i&&i(),0===c.length)return e;s&&s();let v=e.slice(0,c[0]);for(let r=0;r<c.length;++r){const o=c[r],a=c[r+1]||e.length;0===o?v=`\n${n}${e.slice(0,a)}`:(t===H&&d[o]&&(v+=`${e[o]}\\`),v+=`\n${n}${e.slice(o+1,a)}`)}return v}function Y(e,n,t){let r=n,o=n+1,a=e[o];for(;" "===a||"\t"===a;)if(n<o+t)a=e[++n];else{do{a=e[++n]}while(a&&"\n"!==a);r=n,o=n+1,a=e[o]}return r}const X=(e,n)=>({indentAtStart:n?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),Z=e=>/^(%|---|\.\.\.)/m.test(e);function ee(e,n){const t=JSON.stringify(e);if(n.options.doubleQuotedAsJSON)return t;const{implicitKey:r}=n,o=n.options.doubleQuotedMinMultiLineLength,a=n.indent||(Z(e)?"  ":"");let s="",i=0;for(let e=0,n=t[e];n;n=t[++e])if(" "===n&&"\\"===t[e+1]&&"n"===t[e+2]&&(s+=t.slice(i,e)+"\\ ",e+=1,i=e,n="\\"),"\\"===n)switch(t[e+1]){case"u":{s+=t.slice(i,e);const n=t.substr(e+2,4);switch(n){case"0000":s+="\\0";break;case"0007":s+="\\a";break;case"000b":s+="\\v";break;case"001b":s+="\\e";break;case"0085":s+="\\N";break;case"00a0":s+="\\_";break;case"2028":s+="\\L";break;case"2029":s+="\\P";break;default:"00"===n.substr(0,2)?s+="\\x"+n.substr(2):s+=t.substr(e,6)}e+=5,i=e+1}break;case"n":if(r||'"'===t[e+2]||t.length<o)e+=1;else{for(s+=t.slice(i,e)+"\n\n";"\\"===t[e+2]&&"n"===t[e+3]&&'"'!==t[e+4];)s+="\n",e+=2;s+=a," "===t[e+2]&&(s+="\\"),e+=1,i=e+1}break;default:e+=1}return s=i?s+t.slice(i):t,r?s:W(s,a,H,X(n,!1))}function ne(e,n){if(!1===n.options.singleQuote||n.implicitKey&&e.includes("\n")||/[ \t]\n|\n[ \t]/.test(e))return ee(e,n);const t=n.indent||(Z(e)?"  ":""),r="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&\n${t}`)+"'";return n.implicitKey?r:W(r,t,K,X(n,!1))}function te(e,n){const{singleQuote:t}=n.options;let r;if(!1===t)r=ee;else{const n=e.includes('"'),o=e.includes("'");r=n&&!o?ne:o&&!n?ee:t?ne:ee}return r(e,n)}let re;try{re=new RegExp("(^|(?<!\n))\n+(?!\n|$)","g")}catch{re=/\n+(?!\n|$)/g}function oe({comment:e,type:n,value:t},r,o,a){const{blockQuote:s,commentString:i,lineWidth:l}=r.options;if(!s||/\n[\t ]+$/.test(t)||/^\s*$/.test(t))return te(t,r);const c=r.indent||(r.forceBlockIndent||Z(t)?"  ":""),d="literal"===s||"folded"!==s&&n!==q.BLOCK_FOLDED&&(n===q.BLOCK_LITERAL||!function(e,n,t){if(!n||n<0)return!1;const r=n-t,o=e.length;if(o<=r)return!1;for(let n=0,t=0;n<o;++n)if("\n"===e[n]){if(n-t>r)return!0;if(t=n+1,o-t<=r)return!1}return!0}(t,l,c.length));if(!t)return d?"|\n":">\n";let u,p;for(p=t.length;p>0;--p){const e=t[p-1];if("\n"!==e&&"\t"!==e&&" "!==e)break}let m=t.substring(p);const f=m.indexOf("\n");-1===f?u="-":t===m||f!==m.length-1?(u="+",a&&a()):u="",m&&(t=t.slice(0,-m.length),"\n"===m[m.length-1]&&(m=m.slice(0,-1)),m=m.replace(re,`$&${c}`));let _,g=!1,h=-1;for(_=0;_<t.length;++_){const e=t[_];if(" "===e)g=!0;else{if("\n"!==e)break;h=_}}let v=t.substring(0,h<_?h+1:_);v&&(t=t.substring(v.length),v=v.replace(/\n+/g,`$&${c}`));let y=(g?c?"2":"1":"")+u;if(e&&(y+=" "+i(e.replace(/ ?[\r\n]+/g," ")),o&&o()),!d){const e=t.replace(/\n+/g,"\n$&").replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`);let o=!1;const a=X(r,!0);"folded"!==s&&n!==q.BLOCK_FOLDED&&(a.onOverflow=()=>{o=!0});const i=W(`${v}${e}${m}`,c,J,a);if(!o)return`>${y}\n${c}${i}`}return`|${y}\n${c}${v}${t=t.replace(/\n+/g,`$&${c}`)}${m}`}function ae(e,n,t,r){const{implicitKey:o,inFlow:a}=n,s="string"==typeof e.value?e:Object.assign({},e,{value:String(e.value)});let{type:i}=e;i!==q.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(s.value)&&(i=q.QUOTE_DOUBLE);const l=e=>{switch(e){case q.BLOCK_FOLDED:case q.BLOCK_LITERAL:return o||a?te(s.value,n):oe(s,n,t,r);case q.QUOTE_DOUBLE:return ee(s.value,n);case q.QUOTE_SINGLE:return ne(s.value,n);case q.PLAIN:return function(e,n,t,r){const{type:o,value:a}=e,{actualString:s,implicitKey:i,indent:l,indentStep:c,inFlow:d}=n;if(i&&a.includes("\n")||d&&/[[\]{},]/.test(a))return te(a,n);if(!a||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(a))return i||d||!a.includes("\n")?te(a,n):oe(e,n,t,r);if(!i&&!d&&o!==q.PLAIN&&a.includes("\n"))return oe(e,n,t,r);if(Z(a)){if(""===l)return n.forceBlockIndent=!0,oe(e,n,t,r);if(i&&l===c)return te(a,n)}const u=a.replace(/\n+/g,`$&\n${l}`);if(s){const e=e=>e.default&&"tag:yaml.org,2002:str"!==e.tag&&e.test?.test(u),{compat:t,tags:r}=n.doc.schema;if(r.some(e)||t?.some(e))return te(a,n)}return i?u:W(u,l,K,X(n,!1))}(s,n,t,r);default:return null}};let c=l(i);if(null===c){const{defaultKeyType:e,defaultStringType:t}=n.options,r=o&&e||t;if(c=l(r),null===c)throw new Error(`Unsupported default string type ${r}`)}return c}function se(e,n,t,r){if(m(e))return e.toString(n,t,r);if(d(e)){if(n.doc.directives)return e.toString(n);if(n.resolvedAliases?.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");n.resolvedAliases?n.resolvedAliases.add(e):n.resolvedAliases=new Set([e]),e=e.resolve(n.doc)}let o;const a=h(e)?e:n.doc.createNode(e,{onTagObj:e=>o=e});o||(o=function(e,n){if(n.tag){const t=e.filter((e=>e.tag===n.tag));if(t.length>0)return t.find((e=>e.format===n.format))??t[0]}let t,r;if(f(n)){r=n.value;let o=e.filter((e=>e.identify?.(r)));if(o.length>1){const e=o.filter((e=>e.test));e.length>0&&(o=e)}t=o.find((e=>e.format===n.format))??o.find((e=>!e.format))}else r=n,t=e.find((e=>e.nodeClass&&r instanceof e.nodeClass));if(!t)throw new Error(`Tag not resolved for ${r?.constructor?.name??typeof r} value`);return t}(n.doc.schema.tags,a));const s=function(e,n,{anchors:t,doc:r}){if(!r.directives)return"";const o=[],a=(f(e)||g(e))&&e.anchor;a&&I(a)&&(t.add(a),o.push(`&${a}`));const s=e.tag?e.tag:n.default?null:n.tag;return s&&o.push(r.directives.tagString(s)),o.join(" ")}(a,o,n);s.length>0&&(n.indentAtStart=(n.indentAtStart??0)+s.length+1);const i="function"==typeof o.stringify?o.stringify(a,n,t,r):f(a)?ae(a,n,t,r):a.toString(n,t,r);return s?f(a)||"{"===i[0]||"["===i[0]?`${s} ${i}`:`${s}\n${n.indent}${i}`:i}const ie="<<",le={identify:e=>e===ie||"symbol"==typeof e&&e.description===ie,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new q(Symbol(ie)),{addToJSMap:ce}),stringify:()=>ie};function ce(e,n,t){if(t=e&&d(t)?t.resolve(e.doc):t,_(t))for(const r of t.items)de(e,n,r);else if(Array.isArray(t))for(const r of t)de(e,n,r);else de(e,n,t)}function de(e,n,t){const r=e&&d(t)?t.resolve(e.doc):t;if(!p(r))throw new Error("Merge sources must be maps or map aliases");const o=r.toJSON(null,e,Map);for(const[e,t]of o)n instanceof Map?n.has(e)||n.set(e,t):n instanceof Set?n.add(e):Object.prototype.hasOwnProperty.call(n,e)||Object.defineProperty(n,e,{value:t,writable:!0,enumerable:!0,configurable:!0});return n}function ue(e,n,{key:t,value:r}){if(h(t)&&t.addToJSMap)t.addToJSMap(e,n,r);else if(((e,n)=>(le.identify(n)||f(n)&&(!n.type||n.type===q.PLAIN)&&le.identify(n.value))&&e?.doc.schema.tags.some((e=>e.tag===le.tag&&e.default)))(e,t))ce(e,n,r);else{const o=A(t,"",e);if(n instanceof Map)n.set(o,A(r,o,e));else if(n instanceof Set)n.add(o);else{const a=function(e,n,t){if(null===n)return"";if("object"!=typeof n)return String(n);if(h(e)&&t?.doc){const n=function(e,n){const t=Object.assign({blockQuote:!0,commentString:U,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,n);let r;switch(t.collectionStyle){case"block":r=!1;break;case"flow":r=!0;break;default:r=null}return{anchors:new Set,doc:e,flowCollectionPadding:t.flowCollectionPadding?" ":"",indent:"",indentStep:"number"==typeof t.indent?" ".repeat(t.indent):"  ",inFlow:r,options:t}}(t.doc,{});n.anchors=new Set;for(const e of t.anchors.keys())n.anchors.add(e.anchor);n.inFlow=!0,n.inStringifyKey=!0;const a=e.toString(n);if(!t.mapKeyWarned){let e=JSON.stringify(a);e.length>40&&(e=e.substring(0,36)+'..."'),r=t.doc.options.logLevel,o=`Keys with collection values will be stringified due to JS Object restrictions: ${e}. Set mapAsMap: true to use object keys.`,"debug"!==r&&"warn"!==r||console.warn(o),t.mapKeyWarned=!0}return a}var r,o;return JSON.stringify(n)}(t,o,e),s=A(r,a,e);a in n?Object.defineProperty(n,a,{value:s,writable:!0,enumerable:!0,configurable:!0}):n[a]=s}}return n}function pe(e,n,t){const r=D(e,void 0,t),o=D(n,void 0,t);return new me(r,o)}class me{constructor(e,n=null){Object.defineProperty(this,c,{value:s}),this.key=e,this.value=n}clone(e){let{key:n,value:t}=this;return h(n)&&(n=n.clone(e)),h(t)&&(t=t.clone(e)),new me(n,t)}toJSON(e,n){return ue(n,n?.mapAsMap?new Map:{},this)}toString(e,n,t){return e?.doc?function({key:e,value:n},t,r,o){const{allNullValues:a,doc:s,indent:i,indentStep:l,options:{commentString:c,indentSeq:d,simpleKeys:u}}=t;let p=h(e)&&e.comment||null;if(u){if(p)throw new Error("With simple keys, key nodes cannot have comments");if(g(e)||!h(e)&&"object"==typeof e)throw new Error("With simple keys, collection cannot be used as a key value")}let m=!u&&(!e||p&&null==n&&!t.inFlow||g(e)||(f(e)?e.type===q.BLOCK_FOLDED||e.type===q.BLOCK_LITERAL:"object"==typeof e));t=Object.assign({},t,{allNullValues:!1,implicitKey:!m&&(u||!a),indent:i+l});let v,y,b,x=!1,w=!1,S=se(e,t,(()=>x=!0),(()=>w=!0));if(!m&&!t.inFlow&&S.length>1024){if(u)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");m=!0}if(t.inFlow){if(a||null==n)return x&&r&&r(),""===S?"?":m?`? ${S}`:S}else if(a&&!u||null==n&&m)return S=`? ${S}`,p&&!x?S+=z(S,t.indent,c(p)):w&&o&&o(),S;x&&(p=null),m?(p&&(S+=z(S,t.indent,c(p))),S=`? ${S}\n${i}:`):(S=`${S}:`,p&&(S+=z(S,t.indent,c(p)))),h(n)?(v=!!n.spaceBefore,y=n.commentBefore,b=n.comment):(v=!1,y=null,b=null,n&&"object"==typeof n&&(n=s.createNode(n))),t.implicitKey=!1,m||p||!f(n)||(t.indentAtStart=S.length+1),w=!1,d||!(l.length>=2)||t.inFlow||m||!_(n)||n.flow||n.tag||n.anchor||(t.indent=t.indent.substring(2));let C=!1;const E=se(n,t,(()=>C=!0),(()=>w=!0));let k=" ";if(p||v||y)k=v?"\n":"",y&&(k+=`\n${Q(c(y),t.indent)}`),""!==E||t.inFlow?k+=`\n${t.indent}`:"\n"===k&&(k="\n\n");else if(!m&&g(n)){const e=E[0],r=E.indexOf("\n"),o=-1!==r,a=t.inFlow??n.flow??0===n.items.length;if(o||!a){let n=!1;if(o&&("&"===e||"!"===e)){let t=E.indexOf(" ");"&"===e&&-1!==t&&t<r&&"!"===E[t+1]&&(t=E.indexOf(" ",t+1)),(-1===t||r<t)&&(n=!0)}n||(k=`\n${t.indent}`)}}else""!==E&&"\n"!==E[0]||(k="");return S+=k+E,t.inFlow?C&&r&&r():b&&!C?S+=z(S,t.indent,c(b)):w&&o&&o(),S}(this,e,n,t):JSON.stringify(this)}}function fe(e,n,t){return(n.inFlow??e.flow?ge:_e)(e,n,t)}function _e({comment:e,items:n},t,{blockItemPrefix:r,flowChars:o,itemIndent:a,onChompKeep:s,onComment:i}){const{indent:l,options:{commentString:c}}=t,d=Object.assign({},t,{indent:a,type:null});let u=!1;const p=[];for(let e=0;e<n.length;++e){const o=n[e];let s=null;if(h(o))!u&&o.spaceBefore&&p.push(""),he(t,p,o.commentBefore,u),o.comment&&(s=o.comment);else if(m(o)){const e=h(o.key)?o.key:null;e&&(!u&&e.spaceBefore&&p.push(""),he(t,p,e.commentBefore,u))}u=!1;let i=se(o,d,(()=>s=null),(()=>u=!0));s&&(i+=z(i,a,c(s))),u&&s&&(u=!1),p.push(r+i)}let f;if(0===p.length)f=o.start+o.end;else{f=p[0];for(let e=1;e<p.length;++e){const n=p[e];f+=n?`\n${l}${n}`:"\n"}}return e?(f+="\n"+Q(c(e),l),i&&i()):u&&s&&s(),f}function ge({items:e},n,{flowChars:t,itemIndent:r}){const{indent:o,indentStep:a,flowCollectionPadding:s,options:{commentString:i}}=n;r+=a;const l=Object.assign({},n,{indent:r,inFlow:!0,type:null});let c=!1,d=0;const u=[];for(let t=0;t<e.length;++t){const o=e[t];let a=null;if(h(o))o.spaceBefore&&u.push(""),he(n,u,o.commentBefore,!1),o.comment&&(a=o.comment);else if(m(o)){const e=h(o.key)?o.key:null;e&&(e.spaceBefore&&u.push(""),he(n,u,e.commentBefore,!1),e.comment&&(c=!0));const t=h(o.value)?o.value:null;t?(t.comment&&(a=t.comment),t.commentBefore&&(c=!0)):null==o.value&&e?.comment&&(a=e.comment)}a&&(c=!0);let s=se(o,l,(()=>a=null));t<e.length-1&&(s+=","),a&&(s+=z(s,r,i(a))),!c&&(u.length>d||s.includes("\n"))&&(c=!0),u.push(s),d=u.length}const{start:p,end:f}=t;if(0===u.length)return p+f;if(!c){const e=u.reduce(((e,n)=>e+n.length+2),2);c=n.options.lineWidth>0&&e>n.options.lineWidth}if(c){let e=p;for(const n of u)e+=n?`\n${a}${o}${n}`:"\n";return`${e}\n${o}${f}`}return`${p}${s}${u.join(" ")}${s}${f}`}function he({indent:e,options:{commentString:n}},t,r,o){if(r&&o&&(r=r.replace(/^\n+/,"")),r){const o=Q(n(r),e);t.push(o.trimStart())}}function ve(e,n){const t=f(n)?n.value:n;for(const r of e)if(m(r)){if(r.key===n||r.key===t)return r;if(f(r.key)&&r.key.value===t)return r}}class ye extends G{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(a,e),this.items=[]}static from(e,n,t){const{keepUndefined:r,replacer:o}=t,a=new this(e),s=(e,s)=>{if("function"==typeof o)s=o.call(n,e,s);else if(Array.isArray(o)&&!o.includes(e))return;(void 0!==s||r)&&a.items.push(pe(e,s,t))};if(n instanceof Map)for(const[e,t]of n)s(e,t);else if(n&&"object"==typeof n)for(const e of Object.keys(n))s(e,n[e]);return"function"==typeof e.sortMapEntries&&a.items.sort(e.sortMapEntries),a}add(e,n){let t;t=m(e)?e:e&&"object"==typeof e&&"key"in e?new me(e.key,e.value):new me(e,e?.value);const r=ve(this.items,t.key),o=this.schema?.sortMapEntries;if(r){if(!n)throw new Error(`Key ${t.key} already set`);f(r.value)&&j(t.value)?r.value.value=t.value:r.value=t.value}else if(o){const e=this.items.findIndex((e=>o(t,e)<0));-1===e?this.items.push(t):this.items.splice(e,0,t)}else this.items.push(t)}delete(e){const n=ve(this.items,e);if(!n)return!1;return this.items.splice(this.items.indexOf(n),1).length>0}get(e,n){const t=ve(this.items,e),r=t?.value;return(!n&&f(r)?r.value:r)??void 0}has(e){return!!ve(this.items,e)}set(e,n){this.add(new me(e,n),!0)}toJSON(e,n,t){const r=t?new t:n?.mapAsMap?new Map:{};n?.onCreate&&n.onCreate(r);for(const e of this.items)ue(n,r,e);return r}toString(e,n,t){if(!e)return JSON.stringify(this);for(const e of this.items)if(!m(e))throw new Error(`Map items must all be pairs; found ${JSON.stringify(e)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),fe(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:t,onComment:n})}}const be={collection:"map",default:!0,nodeClass:ye,tag:"tag:yaml.org,2002:map",resolve:(e,n)=>(p(e)||n("Expected a mapping for this tag"),e),createNode:(e,n,t)=>ye.from(e,n,t)};class xe extends G{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(l,e),this.items=[]}add(e){this.items.push(e)}delete(e){const n=we(e);if("number"!=typeof n)return!1;return this.items.splice(n,1).length>0}get(e,n){const t=we(e);if("number"!=typeof t)return;const r=this.items[t];return!n&&f(r)?r.value:r}has(e){const n=we(e);return"number"==typeof n&&n<this.items.length}set(e,n){const t=we(e);if("number"!=typeof t)throw new Error(`Expected a valid index, not ${e}.`);const r=this.items[t];f(r)&&j(n)?r.value=n:this.items[t]=n}toJSON(e,n){const t=[];n?.onCreate&&n.onCreate(t);let r=0;for(const e of this.items)t.push(A(e,String(r++),n));return t}toString(e,n,t){return e?fe(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:t,onComment:n}):JSON.stringify(this)}static from(e,n,t){const{replacer:r}=t,o=new this(e);if(n&&Symbol.iterator in Object(n)){let e=0;for(let a of n){if("function"==typeof r){const t=n instanceof Set?a:String(e++);a=r.call(n,t,a)}o.items.push(D(a,void 0,t))}}return o}}function we(e){let n=f(e)?e.value:e;return n&&"string"==typeof n&&(n=Number(n)),"number"==typeof n&&Number.isInteger(n)&&n>=0?n:null}const Se={collection:"seq",default:!0,nodeClass:xe,tag:"tag:yaml.org,2002:seq",resolve:(e,n)=>(_(e)||n("Expected a sequence for this tag"),e),createNode:(e,n,t)=>xe.from(e,n,t)},Ce={identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:(e,n,t,r)=>ae(e,n=Object.assign({actualString:!0},n),t,r)},Ee={identify:e=>null==e,createNode:()=>new q(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new q(null),stringify:({source:e},n)=>"string"==typeof e&&Ee.test.test(e)?e:n.options.nullStr},ke={identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new q("t"===e[0]||"T"===e[0]),stringify({source:e,value:n},t){if(e&&ke.test.test(e)){if(n===("t"===e[0]||"T"===e[0]))return e}return n?t.options.trueStr:t.options.falseStr}};function Ne({format:e,minFractionDigits:n,tag:t,value:r}){if("bigint"==typeof r)return String(r);const o="number"==typeof r?r:Number(r);if(!isFinite(o))return isNaN(o)?".nan":o<0?"-.inf":".inf";let a=JSON.stringify(r);if(!e&&n&&(!t||"tag:yaml.org,2002:float"===t)&&/^\d/.test(a)){let e=a.indexOf(".");e<0&&(e=a.length,a+=".");let t=n-(a.length-e-1);for(;t-- >0;)a+="0"}return a}const Oe={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ne},Te={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const n=Number(e.value);return isFinite(n)?n.toExponential():Ne(e)}},$e={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const n=new q(parseFloat(e)),t=e.indexOf(".");return-1!==t&&"0"===e[e.length-1]&&(n.minFractionDigits=e.length-t-1),n},stringify:Ne},Le=e=>"bigint"==typeof e||Number.isInteger(e),Ie=(e,n,t,{intAsBigInt:r})=>r?BigInt(e):parseInt(e.substring(n),t);function Me(e,n,t){const{value:r}=e;return Le(r)&&r>=0?t+r.toString(n):Ne(e)}const Ae={identify:e=>Le(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,n,t)=>Ie(e,2,8,t),stringify:e=>Me(e,8,"0o")},Be={identify:Le,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,n,t)=>Ie(e,0,10,t),stringify:Ne},Fe={identify:e=>Le(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,n,t)=>Ie(e,2,16,t),stringify:e=>Me(e,16,"0x")},Ve=[be,Se,Ce,Ee,ke,Ae,Be,Fe,Oe,Te,$e];function je(e){return"bigint"==typeof e||Number.isInteger(e)}const qe=({value:e})=>JSON.stringify(e),Pe=[be,Se].concat([{identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:qe},{identify:e=>null==e,createNode:()=>new q(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:qe},{identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:e=>"true"===e,stringify:qe},{identify:je,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,n,{intAsBigInt:t})=>t?BigInt(e):parseInt(e,10),stringify:({value:e})=>je(e)?e.toString():JSON.stringify(e)},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:qe}],{default:!0,tag:"",test:/^/,resolve:(e,n)=>(n(`Unresolved plain scalar ${JSON.stringify(e)}`),e)}),De={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,n){if("function"==typeof atob){const n=atob(e.replace(/[\n\r]/g,"")),t=new Uint8Array(n.length);for(let e=0;e<n.length;++e)t[e]=n.charCodeAt(e);return t}return n("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:n,value:t},r,o,a){if(!t)return"";const s=t;let i;if("function"!=typeof btoa)throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");{let e="";for(let n=0;n<s.length;++n)e+=String.fromCharCode(s[n]);i=btoa(e)}if(n||(n=q.BLOCK_LITERAL),n!==q.QUOTE_DOUBLE){const e=Math.max(r.options.lineWidth-r.indent.length,r.options.minContentWidth),t=Math.ceil(i.length/e),o=new Array(t);for(let n=0,r=0;n<t;++n,r+=e)o[n]=i.substr(r,e);i=o.join(n===q.BLOCK_LITERAL?"\n":" ")}return ae({comment:e,type:n,value:i},r,o,a)}};function Re(e,n){if(_(e))for(let t=0;t<e.items.length;++t){let r=e.items[t];if(!m(r)){if(p(r)){r.items.length>1&&n("Each pair must have its own sequence indicator");const e=r.items[0]||new me(new q(null));if(r.commentBefore&&(e.key.commentBefore=e.key.commentBefore?`${r.commentBefore}\n${e.key.commentBefore}`:r.commentBefore),r.comment){const n=e.value??e.key;n.comment=n.comment?`${r.comment}\n${n.comment}`:r.comment}r=e}e.items[t]=m(r)?r:new me(r)}}else n("Expected a sequence for this tag");return e}function Ge(e,n,t){const{replacer:r}=t,o=new xe(e);o.tag="tag:yaml.org,2002:pairs";let a=0;if(n&&Symbol.iterator in Object(n))for(let e of n){let s,i;if("function"==typeof r&&(e=r.call(n,String(a++),e)),Array.isArray(e)){if(2!==e.length)throw new TypeError(`Expected [key, value] tuple: ${e}`);s=e[0],i=e[1]}else if(e&&e instanceof Object){const n=Object.keys(e);if(1!==n.length)throw new TypeError(`Expected tuple with one key, not ${n.length} keys`);s=n[0],i=e[s]}else s=e;o.items.push(pe(s,i,t))}return o}const Ue={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:Re,createNode:Ge};class Qe extends xe{constructor(){super(),this.add=ye.prototype.add.bind(this),this.delete=ye.prototype.delete.bind(this),this.get=ye.prototype.get.bind(this),this.has=ye.prototype.has.bind(this),this.set=ye.prototype.set.bind(this),this.tag=Qe.tag}toJSON(e,n){if(!n)return super.toJSON(e);const t=new Map;n?.onCreate&&n.onCreate(t);for(const e of this.items){let r,o;if(m(e)?(r=A(e.key,"",n),o=A(e.value,r,n)):r=A(e,"",n),t.has(r))throw new Error("Ordered maps must not include duplicate keys");t.set(r,o)}return t}static from(e,n,t){const r=Ge(e,n,t),o=new this;return o.items=r.items,o}}Qe.tag="tag:yaml.org,2002:omap";const ze={collection:"seq",identify:e=>e instanceof Map,nodeClass:Qe,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,n){const t=Re(e,n),r=[];for(const{key:e}of t.items)f(e)&&(r.includes(e.value)?n(`Ordered maps must not include duplicate keys: ${e.value}`):r.push(e.value));return Object.assign(new Qe,t)},createNode:(e,n,t)=>Qe.from(e,n,t)};function Ke({value:e,source:n},t){return n&&(e?Je:He).test.test(n)?n:e?t.options.trueStr:t.options.falseStr}const Je={identify:e=>!0===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new q(!0),stringify:Ke},He={identify:e=>!1===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new q(!1),stringify:Ke},We={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ne},Ye={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const n=Number(e.value);return isFinite(n)?n.toExponential():Ne(e)}},Xe={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const n=new q(parseFloat(e.replace(/_/g,""))),t=e.indexOf(".");if(-1!==t){const r=e.substring(t+1).replace(/_/g,"");"0"===r[r.length-1]&&(n.minFractionDigits=r.length)}return n},stringify:Ne},Ze=e=>"bigint"==typeof e||Number.isInteger(e);function en(e,n,t,{intAsBigInt:r}){const o=e[0];if("-"!==o&&"+"!==o||(n+=1),e=e.substring(n).replace(/_/g,""),r){switch(t){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`}const n=BigInt(e);return"-"===o?BigInt(-1)*n:n}const a=parseInt(e,t);return"-"===o?-1*a:a}function nn(e,n,t){const{value:r}=e;if(Ze(r)){const e=r.toString(n);return r<0?"-"+t+e.substr(1):t+e}return Ne(e)}const tn={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,n,t)=>en(e,2,2,t),stringify:e=>nn(e,2,"0b")},rn={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,n,t)=>en(e,1,8,t),stringify:e=>nn(e,8,"0")},on={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,n,t)=>en(e,0,10,t),stringify:Ne},an={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,n,t)=>en(e,2,16,t),stringify:e=>nn(e,16,"0x")};class sn extends ye{constructor(e){super(e),this.tag=sn.tag}add(e){let n;n=m(e)?e:e&&"object"==typeof e&&"key"in e&&"value"in e&&null===e.value?new me(e.key,null):new me(e,null);ve(this.items,n.key)||this.items.push(n)}get(e,n){const t=ve(this.items,e);return!n&&m(t)?f(t.key)?t.key.value:t.key:t}set(e,n){if("boolean"!=typeof n)throw new Error("Expected boolean value for set(key, value) in a YAML set, not "+typeof n);const t=ve(this.items,e);t&&!n?this.items.splice(this.items.indexOf(t),1):!t&&n&&this.items.push(new me(e))}toJSON(e,n){return super.toJSON(e,n,Set)}toString(e,n,t){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),n,t);throw new Error("Set items must all have null values")}static from(e,n,t){const{replacer:r}=t,o=new this(e);if(n&&Symbol.iterator in Object(n))for(let e of n)"function"==typeof r&&(e=r.call(n,e,e)),o.items.push(pe(e,null,t));return o}}sn.tag="tag:yaml.org,2002:set";const ln={collection:"map",identify:e=>e instanceof Set,nodeClass:sn,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,n,t)=>sn.from(e,n,t),resolve(e,n){if(p(e)){if(e.hasAllNullValues(!0))return Object.assign(new sn,e);n("Set items must all have null values")}else n("Expected a mapping for this tag");return e}};function cn(e,n){const t=e[0],r="-"===t||"+"===t?e.substring(1):e,o=e=>n?BigInt(e):Number(e),a=r.replace(/_/g,"").split(":").reduce(((e,n)=>e*o(60)+o(n)),o(0));return"-"===t?o(-1)*a:a}function dn(e){let{value:n}=e,t=e=>e;if("bigint"==typeof n)t=e=>BigInt(e);else if(isNaN(n)||!isFinite(n))return Ne(e);let r="";n<0&&(r="-",n*=t(-1));const o=t(60),a=[n%o];return n<60?a.unshift(0):(n=(n-a[0])/o,a.unshift(n%o),n>=60&&(n=(n-a[0])/o,a.unshift(n))),r+a.map((e=>String(e).padStart(2,"0"))).join(":").replace(/000000\d*$/,"")}const un={identify:e=>"bigint"==typeof e||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,n,{intAsBigInt:t})=>cn(e,t),stringify:dn},pn={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>cn(e,!1),stringify:dn},mn={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const n=e.match(mn.test);if(!n)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,t,r,o,a,s,i]=n.map(Number),l=n[7]?Number((n[7]+"00").substr(1,3)):0;let c=Date.UTC(t,r-1,o,a||0,s||0,i||0,l);const d=n[8];if(d&&"Z"!==d){let e=cn(d,!1);Math.abs(e)<30&&(e*=60),c-=6e4*e}return new Date(c)},stringify:({value:e})=>e?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""},fn=[be,Se,Ce,Ee,Je,He,tn,rn,on,an,We,Ye,Xe,De,le,ze,Ue,ln,un,pn,mn];new Map([["core",Ve],["failsafe",[be,Se,Ce]],["json",Pe],["yaml11",fn],["yaml-1.1",fn]]);Error;const _n=Symbol("break visit"),gn=Symbol("skip children"),hn=Symbol("remove item");function vn(e,n){"type"in e&&"document"===e.type&&(e={start:e.start,value:e.value}),yn(Object.freeze([]),e,n)}function yn(e,n,t){let r=t(n,e);if("symbol"==typeof r)return r;for(const o of["key","value"]){const a=n[o];if(a&&"items"in a){for(let n=0;n<a.items.length;++n){const r=yn(Object.freeze(e.concat([[o,n]])),a.items[n],t);if("number"==typeof r)n=r-1;else{if(r===_n)return _n;r===hn&&(a.items.splice(n,1),n-=1)}}"function"==typeof r&&"key"===o&&(r=r(n,e))}}return"function"==typeof r?r(n,e):r}vn.BREAK=_n,vn.SKIP=gn,vn.REMOVE=hn,vn.itemAtPath=(e,n)=>{let t=e;for(const[e,r]of n){const n=t?.[e];if(!n||!("items"in n))return;t=n.items[r]}return t},vn.parentCollection=(e,n)=>{const t=vn.itemAtPath(e,n.slice(0,-1)),r=n[n.length-1][0],o=t?.[r];if(o&&"items"in o)return o;throw new Error("Parent collection not found")};new Set("0123456789ABCDEFabcdef"),new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),new Set(",[]{}"),new Set(" ,[]{}\n\r\t");var bn=t(72),xn=t.n(bn),wn=t(825),Sn=t.n(wn),Cn=t(659),En=t.n(Cn),kn=t(56),Nn=t.n(kn),On=t(540),Tn=t.n(On),$n=t(113),Ln=t.n($n),In=t(208),Mn={};Mn.styleTagTransform=Ln(),Mn.setAttributes=Nn(),Mn.insert=En().bind(null,"head"),Mn.domAPI=Sn(),Mn.insertStyleElement=Tn();xn()(In.A,Mn);In.A&&In.A.locals&&In.A.locals;const An='<div class="slider_macros_card" data-expanded="false"> <div class="slider_macros_card_header"> <div class="slider_macros_card_toggle"> <i class="fa-solid fa-chevron-right slider_macros_card_chevron"></i> </div> <div class="slider_macros_card_summary"> <span class="slider_macros_card_name" data-field="name">New Slider</span> <span class="slider_macros_card_macro" data-field="property"></span> <span class="slider_macros_card_type_badge" data-field="type">Numeric</span> <span class="slider_macros_card_group_badge" data-field="group" title="Assigned group"> <i class="fa-solid fa-layer-group"></i> <span class="slider_macros_card_group_name"></span> </span> </div> <div class="slider_macros_card_controls"> <label class="checkbox_label slider_macros_toggle" title="Enable/Disable Slider"> <input type="checkbox" name="enabled"> </label> <button class="menu_button menu_button_icon slider_macros_btn_icon" name="up" type="button" title="Move Up"> <i class="fa-solid fa-chevron-up"></i> </button> <button class="menu_button menu_button_icon slider_macros_btn_icon" name="down" type="button" title="Move Down"> <i class="fa-solid fa-chevron-down"></i> </button> </div> </div> <div class="slider_macros_card_body"> <div class="slider_macros_field_group"> <div class="slider_macros_field"> <label class="slider_macros_label">Name</label> <input class="text_pole" type="text" name="name" placeholder="e.g. Temperature"> </div> <div class="slider_macros_field slider_macros_field_wide"> <label class="slider_macros_label">Macro Name</label> <div class="slider_macros_macro_input_row"> <div class="slider_macros_macro_input"> <span class="slider_macros_macro_prefix">{{</span> <input class="text_pole" type="text" name="property" placeholder="myVar"> <span class="slider_macros_macro_suffix">}}</span> </div> <button class="menu_button menu_button_icon slider_macros_btn_search_macro" name="searchMacro" type="button" title="Search existing macros to override"> <i class="fa-solid fa-search"></i> </button> </div> <div class="slider_macros_macro_status" name="macroStatus"></div> </div> </div> <div class="slider_macros_field"> <label class="slider_macros_label">Type</label> <select class="text_pole" name="type"> <option value="Numeric" selected="selected">Numeric</option> <option value="Boolean">Boolean</option> <option value="MultiSelect">MultiSelect</option> <option value="Dropdown">Dropdown</option> <option value="Color">Color</option> <option value="Checkbox">Checkbox</option> </select> </div> <div class="slider_macros_field"> <label class="slider_macros_label">Group <span class="slider_macros_optional">(optional)</span></label> <select class="text_pole" name="groupId"> <option value="">No Group</option> </select> </div> <div class="slider_macros_type_section"> <div class="slider_macros_field"> <label class="slider_macros_label">Slider Mode</label> <div class="slider_macros_mode_toggle"> <button type="button" class="menu_button slider_macros_mode_btn" name="modeMacro" data-mode="macro"> <i class="fa-solid fa-code"></i> <span>Macro</span> </button> <button type="button" class="menu_button slider_macros_mode_btn" name="modeVariable" data-mode="variable"> <i class="fa-solid fa-database"></i> <span>Variable</span> </button> </div> <div class="slider_macros_mode_hint" name="modeHint"> <span class="macro-hint">Slider registers as a macro ({{macroName}})</span> <span class="variable-hint">Slider only affects a variable (no macro registered)</span> </div> </div> </div> <div class="slider_macros_type_section"> <div class="slider_macros_field"> <label class="checkbox_label slider_macros_sync_toggle"> <input type="checkbox" name="syncEnabled"> <span>Sync to Variable</span> </label> </div> <div class="slider_macros_variable_config" name="variableConfig"> <div class="slider_macros_variable_input_row"> <select class="text_pole slider_macros_variable_scope" name="syncScope"> <option value="local">Local</option> <option value="global">Global</option> </select> <div class="slider_macros_variable_input"> <input class="text_pole" type="text" name="syncVariable" placeholder="variable name"> </div> </div> <div class="slider_macros_variable_status" name="variableStatus"></div> <div class="slider_macros_field slider_macros_force_sync_field"> <label class="checkbox_label slider_macros_force_toggle"> <input type="checkbox" name="syncForce"> <span>Force Read/Write</span> </label> <div class="slider_macros_sync_hint">Creates variable if it doesn\'t exist. Reads variable value on load to update slider.</div> </div> <div class="slider_macros_sync_hint slider_macros_sync_hint_default">Syncs slider value to an existing variable. Use {{getvar::name}} or {{getglobalvar::name}} to retrieve.</div> </div> </div> <div class="numeric-only slider_macros_type_section"> <div class="slider_macros_field_row"> <div class="slider_macros_field slider_macros_field_compact"> <label class="slider_macros_label">Min</label> <input class="text_pole" type="text" name="min" placeholder="0"> </div> <div class="slider_macros_field slider_macros_field_compact"> <label class="slider_macros_label">Max</label> <input class="text_pole" type="text" name="max" placeholder="1"> </div> <div class="slider_macros_field slider_macros_field_compact"> <label class="slider_macros_label">Step</label> <input class="text_pole" type="text" name="step" placeholder="0.01"> </div> </div> </div> <div class="boolean-only slider_macros_type_section"> <div class="slider_macros_field"> <label class="slider_macros_label">Default Value</label> <select class="text_pole" name="defaultBoolean"> <option value="true">True</option> <option value="false">False</option> </select> </div> </div> <div class="multiselect-only slider_macros_type_section"> <div class="slider_macros_field_row"> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">Option 1</label> <input class="text_pole" type="text" name="option1" placeholder="e.g. Low"> </div> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">Option 2</label> <input class="text_pole" type="text" name="option2" placeholder="e.g. High"> </div> </div> <div class="slider_macros_field_row"> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">Option 3 <span class="slider_macros_optional">(optional)</span></label> <input class="text_pole" type="text" name="option3" placeholder=""> </div> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">Option 4 <span class="slider_macros_optional">(optional)</span></label> <input class="text_pole" type="text" name="option4" placeholder=""> </div> </div> </div> <div class="dropdown-only slider_macros_type_section"> <div class="slider_macros_field"> <label class="slider_macros_label">Dropdown Options <span class="slider_macros_optional">(key → macro value)</span></label> <div class="slider_macros_dropdown_options" data-name="dropdownOptions"> </div> <button class="menu_button menu_button_icon slider_macros_btn_add_option" name="addDropdownOption" type="button"> <i class="fa-solid fa-plus"></i> <span>Add Option</span> </button> </div> </div> <div class="color-only slider_macros_type_section"> <div class="slider_macros_field"> <label class="slider_macros_label">Output Format</label> <select class="text_pole" name="colorFormat"> <option value="hex" selected="selected">HEX (#RRGGBB)</option> <option value="rgb">RGB (rgb(r, g, b))</option> <option value="hsv">HSV (hsv(h, s%, v%))</option> </select> </div> <div class="slider_macros_field"> <label class="slider_macros_label">Default Color</label> <input class="text_pole slider_macros_color_default" type="color" name="defaultColor" value="#ffffff"> </div> </div> <div class="checkbox-only slider_macros_type_section"> <div class="slider_macros_field_row"> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">True Value <span class="slider_macros_optional">(macro output when checked)</span></label> <input class="text_pole" type="text" name="checkboxTrueValue" placeholder="true"> </div> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">False Value <span class="slider_macros_optional">(macro output when unchecked)</span></label> <input class="text_pole" type="text" name="checkboxFalseValue" placeholder="false"> </div> </div> <div class="slider_macros_field"> <label class="slider_macros_label">Default State</label> <select class="text_pole" name="defaultCheckbox"> <option value="false" selected="selected">Unchecked</option> <option value="true">Checked</option> </select> </div> </div> <div class="slider_macros_card_delete_row"> <button class="menu_button menu_button_icon slider_macros_btn_duplicate" name="duplicate" type="button"> <i class="fa-solid fa-copy"></i> <span>Duplicate</span> </button> <button class="menu_button menu_button_icon slider_macros_btn_danger_full" name="delete" type="button"> <i class="fa-solid fa-trash-alt"></i> <span>Delete Slider</span> </button> </div> </div> </div>';const Bn='<div class="range-block" data-source="openai,claude,aimlapi,openrouter,ai21,makersuite,vertexai,mistralai,custom,cohere,perplexity,groq,siliconflow,electronhub,chutes,nanogpt,deepseek,xai,pollinations,moonshot,fireworks,cometapi,azure_openai,zai"> <div class="range-block-title"></div> <div class="range-block-range-and-counter"> <div class="range-block-range"> <input type="range"> </div> <div class="range-block-counter"> <input type="number"> </div> </div> </div>';const Fn='<div class="slider_macros_group_card" data-expanded="false"> <div class="slider_macros_group_card_header"> <div class="slider_macros_card_toggle"> <i class="fa-solid fa-chevron-right slider_macros_card_chevron"></i> </div> <div class="slider_macros_group_card_summary"> <i class="fa-solid fa-layer-group slider_macros_group_icon"></i> <span class="slider_macros_group_card_name" data-field="name">New Group</span> <span class="slider_macros_group_card_count">(0 sliders)</span> </div> <div class="slider_macros_card_controls"> <button class="menu_button menu_button_icon slider_macros_btn_icon" name="up" type="button" title="Move Up"> <i class="fa-solid fa-chevron-up"></i> </button> <button class="menu_button menu_button_icon slider_macros_btn_icon" name="down" type="button" title="Move Down"> <i class="fa-solid fa-chevron-down"></i> </button> </div> </div> <div class="slider_macros_group_card_body"> <div class="slider_macros_field"> <label class="slider_macros_label">Group Name</label> <input class="text_pole" type="text" name="groupName" placeholder="e.g. Temperature Settings"> </div> <div class="slider_macros_group_sliders"></div> <div class="slider_macros_card_delete_row"> <button class="menu_button menu_button_icon slider_macros_btn_danger_full" name="deleteGroup" type="button"> <i class="fa-solid fa-trash-alt"></i> <span>Delete Group</span> </button> </div> </div> </div> ';var Vn=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function i(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,i)}l((r=r.apply(e,n||[])).next())}))};const{saveSettingsDebounced:jn,event_types:qn,eventSource:Pn,chatCompletionSettings:Dn,Popup:Rn,powerUserSettings:Gn,macros:Un,MacrosParser:Qn,substituteParams:zn,variables:Kn,resolveVariable:Jn,textCompletionSettings:Hn,mainApi:Wn}=SillyTavern.getContext(),Yn="sliderMacros";let Xn=null;function Zn(){var e,n;if(null===Xn&&(Xn=new Set,null===(e=null==Un?void 0:Un.registry)||void 0===e?void 0:e.getAllMacros))try{const e=Un.registry.getAllMacros({excludeHiddenAliases:!0});for(const t of e)(null===(n=t.source)||void 0===n?void 0:n.isExtension)||Xn.add(t.name);console.debug(`[SliderMacros] Cached ${Xn.size} protected macro names`)}catch(e){console.warn("[SliderMacros] Failed to cache protected macros:",e)}}function et(e){return null===Xn&&Zn(),(null==Xn?void 0:Xn.has(e))||!1}function nt(e,n){let t=null;return(...r)=>{t&&clearTimeout(t),t=setTimeout((()=>{e(...r),t=null}),n)}}const tt=nt((()=>jn()),300),rt=e=>nt((()=>kt(e)),300);function ot(e){var n,t;const r=`{{${e}}}`;if((null==Gn?void 0:Gn.experimental_macro_engine)&&(null==Un?void 0:Un.engine))try{const e=null===(n=Un.envBuilder)||void 0===n?void 0:n.buildFromRawEnv({});if(e){const n=Un.engine.evaluate(r,e);if(n!==r)return n}}catch(e){console.warn("[SliderMacros] Failed to retrieve macro from new engine:",e)}if("function"==typeof zn){const e=zn(r);if(e!==r)return e}if(!(null==Gn?void 0:Gn.experimental_macro_engine)&&(null==Un?void 0:Un.registry)&&(null==Un?void 0:Un.engine))try{if(Un.registry.hasMacro(e)){const e=null===(t=Un.envBuilder)||void 0===t?void 0:t.buildFromRawEnv({});if(e){const n=Un.engine.evaluate(r,e);if(n!==r)return n}}}catch(e){console.warn("[SliderMacros] Failed to retrieve macro from new engine fallback:",e)}return r}function at(){var e,n;const t=[];if(!Kn)return console.debug("[SliderMacros] Variables API not available"),t;try{if(null===(e=Kn.local)||void 0===e?void 0:e.keys){const e=Kn.local.keys();for(const n of e){const e=Kn.local.get(n);t.push({name:n,description:"Local variable",source:"variable",sourceName:"local",category:"variable",minArgs:0,isProtected:!1,isVariable:!0,variableScope:"local",variableValue:e})}}else if(Kn.local&&"function"==typeof Kn.local[Symbol.iterator])for(const[e,n]of Kn.local)t.push({name:e,description:"Local variable",source:"variable",sourceName:"local",category:"variable",minArgs:0,isProtected:!1,isVariable:!0,variableScope:"local",variableValue:n})}catch(e){console.warn("[SliderMacros] Failed to get local variables:",e)}try{if(null===(n=Kn.global)||void 0===n?void 0:n.keys){const e=Kn.global.keys();for(const n of e){const e=Kn.global.get(n);t.push({name:n,description:"Global variable",source:"variable",sourceName:"global",category:"variable",minArgs:0,isProtected:!1,isVariable:!0,variableScope:"global",variableValue:e})}}else if(Kn.global&&"function"==typeof Kn.global[Symbol.iterator])for(const[e,n]of Kn.global)t.push({name:e,description:"Global variable",source:"variable",sourceName:"global",category:"variable",minArgs:0,isProtected:!1,isVariable:!0,variableScope:"global",variableValue:n})}catch(e){console.warn("[SliderMacros] Failed to get global variables:",e)}return console.debug(`[SliderMacros] Total variables available: ${t.length}`),t}function st(){return function(){var e,n,t,r;const o=new Map;if(null===(e=null==Un?void 0:Un.registry)||void 0===e?void 0:e.getAllMacros)try{const e=Un.registry.getAllMacros({excludeHiddenAliases:!0});for(const a of e){const e=(a.minArgs||0)+((null===(n=a.list)||void 0===n?void 0:n.min)||0),s=et(a.name);o.set(a.name,{name:a.name,description:a.description||"",source:s?"core":(null===(t=a.source)||void 0===t?void 0:t.isExtension)?"extension":"core",sourceName:(null===(r=a.source)||void 0===r?void 0:r.name)||"unknown",category:a.category||"unknown",minArgs:e,isProtected:s,def:a})}console.debug(`[SliderMacros] Found ${o.size} macros from v2 registry`)}catch(e){console.warn("[SliderMacros] Failed to get macros from new registry:",e)}if(Qn)try{let e=0;if("function"==typeof Qn[Symbol.iterator])for(const n of Qn){const t=n.key||n.name,r=n.description||"";t&&!o.has(t)&&(o.set(t,{name:t,description:r,source:"legacy",sourceName:"unknown (legacy)",category:"legacy",minArgs:0,isProtected:!1,def:null}),e++)}console.debug(`[SliderMacros] Found ${e} additional macros from legacy parser`)}catch(e){console.warn("[SliderMacros] Failed to get macros from legacy parser:",e)}return console.debug(`[SliderMacros] Total macros available: ${o.size}`),Array.from(o.values())}().filter((e=>{var n,t;if(e.minArgs>0)return!1;const r=(null===(t=null===(n=e.category)||void 0===n?void 0:n.toLowerCase)||void 0===t?void 0:t.call(n))||e.category;return"utility"!==r&&"UTILITY"!==r}))}function it(){return Vn(this,arguments,void 0,(function*(e=!1){return new Promise((n=>{let t=null;const r=e?"Search Macros & Variables":"Search Existing Macros (Power Users Only!)",o=`\n            <div class="slider_macros_search_container">\n                <div class="slider_macros_search_description">\n                    <p class="pulse_opacity">This will let you search for existing Macros or Variables and remap them to slider values, even core Sillytavern Macros. This is not recommended for beginners, as it can cause unexpected behavior.<br>This can easily be undone by simply setting a different variable/macro name for the slider and refreshing sillytavern.</p>\n                </div>\n                <div class="slider_macros_search_input_row">\n                    <input type="text" class="text_pole slider_macros_search_input" placeholder="${e?"Search macros and variables...":"Search macros by name or description..."}">\n                </div>\n                <div class="slider_macros_search_results">\n                    <div class="slider_macros_search_empty">Loading...</div>\n                </div>\n            </div>\n        `,a=(n,r)=>{const o=function(e,n=20,t=!1){const r=st(),o=t?[...r,...at()]:r,a=e.toLowerCase().trim();return a?o.filter((e=>e.name.toLowerCase().includes(a)||e.description.toLowerCase().includes(a))).slice(0,n):o.slice(0,n)}(n,50,e);if(r.innerHTML="",0===o.length){const e=document.createElement("div");return e.className="slider_macros_search_empty",e.textContent=n?"No results found matching your search.":"No macros or variables available.",void r.appendChild(e)}o.forEach((e=>{var n;const o=document.createElement("div");o.className="slider_macros_search_result",e.isProtected&&o.classList.add("protected"),e.isVariable&&o.classList.add("variable");const a=document.createElement("div");a.className="slider_macros_search_result_header";const s=document.createElement("span");s.className="slider_macros_search_result_name",s.textContent=e.isVariable?e.name:`{{${e.name}}}`,a.appendChild(s);const i=document.createElement("span");let l="extension",c=e.sourceName||"Extension";if(e.isVariable?(l="variable",c="global"===e.variableScope?"Global Var":"Local Var"):"core"===e.source?(l="core",c="Core"):"legacy"===e.source&&(l="legacy",c="Legacy"),i.className=`slider_macros_search_result_source ${l}`,i.textContent=c,a.appendChild(i),e.isProtected){const e=document.createElement("span");e.className="slider_macros_search_result_protected",e.textContent="Protected",e.title="This is a core macro. Overriding it may cause unexpected behavior.",a.appendChild(e)}if(o.appendChild(a),e.description){const n=document.createElement("div");n.className="slider_macros_search_result_desc",n.textContent=e.description,o.appendChild(n)}try{let t;if(e.isVariable?t=String(null!==(n=e.variableValue)&&void 0!==n?n:""):(t=ot(e.name),t===`{{${e.name}}}`&&(t="")),t){const e=document.createElement("div");e.className="slider_macros_search_result_value";const n=t.length>50?t.substring(0,50)+"...":t;e.textContent=`Current: ${n}`,o.appendChild(e)}}catch(e){}o.addEventListener("click",(()=>{t=e;const n=document.querySelector(".popup-button-ok");n&&n.click()})),r.appendChild(o)}))};Rn.show.confirm(r,o,{okButton:"Select",cancelButton:"Cancel"}).then((e=>{n(e&&t?t:null)})),setTimeout((()=>{const e=document.querySelector(".slider_macros_search_input"),n=document.querySelector(".slider_macros_search_results");if(e&&n){a("",n);let t=null;e.addEventListener("input",(()=>{t&&clearTimeout(t),t=setTimeout((()=>{a(e.value,n)}),150)})),e.focus()}}),50)}))}))}function lt(e,n="local"){if(Kn)try{const t="global"===n?Kn.global:Kn.local;if(null==t?void 0:t.get)return t.get(e)}catch(n){console.warn(`[SliderMacros] Failed to get variable "${e}":`,n)}else console.warn("[SliderMacros] Variables API not available")}function ct(e,n,t="local"){if(!Kn)return console.warn("[SliderMacros] Variables API not available"),!1;try{const r="global"===t?Kn.global:Kn.local;if(null==r?void 0:r.set)return r.set(e,n),!0}catch(n){console.warn(`[SliderMacros] Failed to set variable "${e}":`,n)}return!1}function dt(e,n="local"){if(!Kn)return!1;try{const t="global"===n?Kn.global:Kn.local;if(null==t?void 0:t.has)return t.has(e)}catch(n){console.warn(`[SliderMacros] Failed to check variable "${e}":`,n)}return!1}function ut(e){if(!e.syncEnabled||!e.syncVariable)return!1;const n=e.syncScope||"local";return e.syncForce?(ct(e.syncVariable,e.value,n),console.debug(`[SliderMacros] Force-synced slider "${e.name}" value to ${n} variable "${e.syncVariable}":`,e.value),!0):dt(e.syncVariable,n)?(ct(e.syncVariable,e.value,n),console.debug(`[SliderMacros] Synced slider "${e.name}" value to ${n} variable "${e.syncVariable}":`,e.value),!0):(console.debug(`[SliderMacros] Skipping sync - variable "${e.syncVariable}" does not exist in ${n} scope`),!1)}function pt(e){if(!e.syncEnabled||!e.syncVariable||!e.syncForce)return!1;const n=e.syncScope||"local";if(!dt(e.syncVariable,n))return console.debug(`[SliderMacros] Cannot read from variable "${e.syncVariable}" - does not exist in ${n} scope`),!1;const t=lt(e.syncVariable,n);if(void 0===t)return!1;let r=e.value;if("Numeric"===e.type){const e=Number(t);isNaN(e)||(r=e)}else"Boolean"===e.type||"Checkbox"===e.type?"boolean"==typeof t?r=t:"string"==typeof t?r="true"===t.toLowerCase()||"1"===t:"number"==typeof t&&(r=0!==t):r=String(t);return e.value=r,console.debug(`[SliderMacros] Force-read variable "${e.syncVariable}" to slider "${e.name}":`,r),!0}const mt=Object.freeze({collections:[{active:!0,name:"Default",sliders:[],presets:[],groups:[]}]});function ft(e){return void 0===e.name&&(e.name=""),void 0===e.property&&(e.property=""),void 0===e.type&&(e.type="Numeric"),void 0===e.min&&(e.min="0"),void 0===e.max&&(e.max="1"),void 0===e.step&&(e.step="0.01"),void 0===e.value&&(e.value=0),void 0===e.enabled&&(e.enabled=!0),e.options||(e.options=[]),e.dropdownOptions||(e.dropdownOptions=[]),e.colorFormat||(e.colorFormat="hex"),e.checkboxTrueValue||(e.checkboxTrueValue="true"),e.checkboxFalseValue||(e.checkboxFalseValue="false"),void 0===e.groupId&&(e.groupId=null),void 0===e.order&&(e.order=0),void 0===e.syncEnabled&&(e.syncEnabled=!1),void 0===e.syncVariable&&(e.syncVariable=""),void 0===e.syncScope&&(e.syncScope="local"),void 0===e.syncForce&&(e.syncForce=!1),void 0===e.sliderMode&&(e.sliderMode="macro"),e}function _t(e){const n=[...e.groups.map((e=>e.order)),...e.sliders.filter((e=>!e.groupId)).map((e=>e.order))];return n.length>0?Math.max(...n)+1:0}function gt(e){return!(!e.enabled||!e.name)&&(!("variable"===e.sliderMode||!e.property)||(!("variable"!==e.sliderMode||!e.syncEnabled||!e.syncVariable)||!(e.sliderMode||!e.property)))}function ht(){const e=SillyTavern.getContext().extensionSettings;e[Yn]||(e[Yn]=structuredClone(mt));for(const n in mt)void 0===e[Yn][n]&&(e[Yn][n]=mt[n]);const n=e[Yn];0===n.collections.length&&n.collections.push(mt.collections[0]),n.collections.some((e=>e.active))||(n.collections[0].active=!0);for(const e of n.collections){e.groups||(e.groups=[]);let n=-1;for(const t of e.groups)void 0===t.order&&(t.order=e.groups.indexOf(t)),n=Math.max(n,t.order);let t=n;for(const n of e.sliders){if(void 0===n.groupId&&(n.groupId=null),void 0===n.order?(t++,n.order=t):t=Math.max(t,n.order),void 0===n.syncEnabled){const e=n.syncToVariable,t=n.variableSource;n.syncEnabled=!0===e||t&&""!==t.trim(),n.syncVariable=n.syncVariable||t||"",n.syncScope=n.syncScope||n.variableScope||"local",delete n.variableSource,delete n.variableScope,delete n.syncToVariable}void 0===n.syncForce&&(n.syncForce=!1),n.sliderMode||(n.sliderMode="macro")}}return n}function vt(){return{create:document.getElementById("slider_macros_create"),createGroup:document.getElementById("slider_macros_create_group"),list:document.getElementById("slider_macros_list"),collections:document.getElementById("slider_macros_collections"),createCollection:document.getElementById("slider_macros_create_collection"),deleteCollection:document.getElementById("slider_macros_delete_collection"),bindToPreset:document.getElementById("slider_macros_bind_to_preset"),hint:document.getElementById("slider_macros_hint"),importFile:document.getElementById("slider_macros_import_file"),importCollection:document.getElementById("slider_macros_import_collection"),exportCollection:document.getElementById("slider_macros_export_collection")}}function yt(e){var n;const t=null!==(n=document.getElementById("slider_macros_container"))&&void 0!==n?n:document.getElementById("extensions_settings");if(!t)return;const r=document.createElement("template");r.innerHTML='<div id="slider_macros_settings"> <div class="inline-drawer"> <div class="inline-drawer-toggle inline-drawer-header"> <b> <i class="fa-solid fa-sliders"></i> <span>Slider Macros</span> </b> <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div> </div> <div class="inline-drawer-content"> <div class="slider_macros_toolbar"> <input type="file" id="slider_macros_import_file" hidden accept=".json"> <div class="slider_macros_toolbar_row"> <select class="text_pole" id="slider_macros_collections"></select> <div class="slider_macros_toolbar_actions"> <div id="slider_macros_create_collection" class="menu_button menu_button_icon" title="Create New Collection"> <i class="fa-solid fa-folder-plus"></i> </div> <div id="slider_macros_bind_to_preset" class="menu_button menu_button_icon" title="Bind to Current Preset"> <i class="fa-solid fa-link"></i> </div> <div class="slider_macros_toolbar_divider"></div> <div id="slider_macros_import_collection" class="menu_button menu_button_icon" title="Import Collection"> <i class="fa-solid fa-file-import"></i> </div> <div id="slider_macros_export_collection" class="menu_button menu_button_icon" title="Export Collection"> <i class="fa-solid fa-file-export"></i> </div> <div class="slider_macros_toolbar_divider"></div> <div id="slider_macros_delete_collection" class="menu_button menu_button_icon slider_macros_btn_danger" title="Delete Collection"> <i class="fa-solid fa-trash-alt"></i> </div> </div> </div> </div> <div class="slider_macros_create_row"> <div id="slider_macros_create" class="menu_button menu_button_icon slider_macros_btn_create"> <i class="fa-solid fa-plus"></i> <span>Create Slider</span> </div> <div id="slider_macros_create_group" class="menu_button menu_button_icon slider_macros_btn_create slider_macros_btn_create_group"> <i class="fa-solid fa-layer-group"></i> <span>Create Group</span> </div> </div> <div id="slider_macros_list" class="slider_macros_list"></div> </div> </div> </div> ',t.appendChild(r.content);const o=vt();o.create.addEventListener("click",St),o.createGroup.addEventListener("click",Ct),o.createCollection.addEventListener("click",xt),o.deleteCollection.addEventListener("click",bt),o.bindToPreset.addEventListener("click",wt),o.collections.addEventListener("change",(n=>{const t=o.collections.value;e.collections.forEach((e=>{e.active=e.name===t})),jn(),Et(e)})),o.importCollection.addEventListener("click",(()=>Vn(this,void 0,void 0,(function*(){o.importFile.click()})))),o.exportCollection.addEventListener("click",(()=>Vn(this,void 0,void 0,(function*(){const n=e.collections.find((e=>e.active));if(!n)return;const t=n.name+".json",r={sliders:n.sliders,groups:n.groups},o=JSON.stringify(r,null,4),a=new Blob([o],{type:"application/json"}),s=URL.createObjectURL(a),i=document.createElement("a");i.href=s,i.download=t,i.click(),URL.revokeObjectURL(s)})))),o.importFile.addEventListener("change",(n=>{var t;const r=null===(t=o.importFile.files)||void 0===t?void 0:t[0];if(!r)return;const a=new FileReader;a.onload=n=>{var t;try{const o=r.name.split(".").shift()||"imported",a=null===(t=n.target)||void 0===t?void 0:t.result,s=JSON.parse(a);let i,l=[];if(Array.isArray(s))i=s;else{if(!s||!Array.isArray(s.sliders))return void toastr.error("Invalid JSON file format.");i=s.sliders,l=Array.isArray(s.groups)?s.groups:[]}!function(e,n,t,r){Vn(this,void 0,void 0,(function*(){const o=yield Rn.show.input("Import Collection","Enter the name of the new collection:",e);if(!o)return;if(r.collections.find((e=>e.name===o)))return void toastr.warning("Collection with this name already exists.");const a=n.map((e=>ft(e))),s=new Set(t.map((e=>e.id)));for(const e of a)e.groupId&&!s.has(e.groupId)&&(e.groupId=null);const i={active:!0,name:o,sliders:a,presets:[],groups:t};r.collections.forEach((e=>{e.active=!1})),r.collections.push(i),jn(),Et(r),toastr.success(`Imported ${n.length} sliders into collection "${o}".`)}))}(o,i,l,e)}catch(e){return void toastr.error("Failed to parse JSON file.")}},a.readAsText(r),o.importFile.value=""})),Et(e)}function bt(){return Vn(this,void 0,void 0,(function*(){const e=ht();if(1===e.collections.length)return void toastr.warning("Cannot delete the last collection.");const n=e.collections.find((e=>e.active));if(!n)return;if(!(yield Rn.show.confirm("Delete Collection",`Are you sure you want to delete the collection "${n.name}"?`)))return;const t=e.collections.indexOf(n);e.collections.splice(t,1);const r=e.collections[0];r&&(r.active=!0),jn(),Et(e)}))}function xt(){return Vn(this,void 0,void 0,(function*(){const e=ht(),n=yield Rn.show.input("New Collection Name","Enter the name of the new collection:");if(!n)return;e.collections.find((e=>e.name===n))?toastr.warning("Collection with this name already exists."):(e.collections.forEach((e=>{e.active=!1})),e.collections.push({active:!0,name:n,sliders:[],presets:[],groups:[]}),jn(),Et(e))}))}function wt(){const e=ht(),n=Dn.preset_settings_openai,t=Hn.preset,r=SillyTavern.getContext().mainApi;console.warn(`[SliderMacros] bindToPreset: currentAPI='${r}'`);let o="",a="";if("openai"===r)o=n,a="Chat Completion";else{if("textgenerationwebui"!==r)return console.warn(`[SliderMacros] Unsupported API for binding: ${r}`),void toastr.warning(`Slider binding is not supported for the current API: ${r}`);o=t,a="Text Completion"}if(!o)return void toastr.warning("No active preset found to bind.");const s=e.collections.find((e=>e.active));if(!s)return void toastr.warning("No active collection selected.");const i=e.collections.find((e=>e.presets.includes(o)));i?(i.presets.splice(i.presets.indexOf(o),1),i!==s?(toastr.warning(`The ${a} preset "${o}" was unbound from collection "${i.name}" and bound to "${s.name}".`),s.presets=[],s.presets.push(o)):toastr.info(`The ${a} preset "${o}" un-bound from collection "${s.name}".`)):(s.presets=[],s.presets.push(o),toastr.info(`Selecting the ${a} preset "${o}" will now automatically pick the sliders collection "${s.name}".`)),jn(),Et(e)}function St(){const e=ht(),n=e.collections.find((e=>e.active));n&&(n.sliders.unshift({name:"New Slider",property:"",type:"Numeric",min:"0",max:"1",step:"0.01",value:0,enabled:!0,options:[],dropdownOptions:[],colorFormat:"hex",checkboxTrueValue:"true",checkboxFalseValue:"false",groupId:null,order:_t(n),syncEnabled:!1,syncVariable:"",syncScope:"local",syncForce:!1,sliderMode:"macro"}),jn(),Et(e))}function Ct(){const e=ht(),n=e.collections.find((e=>e.active));n&&(n.groups.push({id:"group_"+Date.now()+"_"+Math.random().toString(36).substring(2,9),name:"New Group",collapsed:!1,order:_t(n)}),jn(),Et(e))}function Et(e){const n=vt(),t=rt(e);n.list.innerHTML="";const r=e.collections.find((e=>e.active));if(!r)return;n.collections.innerHTML="",e.collections.forEach((e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,t.selected=e.active,n.collections.appendChild(t)}));const o=Dn.preset_settings_openai,a=Hn.preset,s=SillyTavern.getContext().mainApi;let i=!1;"openai"===s?i=r.presets.includes(o):"textgenerationwebui"===s&&(i=r.presets.includes(a)),n.bindToPreset.classList.toggle("toggleEnabled",i);const l=(n,o)=>{var a;ft(n);const s=document.createElement("template");s.innerHTML=An;const i=s.content.querySelector(".slider_macros_card"),l=s.content.querySelector(".slider_macros_card_header"),c=s.content.querySelector(".slider_macros_card_name"),d=s.content.querySelector(".slider_macros_card_macro"),u=s.content.querySelector(".slider_macros_card_type_badge"),p=s.content.querySelector(".slider_macros_card_group_badge"),m=(s.content.querySelector(".slider_macros_card_group_name"),s.content.querySelector('input[name="name"]')),f=s.content.querySelector('input[name="property"]'),_=s.content.querySelector('input[name="min"]'),g=s.content.querySelector('input[name="max"]'),h=s.content.querySelector('input[name="step"]'),v=s.content.querySelector('input[name="enabled"]'),y=s.content.querySelector('select[name="type"]'),b=s.content.querySelector('select[name="groupId"]'),x=s.content.querySelector('button[name="delete"]'),w=s.content.querySelector('button[name="up"]'),S=s.content.querySelector('button[name="down"]'),C=s.content.querySelector(".numeric-only"),E=s.content.querySelector(".boolean-only"),k=s.content.querySelector(".multiselect-only"),N=s.content.querySelector(".dropdown-only"),O=s.content.querySelector(".color-only"),T=s.content.querySelector(".checkbox-only"),$=s.content.querySelector('select[name="colorFormat"]'),L=s.content.querySelector('input[name="defaultColor"]'),I=s.content.querySelector('input[name="checkboxTrueValue"]'),M=s.content.querySelector('input[name="checkboxFalseValue"]'),A=s.content.querySelector('select[name="defaultCheckbox"]'),B=s.content.querySelector(".slider_macros_dropdown_options"),F=s.content.querySelector('button[name="addDropdownOption"]'),V=s.content.querySelector('button[name="searchMacro"]'),j=s.content.querySelector(".slider_macros_macro_status");m.value=n.name,f.value=n.property,_.value=n.min,g.value=n.max,h.value=n.step,v.checked=n.enabled,y.value=n.type||"Numeric",$&&($.value=n.colorFormat),L&&(L.value="string"==typeof n.value&&n.value.startsWith("#")?n.value:"#ffffff"),I&&(I.value=n.checkboxTrueValue),M&&(M.value=n.checkboxFalseValue),A&&(A.value=!0===n.value?"true":"false"),b&&(b.innerHTML='<option value="">No Group</option>',r.groups.forEach((e=>{const t=document.createElement("option");t.value=e.id,t.textContent=e.name,t.selected=n.groupId===e.id,b.appendChild(t)}))),c.textContent=n.name||"New Slider",d.textContent=n.property||"",u.textContent=n.type||"Numeric",p&&(p.dataset.visible="false"),n.enabled||(i.dataset.disabled="true"),l.addEventListener("click",(e=>{if(e.target.closest(".slider_macros_card_controls"))return;const n="true"===i.dataset.expanded;i.dataset.expanded=n?"false":"true"}));[s.content.querySelector('input[name="option1"]'),s.content.querySelector('input[name="option2"]'),s.content.querySelector('input[name="option3"]'),s.content.querySelector('input[name="option4"]')].forEach(((e,r)=>{e&&(e.value=n.options[r]||"",e.addEventListener("input",(()=>{n.options[r]=e.value,t(),tt()})))}));const q=()=>{const e=y.value;C&&(C.style.display="Numeric"===e?"block":"none"),E&&(E.style.display="Boolean"===e?"block":"none"),k&&(k.style.display="MultiSelect"===e?"block":"none"),N&&(N.style.display="Dropdown"===e?"block":"none"),O&&(O.style.display="Color"===e?"block":"none"),T&&(T.style.display="Checkbox"===e?"block":"none")},P=()=>{B&&(B.innerHTML="",n.dropdownOptions.forEach(((e,r)=>{const o=document.createElement("div");o.className="slider_macros_dropdown_option_row";const a=document.createElement("input");a.type="text",a.className="text_pole slider_macros_dropdown_key",a.placeholder="Display name",a.value=e.key,a.addEventListener("input",(()=>{n.dropdownOptions[r].key=a.value,t(),tt()}));const s=document.createElement("span");s.className="slider_macros_dropdown_arrow",s.textContent="→";const i=document.createElement("textarea");i.className="text_pole slider_macros_dropdown_value",i.placeholder="Macro value (multi-line supported)",i.value=e.value,i.rows=Math.min(4,Math.max(1,e.value.split("\n").length)),i.addEventListener("keydown",(e=>{"Enter"===e.key&&e.stopPropagation()})),i.addEventListener("input",(()=>{n.dropdownOptions[r].value=i.value;const e=i.value.split("\n").length;i.rows=Math.min(4,Math.max(1,e)),t(),tt()}));const l=document.createElement("button");l.type="button",l.className="menu_button menu_button_icon slider_macros_btn_remove_option",l.innerHTML='<i class="fa-solid fa-times"></i>',l.title="Remove option",l.addEventListener("click",(()=>{n.dropdownOptions.splice(r,1),P(),t(),tt()})),o.appendChild(a),o.appendChild(s),o.appendChild(i),o.appendChild(l),B.appendChild(o)})))};P(),F&&F.addEventListener("click",(()=>{n.dropdownOptions.push({key:"",value:""}),P(),tt()})),$&&$.addEventListener("change",(()=>{n.colorFormat=$.value,t(),tt()})),L&&L.addEventListener("input",(()=>{n.value=L.value,t(),tt()})),I&&I.addEventListener("input",(()=>{n.checkboxTrueValue=I.value,t(),tt()})),M&&M.addEventListener("input",(()=>{n.checkboxFalseValue=M.value,t(),tt()})),A&&A.addEventListener("change",(()=>{n.value="true"===A.value,t(),tt()})),q(),y.addEventListener("change",(()=>{n.type=y.value,u.textContent=n.type,q(),jn(),kt(e)})),b&&b.addEventListener("change",(()=>{n.groupId=b.value||null,jn(),Et(e)})),m.addEventListener("input",(()=>{n.name=m.value,c.textContent=n.name||"New Slider",t(),tt()})),f.addEventListener("input",(()=>{n.property=f.value,d.textContent=n.property||"",D(),t(),tt()}));const D=()=>{if(!j)return;const e=f.value.trim();if(!e)return j.textContent="",void(j.className="slider_macros_macro_status");const n=et(e),t=function(e){var n,t;if(null===(t=null===(n=null==Un?void 0:Un.registry)||void 0===n?void 0:n.hasMacro)||void 0===t?void 0:t.call(n,e))return!0;if(Qn)for(const{key:n}of Qn)if(n===e)return!0;const r=`{{${e}}}`;return ot(e)!==r}(e);if(n){const n=ot(e),t=n.length>30?n.substring(0,30)+"...":n;j.textContent=`⚠ Overrides PROTECTED core macro (current: ${t})`,j.className="slider_macros_macro_status protected"}else if(t){const n=ot(e),t=n.length>30?n.substring(0,30)+"...":n;j.textContent=`Overrides existing macro (current: ${t})`,j.className="slider_macros_macro_status exists"}else j.textContent="New macro will be created",j.className="slider_macros_macro_status available"};D(),V&&V.addEventListener("click",(()=>Vn(this,void 0,void 0,(function*(){const t=yield it();if(t){if(f.value=t.name,n.property=t.name,d.textContent=t.name,!n.name||"New Slider"===n.name){const e=t.name.replace(/[_-]/g," ").replace(/\b\w/g,(e=>e.toUpperCase()));m.value=e,n.name=e,c.textContent=e}D(),kt(e),jn()}}))));const R=s.content.querySelector('input[name="syncEnabled"]'),G=s.content.querySelector(".slider_macros_variable_config"),U=s.content.querySelector('input[name="syncVariable"]'),Q=s.content.querySelector('select[name="syncScope"]'),z=s.content.querySelector('button[name="searchVariable"]'),K=s.content.querySelector(".slider_macros_variable_status");R&&(R.checked=n.syncEnabled||!1),U&&(U.value=n.syncVariable||""),Q&&(Q.value=n.syncScope||"local");const J=()=>{G&&(G.style.display=n.syncEnabled?"block":"none")};J(),R&&R.addEventListener("change",(()=>{n.syncEnabled=R.checked,J(),tt()}));const H=()=>{if(!K)return;const e=(null==U?void 0:U.value.trim())||"",t=(null==Q?void 0:Q.value)||"local",r=n.syncForce||!1;if(!e)return K.textContent="",void(K.className="slider_macros_variable_status");if(dt(e,t)){const n=lt(e,t),r=String(n).length>30?String(n).substring(0,30)+"...":String(n);K.textContent=`✓ Variable exists (current: ${r})`,K.className="slider_macros_variable_status found"}else{const n="local"===t?"global":"local";dt(e,n)?(K.textContent=`⚠ Variable exists in ${n} scope, not ${t}`,K.className="slider_macros_variable_status not-found"):r?(K.textContent="⚡ Variable will be created on first sync (Force mode)",K.className="slider_macros_variable_status force-create"):(K.textContent="✗ Variable does not exist - sync will be skipped",K.className="slider_macros_variable_status not-found")}};H(),U&&U.addEventListener("input",(()=>{n.syncVariable=U.value,H(),tt()})),Q&&Q.addEventListener("change",(()=>{n.syncScope=Q.value,H(),tt()}));const W=s.content.querySelector('input[name="syncForce"]'),Y=s.content.querySelector(".slider_macros_force_sync_field"),X=s.content.querySelector(".slider_macros_sync_hint_default");W&&(W.checked=n.syncForce||!1);const Z=()=>{Y&&X&&(n.syncForce?X.style.display="none":X.style.display="block"),H()};Z(),W&&W.addEventListener("change",(()=>{n.syncForce=W.checked,Z(),tt()}));const ee=s.content.querySelector('button[name="modeMacro"]'),ne=s.content.querySelector('button[name="modeVariable"]'),te=s.content.querySelector(".slider_macros_mode_hint"),re=null===(a=s.content.querySelector(".slider_macros_macro_input_row"))||void 0===a?void 0:a.closest(".slider_macros_field"),oe=()=>{const e="macro"===n.sliderMode;if(ee&&ee.classList.toggle("active",e),ne&&ne.classList.toggle("active",!e),te){const n=te.querySelector(".macro-hint"),t=te.querySelector(".variable-hint");n&&(n.style.display=e?"block":"none"),t&&(t.style.display=e?"none":"block")}re&&(re.style.display=e?"block":"none"),e||!R||n.syncEnabled||(n.syncEnabled=!0,R.checked=!0,J())};oe(),ee&&ee.addEventListener("click",(()=>{n.sliderMode="macro",oe(),tt()})),ne&&ne.addEventListener("click",(()=>{n.sliderMode="variable",oe(),tt()})),z&&z.addEventListener("click",(()=>Vn(this,void 0,void 0,(function*(){const e=yield it(!0);e&&e.isVariable&&(U&&(U.value=e.name),Q&&(Q.value=e.variableScope||"local"),n.syncVariable=e.name,n.syncScope=e.variableScope||"local",H(),jn())}))));const ae=s.content.querySelector('button[name="duplicate"]');return ae&&ae.addEventListener("click",(()=>{const t=e.collections.find((e=>e.active));if(!t)return;const r=Object.assign(Object.assign({},n),{name:`${n.name} Copy`,property:"",order:_t(t),options:[...n.options||[]],dropdownOptions:(n.dropdownOptions||[]).map((e=>Object.assign({},e)))});t.sliders.push(r),Et(e),jn()})),_.addEventListener("input",(()=>{n.min=_.value,t(),tt()})),g.addEventListener("input",(()=>{n.max=g.value,t(),tt()})),h.addEventListener("input",(()=>{n.step=h.value,t(),tt()})),v.addEventListener("change",(()=>{n.enabled=v.checked,i.dataset.disabled=n.enabled?"false":"true",kt(e),jn()})),x.addEventListener("click",(()=>Vn(this,void 0,void 0,(function*(){if(!(yield Rn.show.confirm("Delete Slider",`Are you sure you want to delete the slider "${n.name}"?`)))return;const t=e.collections.find((e=>e.active));t&&(t.sliders.splice(o,1),Et(e),jn())})))),w.addEventListener("click",(()=>{const t=e.collections.find((e=>e.active));if(t)if(n.groupId){const r=t.sliders.filter((e=>e.groupId===n.groupId)).sort(((e,n)=>e.order-n.order)),o=r.findIndex((e=>e===n));if(o>0){const t=r[o-1],a=n.order;n.order=t.order,t.order=a,Et(e),jn()}}else{const r=[];t.groups.forEach((e=>r.push({order:e.order,isGroup:!0,ref:e}))),t.sliders.filter((e=>!e.groupId)).forEach((e=>r.push({order:e.order,isGroup:!1,ref:e}))),r.sort(((e,n)=>e.order-n.order));const o=r.findIndex((e=>!e.isGroup&&e.ref===n));if(o>0){const t=r[o-1],a=n.order;n.order=t.ref.order,t.ref.order=a,Et(e),jn()}}})),S.addEventListener("click",(()=>{const t=e.collections.find((e=>e.active));if(t)if(n.groupId){const r=t.sliders.filter((e=>e.groupId===n.groupId)).sort(((e,n)=>e.order-n.order)),o=r.findIndex((e=>e===n));if(o<r.length-1){const t=r[o+1],a=n.order;n.order=t.order,t.order=a,Et(e),jn()}}else{const r=[];t.groups.forEach((e=>r.push({order:e.order,isGroup:!0,ref:e}))),t.sliders.filter((e=>!e.groupId)).forEach((e=>r.push({order:e.order,isGroup:!1,ref:e}))),r.sort(((e,n)=>e.order-n.order));const o=r.findIndex((e=>!e.isGroup&&e.ref===n));if(o<r.length-1){const t=r[o+1],a=n.order;n.order=t.ref.order,t.ref.order=a,Et(e),jn()}}})),s.content},c=[];r.groups.forEach(((e,n)=>{c.push({type:"group",group:e,groupIndex:n})})),r.sliders.forEach(((e,n)=>{e.groupId||c.push({type:"slider",slider:e,sliderIndex:n})})),c.sort(((e,n)=>("group"===e.type?e.group.order:e.slider.order)-("group"===n.type?n.group.order:n.slider.order)));const d=()=>{const e=[];return r.groups.forEach((n=>e.push({order:n.order,isGroup:!0,id:n.id}))),r.sliders.filter((e=>!e.groupId)).forEach((n=>e.push({order:n.order,isGroup:!1,id:n.property}))),e.sort(((e,n)=>e.order-n.order))};if(c.forEach((t=>{if("slider"===t.type){const e=l(t.slider,t.sliderIndex);n.list.appendChild(e)}else{const{group:o,groupIndex:a}=t,s=document.createElement("template");s.innerHTML=Fn;const i=s.content.querySelector(".slider_macros_group_card"),c=s.content.querySelector(".slider_macros_group_card_header"),u=s.content.querySelector(".slider_macros_group_card_name"),p=s.content.querySelector(".slider_macros_group_card_count"),m=s.content.querySelector(".slider_macros_group_sliders"),f=s.content.querySelector('input[name="groupName"]'),_=s.content.querySelector('button[name="deleteGroup"]'),g=s.content.querySelector('button[name="up"]'),h=s.content.querySelector('button[name="down"]'),v=r.sliders.map(((e,n)=>({slider:e,index:n}))).filter((e=>e.slider.groupId===o.id)).sort(((e,n)=>e.slider.order-n.slider.order));i.dataset.groupId=o.id,u.textContent=o.name||"New Group",p.textContent=`(${v.length} slider${1!==v.length?"s":""})`,f.value=o.name,v.forEach((({slider:e,index:n})=>{const t=l(e,n);m.appendChild(t)})),c.addEventListener("click",(e=>{if(e.target.closest(".slider_macros_card_controls"))return;const n="true"===i.dataset.expanded;i.dataset.expanded=n?"false":"true"})),f.addEventListener("input",(()=>{o.name=f.value,u.textContent=o.name||"New Group",tt()})),_.addEventListener("click",(()=>Vn(this,void 0,void 0,(function*(){(yield Rn.show.confirm("Delete Group",`Are you sure you want to delete the group "${o.name}"? Sliders in this group will become ungrouped.`))&&(r.sliders.forEach((e=>{e.groupId===o.id&&(e.groupId=null)})),r.groups.splice(a,1),Et(e),jn())})))),g.addEventListener("click",(n=>{n.stopPropagation();const t=d(),a=t.findIndex((e=>e.isGroup&&e.id===o.id));if(a>0){const n=t[a-1],s=o.order;if(n.isGroup){const e=r.groups.find((e=>e.id===n.id));e&&(o.order=e.order,e.order=s)}else{const e=r.sliders.find((e=>e.property===n.id&&!e.groupId));e&&(o.order=e.order,e.order=s)}Et(e),jn()}})),h.addEventListener("click",(n=>{n.stopPropagation();const t=d(),a=t.findIndex((e=>e.isGroup&&e.id===o.id));if(a<t.length-1){const n=t[a+1],s=o.order;if(n.isGroup){const e=r.groups.find((e=>e.id===n.id));e&&(o.order=e.order,e.order=s)}else{const e=r.sliders.find((e=>e.property===n.id&&!e.groupId));e&&(o.order=e.order,e.order=s)}Et(e),jn()}})),n.list.appendChild(s.content)}})),0===r.sliders.length&&0===r.groups.length){const e=document.createElement("div");e.classList.add("empty-message"),e.textContent='No custom sliders or groups. Click "Create Slider" or "Create Group" to add one.',n.list.appendChild(e)}kt(e)}function kt(e){vt();const n="slider_macros_drawer",t="slider_macros_main_container",r="slider_macros_completion_collections";let o=document.getElementById(n),a=document.getElementById(t);if(!o){o=document.createElement("div"),o.id=n,o.className="inline-drawer m-t-1 wide100p";const s=document.createElement("div");s.className="inline-drawer-toggle inline-drawer-header";const i=document.createElement("b");i.textContent="Custom Sliders",s.appendChild(i);const l=document.createElement("div");l.className="inline-drawer-icon fa-solid fa-circle-chevron-down down",s.appendChild(l),o.appendChild(s);const c=document.createElement("div");c.id="slider_macros_drawer_content",c.className="inline-drawer-content";const d=document.createElement("div");d.className="flex-container m-b-1";const u=document.createElement("span");u.textContent="Collection:",u.className="flex0",u.style.marginRight="10px",d.appendChild(u);const p=document.createElement("select");p.id=r,p.className="text_pole flex1",p.addEventListener("change",(()=>{const n=p.value;e.collections.forEach((e=>{e.active=e.name===n})),jn(),Et(e)})),d.appendChild(p),c.appendChild(d),a=document.createElement("div"),a.id=t,a.className="slider_macros_container",c.appendChild(a),o.appendChild(c)}const s=document.getElementById("completion_prompt_manager"),i=document.getElementById("ai_response_configuration"),l=SillyTavern.getContext().mainApi,c="textgenerationwebui"===l;s&&"openai"===l?o.parentElement===s&&s.firstChild===o||s.insertBefore(o,s.firstChild):i&&c&&o.previousElementSibling!==i&&i.after(o),a=document.getElementById(t);const d=document.getElementById(r);if(!a||!d)return void console.warn("[SliderMacros] Container or Collection Select not found in DOM (Drawer not attached?). Aborting render.");d.innerHTML="",e.collections.forEach((e=>{const n=document.createElement("option");n.value=e.name,n.textContent=e.name,n.selected=e.active,d.appendChild(n)})),a.innerHTML="";const u=e.collections.find((e=>e.active));if(!u)return;const p=(n,t)=>{if(!gt(n))return;n.syncEnabled&&n.syncForce&&n.syncVariable&&pt(n);const r=document.createElement("template");r.innerHTML=Bn;const o=CSS.escape(function(e){return"variable"===e.sliderMode&&e.syncVariable?"slider_var_"+e.syncVariable+"_"+(e.syncScope||"local"):"slider_macro_"+e.property}(n)),a=r.content.querySelector(".range-block-title");if(document.getElementById(o)){const e="variable"===n.sliderMode?"variable":"property",t="variable"===n.sliderMode?n.syncVariable:n.property;return toastr.warning(`Duplicate slider ${e} name: ${t}`),void console.warn("Duplicate slider detected:",o)}if(a.textContent=n.name,console.log(`Rendering slider: ${n.name} (${n.type}) [${n.sliderMode||"macro"} mode]`),"Numeric"!==n.type&&n.type){if("Boolean"===n.type){const t=r.content.querySelector(".range-block-range"),a=r.content.querySelector(".range-block-counter"),s=r.content.querySelector('input[type="range"]');t&&(t.style.display="",t.style.flex="1",t.style.width="100%");const i=document.createElement("span");i.style.marginLeft="10px",i.style.fontWeight="bold",a&&(a.style.display="",a.innerHTML="",a.appendChild(i)),s.id=o,s.min="0",s.max="1",s.step="1",s.value=(1-(n.value?1:0)).toString(),i.textContent=1==(n.value?1:0)?"True":"False";const l=()=>{const t=0===parseInt(s.value,10);n.value=t?1:0,i.textContent=t?"True":"False",ut(n),jn(),Nt(e)};s.addEventListener("input",l),$(s).on("input",l)}else if("MultiSelect"===n.type){const t=r.content.querySelector(".range-block-counter"),s=r.content.querySelector('input[type="range"]'),i=r.content.querySelector('input[type="number"]'),l=(n.options||[]).filter((e=>""!==e.trim()));if(l.length<2)return void(a.textContent+=" (Config Error: < 2 Options)");const c=document.createElement("span");c.style.marginLeft="10px",c.style.fontWeight="bold",t&&i&&(t.innerHTML="",t.appendChild(c)),s.id=o,s.min="0",s.max=(l.length-1).toString(),s.step="1",(n.value<0||n.value>=l.length)&&(n.value=0);const d=e=>e.length>10?e.substring(0,10)+"...":e;s.value=n.value.toString(),c.textContent=d(l[n.value]),c.title=l[n.value];const u=()=>{const t=parseInt(s.value,10);n.value=t;const r=l[t]||"";c.textContent=d(r),c.title=r,ut(n),jn(),Nt(e)};s.addEventListener("input",u),$(s).on("input",u)}else if("Dropdown"===n.type){const t=r.content.querySelector(".range-block-range"),s=r.content.querySelector(".range-block-counter"),i=(n.dropdownOptions||[]).filter((e=>""!==e.key.trim()));if(i.length<1)return void(a.textContent+=" (Config Error: No Options)");if(t){t.innerHTML="",t.style.flex="1";const r=document.createElement("select");r.id=o,r.className="text_pole slider_macros_dropdown_select",i.forEach((e=>{const t=document.createElement("option");t.value=e.key,t.textContent=e.key,n.value===e.key&&(t.selected=!0),r.appendChild(t)})),n.value&&i.find((e=>e.key===n.value))||(n.value=i[0].key,r.value=i[0].key),r.addEventListener("change",(()=>{n.value=r.value,ut(n),jn(),Nt(e)})),t.appendChild(r)}s&&(s.style.display="none")}else if("Color"===n.type){const t=r.content.querySelector(".range-block-range"),a=r.content.querySelector(".range-block-counter");if(t){t.innerHTML="",t.style.flex="1";const r=document.createElement("div");r.className="slider_macros_color_wrapper";const a=document.createElement("input");a.type="color",a.id=o,a.className="slider_macros_color_input",a.value="string"==typeof n.value&&n.value.startsWith("#")?n.value:"#ffffff";const s=document.createElement("input");s.type="text",s.className="text_pole slider_macros_color_hex",s.value=a.value.toUpperCase(),s.maxLength=7;const i=()=>{n.value=a.value,s.value=a.value.toUpperCase(),ut(n),jn(),Nt(e)},l=()=>{let t=s.value.trim();t.startsWith("#")||(t="#"+t),/^#[0-9A-Fa-f]{6}$/.test(t)&&(a.value=t,n.value=t,ut(n),jn(),Nt(e))};a.addEventListener("input",i),s.addEventListener("change",l),r.appendChild(a),r.appendChild(s),t.appendChild(r)}a&&(a.style.display="none")}else if("Checkbox"===n.type){const t=r.content.querySelector(".range-block-range"),a=r.content.querySelector(".range-block-counter");if(t){t.innerHTML="",t.style.flex="1",t.style.display="flex",t.style.alignItems="center";const r=document.createElement("label");r.className="checkbox_label slider_macros_checkbox_label";const a=document.createElement("input");a.type="checkbox",a.id=o,a.checked=!0===n.value;const s=document.createElement("span");s.className="slider_macros_checkbox_text",s.textContent=!0===n.value?n.checkboxTrueValue||"true":n.checkboxFalseValue||"false",a.addEventListener("change",(()=>{n.value=a.checked,s.textContent=a.checked?n.checkboxTrueValue||"true":n.checkboxFalseValue||"false",ut(n),jn(),Nt(e)})),r.appendChild(a),r.appendChild(s),t.appendChild(r)}a&&(a.style.display="none")}}else{n.value<parseFloat(n.min)&&(n.value=parseFloat(n.min)),n.value>parseFloat(n.max)&&(n.value=parseFloat(n.max));const t=r.content.querySelector('input[type="range"]'),a=r.content.querySelector('input[type="number"]');t.id=o,t.min=n.min,t.max=n.max,t.step=n.step,t.value=n.value.toString(),a.id=o+"_number",a.min=n.min,a.max=n.max,a.step=n.step,a.value=n.value.toString(),a.dataset.for=o;const s=()=>{n.value=parseFloat(t.value),a.value=t.value,ut(n),jn(),Nt(e)};t.addEventListener("input",s),$(t).on("input",s)}t.appendChild(r.content)},m=[];u.groups.forEach((e=>{u.sliders.filter((n=>n.groupId===e.id)).filter((e=>gt(e))).length>0&&m.push({type:"group",group:e})})),u.sliders.forEach((e=>{!e.groupId&&gt(e)&&m.push({type:"slider",slider:e})})),m.sort(((e,n)=>("group"===e.type?e.group.order:e.slider.order)-("group"===n.type?n.group.order:n.slider.order))),m.forEach((e=>{if("slider"===e.type)p(e.slider,a);else{const n=e.group,t=u.sliders.filter((e=>e.groupId===n.id)).sort(((e,n)=>e.order-n.order)),r=document.createElement("div");r.className="slider_macros_group",r.dataset.groupId=n.id,r.dataset.collapsed=n.collapsed?"true":"false";const o=document.createElement("div");o.className="slider_macros_group_header";const s=document.createElement("i");s.className="fa-solid fa-chevron-down slider_macros_group_chevron";const i=document.createElement("span");i.className="slider_macros_group_name",i.textContent=n.name;const l=document.createElement("span");l.className="slider_macros_group_count";const c=t.filter((e=>gt(e))).length;l.textContent=`(${c})`,o.appendChild(s),o.appendChild(i),o.appendChild(l),o.addEventListener("click",(()=>{const e="true"===r.dataset.collapsed;r.dataset.collapsed=e?"false":"true",n.collapsed=!e,jn()})),r.appendChild(o);const d=document.createElement("div");d.className="slider_macros_group_content",t.forEach((e=>p(e,d))),r.appendChild(d),a.appendChild(r)}})),Nt(e)}function Nt(e){const n=e.collections.find((e=>e.active));n&&n.sliders.forEach((e=>{if(!e.enabled||!e.property)return;if("variable"===e.sliderMode)return void console.debug(`[SliderMacros] Skipping macro registration for "${e.name}" - variable mode`);let n;if("MultiSelect"===e.type){const t=(e.options||[]).filter((e=>""!==e.trim()));n=()=>t[e.value]||""}else n="Boolean"===e.type?()=>1===e.value?"true":"false":"Dropdown"===e.type?()=>{const n=e.value,t=(e.dropdownOptions||[]).find((e=>e.key===n));return t?t.value:n}:"Color"===e.type?()=>function(e,n){/^#[0-9A-Fa-f]{6}$/.test(e)||(e="#ffffff");if("hex"===n)return e.toUpperCase();const t=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16);if("rgb"===n)return`rgb(${t}, ${r}, ${o})`;const a=t/255,s=r/255,i=o/255,l=Math.max(a,s,i),c=Math.min(a,s,i),d=l-c;let u=0;0!==d&&(u=l===a?(s-i)/d%6:l===s?(i-a)/d+2:(a-s)/d+4,u=Math.round(60*u),u<0&&(u+=360));const p=0===l?0:Math.round(d/l*100),m=Math.round(100*l);return`hsv(${u}, ${p}%, ${m}%)`}(e.value||"#ffffff",e.colorFormat||"hex"):"Checkbox"===e.type?()=>!0===e.value?e.checkboxTrueValue||"true":e.checkboxFalseValue||"false":()=>e.value.toString();const t=`Slider Macro: ${e.name}`;Gn.experimental_macro_engine?Un.register(e.property,{category:Un.category.PROMPTS,description:t,handler:n}):Qn.registerMacro(e.property,n,t)}))}function Ot(e){const n=(n=500)=>{const t=Dn.preset_settings_openai,r=e.collections.find((e=>e.active));if(!r)return;const o=e.collections.find((e=>e.presets.includes(t)));o&&o!==r&&(o.active=!0,r.active=!1,jn(),Et(e)),setTimeout((()=>{kt(e)}),n)};Pn.on(qn.OAI_PRESET_CHANGED_AFTER,(()=>n(500))),Pn.on(qn.PRESET_CHANGED,(()=>n(500))),Pn.on(qn.MAIN_API_CHANGED,(()=>n(3e3))),Pn.on(qn.CHAT_CHANGED,(()=>{console.log("[SliderMacros] Chat changed - force syncing sliders to variables"),setTimeout((()=>{const e=ht();!function(e,n="write"){const t=e.collections.find((e=>e.active));if(!t)return;let r=0;t.sliders.forEach((e=>{e.syncEnabled&&e.syncForce&&e.syncVariable&&("write"===n?ut(e)&&r++:pt(e)&&r++)})),r>0&&console.log(`[SliderMacros] Force-synced ${r} slider(s) to variables (${n})`)}(e,"write"),kt(e)}),100)}))}const Tt=new MutationObserver(nt((()=>{const e=ht(),n=document.getElementById("completion_prompt_manager"),t=document.getElementById("ai_response_configuration"),r=document.getElementById("slider_macros_drawer"),o=SillyTavern.getContext().mainApi,a="textgenerationwebui"===o;"openai"===o&&n?r&&r.parentElement===n||kt(e):a&&t&&(r&&r.previousElementSibling===t||kt(e))}),500));!function(){Vn(this,void 0,void 0,(function*(){Zn();const e=ht();yt(e),kt(e),Ot(e),Tt.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class","hidden"]}),jn()}))}()})();