(()=>{"use strict";var e={208:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(601),i=n.n(o),r=n(314),s=n.n(r)()(i());s.push([e.id,'#slider_macros_list .textAlignRight {\n    text-align: right;\n}\n\n#slider_macros_list .empty-message {\n    text-align: center;\n    opacity: 0.8;\n    font-size: 0.9em;\n}\n\n\n/* Ensure custom sliders stack vertically and take full width */\n.slider_macros_container .range-block {\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n    width: 100%;\n}\n\n.slider_macros_container .range-block-range-and-counter {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    width: 100%;\n}\n\n.slider_macros_container .range-block-range {\n    flex: 1;\n    /* Ha ha, full width fallback because Flex is a pain! */\n    width: 100%;\n    display: flex;\n    align-items: center;\n}\n\n.slider_macros_container .range-block-range input[type="range"] {\n    /* Forcing a width override to combat the inherit demons */\n    width: 100% !important;\n    margin: 0;\n    /* Add margin to avoid overlap with counter because of NEMO PRESET EXTENSION AAAAAA */\n    margin-right: 10px;\n    max-width: none;\n    flex-grow: 1;\n}\n\n.slider_macros_container .range-block-counter {\n    /* Do not grow, do not shrink, fixed basis, potential problem for mobile later? */\n    width: 60px;\n    min-width: 60px;\n    flex: 0 0 60px;\n    text-align: right;\n    display: flex;\n    justify-content: flex-end;\n}',""]);const l=s},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,i,r){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(o)for(var l=0;l<this.length;l++){var a=this[l][0];null!=a&&(s[a]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);o&&s[u[0]]||(void 0!==r&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=r),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var r={},s=[],l=0;l<e.length;l++){var a=e[l],c=o.base?a[0]+o.base:a[0],u=r[c]||0,f="".concat(c," ").concat(u);r[c]=u+1;var d=n(f),m={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==d)t[d].references++,t[d].updater(m);else{var p=i(m,o);o.byIndex=l,t.splice(l,0,{identifier:f,updater:p,references:1})}s.push(f)}return s}function i(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var r=o(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<r.length;s++){var l=n(r[s]);t[l].references--}for(var a=o(e,i),c=0;c<r.length;c++){var u=n(r[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}r=a}}},659:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,i&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={id:o,exports:{}};return e[o](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;const o=Symbol.for("yaml.alias"),i=Symbol.for("yaml.document"),r=Symbol.for("yaml.map"),s=Symbol.for("yaml.pair"),l=Symbol.for("yaml.scalar"),a=Symbol.for("yaml.seq"),c=Symbol.for("yaml.node.type"),u=e=>!!e&&"object"==typeof e&&e[c]===o,f=e=>!!e&&"object"==typeof e&&e[c]===i,d=e=>!!e&&"object"==typeof e&&e[c]===r,m=e=>!!e&&"object"==typeof e&&e[c]===s,p=e=>!!e&&"object"==typeof e&&e[c]===l,g=e=>!!e&&"object"==typeof e&&e[c]===a;function h(e){if(e&&"object"==typeof e)switch(e[c]){case r:case a:return!0}return!1}function y(e){if(e&&"object"==typeof e)switch(e[c]){case o:case r:case l:case a:return!0}return!1}const v=e=>(p(e)||h(e))&&!!e.anchor,b=Symbol("break visit"),w=Symbol("skip children"),x=Symbol("remove node");function S(e,t){const n=N(t);if(f(e)){E(null,e.contents,n,Object.freeze([e]))===x&&(e.contents=null)}else E(null,e,n,Object.freeze([]))}function E(e,t,n,o){const i=k(e,t,n,o);if(y(i)||m(i))return C(e,o,i),E(e,i,n,o);if("symbol"!=typeof i)if(h(t)){o=Object.freeze(o.concat(t));for(let e=0;e<t.items.length;++e){const i=E(e,t.items[e],n,o);if("number"==typeof i)e=i-1;else{if(i===b)return b;i===x&&(t.items.splice(e,1),e-=1)}}}else if(m(t)){o=Object.freeze(o.concat(t));const e=E("key",t.key,n,o);if(e===b)return b;e===x&&(t.key=null);const i=E("value",t.value,n,o);if(i===b)return b;i===x&&(t.value=null)}return i}async function _(e,t){const n=N(t);if(f(e)){await O(null,e.contents,n,Object.freeze([e]))===x&&(e.contents=null)}else await O(null,e,n,Object.freeze([]))}async function O(e,t,n,o){const i=await k(e,t,n,o);if(y(i)||m(i))return C(e,o,i),O(e,i,n,o);if("symbol"!=typeof i)if(h(t)){o=Object.freeze(o.concat(t));for(let e=0;e<t.items.length;++e){const i=await O(e,t.items[e],n,o);if("number"==typeof i)e=i-1;else{if(i===b)return b;i===x&&(t.items.splice(e,1),e-=1)}}}else if(m(t)){o=Object.freeze(o.concat(t));const e=await O("key",t.key,n,o);if(e===b)return b;e===x&&(t.key=null);const i=await O("value",t.value,n,o);if(i===b)return b;i===x&&(t.value=null)}return i}function N(e){return"object"==typeof e&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function k(e,t,n,o){return"function"==typeof n?n(e,t,o):d(t)?n.Map?.(e,t,o):g(t)?n.Seq?.(e,t,o):m(t)?n.Pair?.(e,t,o):p(t)?n.Scalar?.(e,t,o):u(t)?n.Alias?.(e,t,o):void 0}function C(e,t,n){const o=t[t.length-1];if(h(o))o.items[e]=n;else if(m(o))"key"===e?o.key=n:o.value=n;else{if(!f(o)){const e=u(o)?"alias":"scalar";throw new Error(`Cannot replace node with ${e} parent`)}o.contents=n}}S.BREAK=b,S.SKIP=w,S.REMOVE=x,_.BREAK=b,_.SKIP=w,_.REMOVE=x;const A={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"};class I{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},I.defaultYaml,e),this.tags=Object.assign({},I.defaultTags,t)}clone(){const e=new I(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new I(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:I.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},I.defaultTags)}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:I.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},I.defaultTags),this.atNextDocument=!1);const n=e.trim().split(/[ \t]+/),o=n.shift();switch(o){case"%TAG":{if(2!==n.length&&(t(0,"%TAG directive should contain exactly two parts"),n.length<2))return!1;const[e,o]=n;return this.tags[e]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==n.length)return t(0,"%YAML directive should contain exactly one part"),!1;const[e]=n;if("1.1"===e||"1.2"===e)return this.yaml.version=e,!0;return t(6,`Unsupported YAML version ${e}`,/^\d+\.\d+$/.test(e)),!1}default:return t(0,`Unknown directive ${o}`,!0),!1}}tagName(e,t){if("!"===e)return"!";if("!"!==e[0])return t(`Not a valid tag: ${e}`),null;if("<"===e[1]){const n=e.slice(2,-1);return"!"===n||"!!"===n?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(">"!==e[e.length-1]&&t("Verbatim tags must end with a >"),n)}const[,n,o]=e.match(/^(.*!)([^!]*)$/s);o||t(`The ${e} tag has no suffix`);const i=this.tags[n];if(i)try{return i+decodeURIComponent(o)}catch(e){return t(String(e)),null}return"!"===n?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[t,n]of Object.entries(this.tags))if(e.startsWith(n))return t+e.substring(n.length).replace(/[!,[\]{}]/g,(e=>A[e]));return"!"===e[0]?e:`!<${e}>`}toString(e){const t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],n=Object.entries(this.tags);let o;if(e&&n.length>0&&y(e.contents)){const t={};S(e.contents,((e,n)=>{y(n)&&n.tag&&(t[n.tag]=!0)})),o=Object.keys(t)}else o=[];for(const[i,r]of n)"!!"===i&&"tag:yaml.org,2002:"===r||e&&!o.some((e=>e.startsWith(r)))||t.push(`%TAG ${i} ${r}`);return t.join("\n")}}function L(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const t=JSON.stringify(e);throw new Error(`Anchor must not contain whitespace or control characters: ${t}`)}return!0}function j(e,t,n,o){if(o&&"object"==typeof o)if(Array.isArray(o))for(let t=0,n=o.length;t<n;++t){const n=o[t],i=j(e,o,String(t),n);void 0===i?delete o[t]:i!==n&&(o[t]=i)}else if(o instanceof Map)for(const t of Array.from(o.keys())){const n=o.get(t),i=j(e,o,t,n);void 0===i?o.delete(t):i!==n&&o.set(t,i)}else if(o instanceof Set)for(const t of Array.from(o)){const n=j(e,o,t,t);void 0===n?o.delete(t):n!==t&&(o.delete(t),o.add(n))}else for(const[t,n]of Object.entries(o)){const i=j(e,o,t,n);void 0===i?delete o[t]:i!==n&&(o[t]=i)}return e.call(t,n,o)}function B(e,t,n){if(Array.isArray(e))return e.map(((e,t)=>B(e,String(t),n)));if(e&&"function"==typeof e.toJSON){if(!n||!v(e))return e.toJSON(t,n);const o={aliasCount:0,count:1,res:void 0};n.anchors.set(e,o),n.onCreate=e=>{o.res=e,delete n.onCreate};const i=e.toJSON(t,n);return n.onCreate&&n.onCreate(i),i}return"bigint"!=typeof e||n?.keep?e:Number(e)}I.defaultYaml={explicit:!1,version:"1.2"},I.defaultTags={"!!":"tag:yaml.org,2002:"};class T{constructor(e){Object.defineProperty(this,c,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:n,onAnchor:o,reviver:i}={}){if(!f(e))throw new TypeError("A document argument is required");const r={anchors:new Map,doc:e,keep:!0,mapAsMap:!0===t,mapKeyWarned:!1,maxAliasCount:"number"==typeof n?n:100},s=B(this,"",r);if("function"==typeof o)for(const{count:e,res:t}of r.anchors.values())o(t,e);return"function"==typeof i?j(i,{"":s},"",s):s}}class M extends T{constructor(e){super(o),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let t;return S(e,{Node:(e,n)=>{if(n===this)return S.BREAK;n.anchor===this.source&&(t=n)}}),t}toJSON(e,t){if(!t)return{source:this.source};const{anchors:n,doc:o,maxAliasCount:i}=t,r=this.resolve(o);if(!r){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(e)}let s=n.get(r);if(s||(B(r,null,t),s=n.get(r)),!s||void 0===s.res){throw new ReferenceError("This should not happen: Alias anchor was not resolved?")}if(i>=0&&(s.count+=1,0===s.aliasCount&&(s.aliasCount=F(o,r,n)),s.count*s.aliasCount>i)){throw new ReferenceError("Excessive alias count indicates a resource exhaustion attack")}return s.res}toString(e,t,n){const o=`*${this.source}`;if(e){if(L(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(e)}if(e.implicitKey)return`${o} `}return o}}function F(e,t,n){if(u(t)){const o=t.resolve(e),i=n&&o&&n.get(o);return i?i.count*i.aliasCount:0}if(h(t)){let o=0;for(const i of t.items){const t=F(e,i,n);t>o&&(o=t)}return o}if(m(t)){const o=F(e,t.key,n),i=F(e,t.value,n);return Math.max(o,i)}return 1}const D=e=>!e||"function"!=typeof e&&"object"!=typeof e;class P extends T{constructor(e){super(l),this.value=e}toJSON(e,t){return t?.keep?this.value:B(this.value,e,t)}toString(){return String(this.value)}}P.BLOCK_FOLDED="BLOCK_FOLDED",P.BLOCK_LITERAL="BLOCK_LITERAL",P.PLAIN="PLAIN",P.QUOTE_DOUBLE="QUOTE_DOUBLE",P.QUOTE_SINGLE="QUOTE_SINGLE";const q="tag:yaml.org,2002:";function R(e,t,n){if(f(e)&&(e=e.contents),y(e))return e;if(m(e)){const t=n.schema[r].createNode?.(n.schema,null,n);return t.items.push(e),t}(e instanceof String||e instanceof Number||e instanceof Boolean||"undefined"!=typeof BigInt&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:o,onAnchor:i,onTagObj:s,schema:l,sourceObjects:c}=n;let u;if(o&&e&&"object"==typeof e){if(u=c.get(e),u)return u.anchor||(u.anchor=i(e)),new M(u.anchor);u={anchor:null,node:null},c.set(e,u)}t?.startsWith("!!")&&(t=q+t.slice(2));let d=function(e,t,n){if(t){const e=n.filter((e=>e.tag===t)),o=e.find((e=>!e.format))??e[0];if(!o)throw new Error(`Tag ${t} not found`);return o}return n.find((t=>t.identify?.(e)&&!t.format))}(e,t,l.tags);if(!d){if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),!e||"object"!=typeof e){const t=new P(e);return u&&(u.node=t),t}d=e instanceof Map?l[r]:Symbol.iterator in Object(e)?l[a]:l[r]}s&&(s(d),delete n.onTagObj);const p=d?.createNode?d.createNode(n.schema,e,n):"function"==typeof d?.nodeClass?.from?d.nodeClass.from(n.schema,e,n):new P(e);return t?p.tag=t:d.default||(p.tag=d.tag),u&&(u.node=p),p}function K(e,t,n){let o=n;for(let e=t.length-1;e>=0;--e){const n=t[e];if("number"==typeof n&&Number.isInteger(n)&&n>=0){const e=[];e[n]=o,o=e}else o=new Map([[n,o]])}return R(o,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}class J extends T{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map((t=>y(t)||m(t)?t.clone(e):t)),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if((e=>null==e||"object"==typeof e&&!!e[Symbol.iterator]().next().done)(e))this.add(t);else{const[n,...o]=e,i=this.get(n,!0);if(h(i))i.addIn(o,t);else{if(void 0!==i||!this.schema)throw new Error(`Expected YAML collection at ${n}. Remaining path: ${o}`);this.set(n,K(this.schema,o,t))}}}deleteIn(e){const[t,...n]=e;if(0===n.length)return this.delete(t);const o=this.get(t,!0);if(h(o))return o.deleteIn(n);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${n}`)}getIn(e,t){const[n,...o]=e,i=this.get(n,!0);return 0===o.length?!t&&p(i)?i.value:i:h(i)?i.getIn(o,t):void 0}hasAllNullValues(e){return this.items.every((t=>{if(!m(t))return!1;const n=t.value;return null==n||e&&p(n)&&null==n.value&&!n.commentBefore&&!n.comment&&!n.tag}))}hasIn(e){const[t,...n]=e;if(0===n.length)return this.has(t);const o=this.get(t,!0);return!!h(o)&&o.hasIn(n)}setIn(e,t){const[n,...o]=e;if(0===o.length)this.set(n,t);else{const e=this.get(n,!0);if(h(e))e.setIn(o,t);else{if(void 0!==e||!this.schema)throw new Error(`Expected YAML collection at ${n}. Remaining path: ${o}`);this.set(n,K(this.schema,o,t))}}}}const U=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function V(e,t){return/^\n+$/.test(e)?e.substring(1):t?e.replace(/^(?! *$)/gm,t):e}const W=(e,t,n)=>e.endsWith("\n")?V(n,t):n.includes("\n")?"\n"+V(n,t):(e.endsWith(" ")?"":" ")+n,Y="flow",Q="block",z="quoted";function H(e,t,n="flow",{indentAtStart:o,lineWidth:i=80,minContentWidth:r=20,onFold:s,onOverflow:l}={}){if(!i||i<0)return e;i<r&&(r=0);const a=Math.max(1+r,1+i-t.length);if(e.length<=a)return e;const c=[],u={};let f,d,m=i-t.length;"number"==typeof o&&(o>i-Math.max(2,r)?c.push(0):m=i-o);let p=!1,g=-1,h=-1,y=-1;n===Q&&(g=G(e,g,t.length),-1!==g&&(m=g+a));for(let o;o=e[g+=1];){if(n===z&&"\\"===o){switch(h=g,e[g+1]){case"x":g+=3;break;case"u":g+=5;break;case"U":g+=9;break;default:g+=1}y=g}if("\n"===o)n===Q&&(g=G(e,g,t.length)),m=g+t.length+a,f=void 0;else{if(" "===o&&d&&" "!==d&&"\n"!==d&&"\t"!==d){const t=e[g+1];t&&" "!==t&&"\n"!==t&&"\t"!==t&&(f=g)}if(g>=m)if(f)c.push(f),m=f+a,f=void 0;else if(n===z){for(;" "===d||"\t"===d;)d=o,o=e[g+=1],p=!0;const t=g>y+1?g-2:h-1;if(u[t])return e;c.push(t),u[t]=!0,m=t+a,f=void 0}else p=!0}d=o}if(p&&l&&l(),0===c.length)return e;s&&s();let v=e.slice(0,c[0]);for(let o=0;o<c.length;++o){const i=c[o],r=c[o+1]||e.length;0===i?v=`\n${t}${e.slice(0,r)}`:(n===z&&u[i]&&(v+=`${e[i]}\\`),v+=`\n${t}${e.slice(i+1,r)}`)}return v}function G(e,t,n){let o=t,i=t+1,r=e[i];for(;" "===r||"\t"===r;)if(t<i+n)r=e[++t];else{do{r=e[++t]}while(r&&"\n"!==r);o=t,i=t+1,r=e[i]}return o}const X=(e,t)=>({indentAtStart:t?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),Z=e=>/^(%|---|\.\.\.)/m.test(e);function ee(e,t){const n=JSON.stringify(e);if(t.options.doubleQuotedAsJSON)return n;const{implicitKey:o}=t,i=t.options.doubleQuotedMinMultiLineLength,r=t.indent||(Z(e)?"  ":"");let s="",l=0;for(let e=0,t=n[e];t;t=n[++e])if(" "===t&&"\\"===n[e+1]&&"n"===n[e+2]&&(s+=n.slice(l,e)+"\\ ",e+=1,l=e,t="\\"),"\\"===t)switch(n[e+1]){case"u":{s+=n.slice(l,e);const t=n.substr(e+2,4);switch(t){case"0000":s+="\\0";break;case"0007":s+="\\a";break;case"000b":s+="\\v";break;case"001b":s+="\\e";break;case"0085":s+="\\N";break;case"00a0":s+="\\_";break;case"2028":s+="\\L";break;case"2029":s+="\\P";break;default:"00"===t.substr(0,2)?s+="\\x"+t.substr(2):s+=n.substr(e,6)}e+=5,l=e+1}break;case"n":if(o||'"'===n[e+2]||n.length<i)e+=1;else{for(s+=n.slice(l,e)+"\n\n";"\\"===n[e+2]&&"n"===n[e+3]&&'"'!==n[e+4];)s+="\n",e+=2;s+=r," "===n[e+2]&&(s+="\\"),e+=1,l=e+1}break;default:e+=1}return s=l?s+n.slice(l):n,o?s:H(s,r,z,X(t,!1))}function te(e,t){if(!1===t.options.singleQuote||t.implicitKey&&e.includes("\n")||/[ \t]\n|\n[ \t]/.test(e))return ee(e,t);const n=t.indent||(Z(e)?"  ":""),o="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&\n${n}`)+"'";return t.implicitKey?o:H(o,n,Y,X(t,!1))}function ne(e,t){const{singleQuote:n}=t.options;let o;if(!1===n)o=ee;else{const t=e.includes('"'),i=e.includes("'");o=t&&!i?te:i&&!t?ee:n?te:ee}return o(e,t)}let oe;try{oe=new RegExp("(^|(?<!\n))\n+(?!\n|$)","g")}catch{oe=/\n+(?!\n|$)/g}function ie({comment:e,type:t,value:n},o,i,r){const{blockQuote:s,commentString:l,lineWidth:a}=o.options;if(!s||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return ne(n,o);const c=o.indent||(o.forceBlockIndent||Z(n)?"  ":""),u="literal"===s||"folded"!==s&&t!==P.BLOCK_FOLDED&&(t===P.BLOCK_LITERAL||!function(e,t,n){if(!t||t<0)return!1;const o=t-n,i=e.length;if(i<=o)return!1;for(let t=0,n=0;t<i;++t)if("\n"===e[t]){if(t-n>o)return!0;if(n=t+1,i-n<=o)return!1}return!0}(n,a,c.length));if(!n)return u?"|\n":">\n";let f,d;for(d=n.length;d>0;--d){const e=n[d-1];if("\n"!==e&&"\t"!==e&&" "!==e)break}let m=n.substring(d);const p=m.indexOf("\n");-1===p?f="-":n===m||p!==m.length-1?(f="+",r&&r()):f="",m&&(n=n.slice(0,-m.length),"\n"===m[m.length-1]&&(m=m.slice(0,-1)),m=m.replace(oe,`$&${c}`));let g,h=!1,y=-1;for(g=0;g<n.length;++g){const e=n[g];if(" "===e)h=!0;else{if("\n"!==e)break;y=g}}let v=n.substring(0,y<g?y+1:g);v&&(n=n.substring(v.length),v=v.replace(/\n+/g,`$&${c}`));let b=(h?c?"2":"1":"")+f;if(e&&(b+=" "+l(e.replace(/ ?[\r\n]+/g," ")),i&&i()),!u){const e=n.replace(/\n+/g,"\n$&").replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`);let i=!1;const r=X(o,!0);"folded"!==s&&t!==P.BLOCK_FOLDED&&(r.onOverflow=()=>{i=!0});const l=H(`${v}${e}${m}`,c,Q,r);if(!i)return`>${b}\n${c}${l}`}return`|${b}\n${c}${v}${n=n.replace(/\n+/g,`$&${c}`)}${m}`}function re(e,t,n,o){const{implicitKey:i,inFlow:r}=t,s="string"==typeof e.value?e:Object.assign({},e,{value:String(e.value)});let{type:l}=e;l!==P.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(s.value)&&(l=P.QUOTE_DOUBLE);const a=e=>{switch(e){case P.BLOCK_FOLDED:case P.BLOCK_LITERAL:return i||r?ne(s.value,t):ie(s,t,n,o);case P.QUOTE_DOUBLE:return ee(s.value,t);case P.QUOTE_SINGLE:return te(s.value,t);case P.PLAIN:return function(e,t,n,o){const{type:i,value:r}=e,{actualString:s,implicitKey:l,indent:a,indentStep:c,inFlow:u}=t;if(l&&r.includes("\n")||u&&/[[\]{},]/.test(r))return ne(r,t);if(!r||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(r))return l||u||!r.includes("\n")?ne(r,t):ie(e,t,n,o);if(!l&&!u&&i!==P.PLAIN&&r.includes("\n"))return ie(e,t,n,o);if(Z(r)){if(""===a)return t.forceBlockIndent=!0,ie(e,t,n,o);if(l&&a===c)return ne(r,t)}const f=r.replace(/\n+/g,`$&\n${a}`);if(s){const e=e=>e.default&&"tag:yaml.org,2002:str"!==e.tag&&e.test?.test(f),{compat:n,tags:o}=t.doc.schema;if(o.some(e)||n?.some(e))return ne(r,t)}return l?f:H(f,a,Y,X(t,!1))}(s,t,n,o);default:return null}};let c=a(l);if(null===c){const{defaultKeyType:e,defaultStringType:n}=t.options,o=i&&e||n;if(c=a(o),null===c)throw new Error(`Unsupported default string type ${o}`)}return c}function se(e,t,n,o){if(m(e))return e.toString(t,n,o);if(u(e)){if(t.doc.directives)return e.toString(t);if(t.resolvedAliases?.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(e):t.resolvedAliases=new Set([e]),e=e.resolve(t.doc)}let i;const r=y(e)?e:t.doc.createNode(e,{onTagObj:e=>i=e});i||(i=function(e,t){if(t.tag){const n=e.filter((e=>e.tag===t.tag));if(n.length>0)return n.find((e=>e.format===t.format))??n[0]}let n,o;if(p(t)){o=t.value;let i=e.filter((e=>e.identify?.(o)));if(i.length>1){const e=i.filter((e=>e.test));e.length>0&&(i=e)}n=i.find((e=>e.format===t.format))??i.find((e=>!e.format))}else o=t,n=e.find((e=>e.nodeClass&&o instanceof e.nodeClass));if(!n)throw new Error(`Tag not resolved for ${o?.constructor?.name??typeof o} value`);return n}(t.doc.schema.tags,r));const s=function(e,t,{anchors:n,doc:o}){if(!o.directives)return"";const i=[],r=(p(e)||h(e))&&e.anchor;r&&L(r)&&(n.add(r),i.push(`&${r}`));const s=e.tag?e.tag:t.default?null:t.tag;return s&&i.push(o.directives.tagString(s)),i.join(" ")}(r,i,t);s.length>0&&(t.indentAtStart=(t.indentAtStart??0)+s.length+1);const l="function"==typeof i.stringify?i.stringify(r,t,n,o):p(r)?re(r,t,n,o):r.toString(t,n,o);return s?p(r)||"{"===l[0]||"["===l[0]?`${s} ${l}`:`${s}\n${t.indent}${l}`:l}const le="<<",ae={identify:e=>e===le||"symbol"==typeof e&&e.description===le,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new P(Symbol(le)),{addToJSMap:ce}),stringify:()=>le};function ce(e,t,n){if(n=e&&u(n)?n.resolve(e.doc):n,g(n))for(const o of n.items)ue(e,t,o);else if(Array.isArray(n))for(const o of n)ue(e,t,o);else ue(e,t,n)}function ue(e,t,n){const o=e&&u(n)?n.resolve(e.doc):n;if(!d(o))throw new Error("Merge sources must be maps or map aliases");const i=o.toJSON(null,e,Map);for(const[e,n]of i)t instanceof Map?t.has(e)||t.set(e,n):t instanceof Set?t.add(e):Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0});return t}function fe(e,t,{key:n,value:o}){if(y(n)&&n.addToJSMap)n.addToJSMap(e,t,o);else if(((e,t)=>(ae.identify(t)||p(t)&&(!t.type||t.type===P.PLAIN)&&ae.identify(t.value))&&e?.doc.schema.tags.some((e=>e.tag===ae.tag&&e.default)))(e,n))ce(e,t,o);else{const i=B(n,"",e);if(t instanceof Map)t.set(i,B(o,i,e));else if(t instanceof Set)t.add(i);else{const r=function(e,t,n){if(null===t)return"";if("object"!=typeof t)return String(t);if(y(e)&&n?.doc){const t=function(e,t){const n=Object.assign({blockQuote:!0,commentString:U,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,t);let o;switch(n.collectionStyle){case"block":o=!1;break;case"flow":o=!0;break;default:o=null}return{anchors:new Set,doc:e,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:"number"==typeof n.indent?" ".repeat(n.indent):"  ",inFlow:o,options:n}}(n.doc,{});t.anchors=new Set;for(const e of n.anchors.keys())t.anchors.add(e.anchor);t.inFlow=!0,t.inStringifyKey=!0;const r=e.toString(t);if(!n.mapKeyWarned){let e=JSON.stringify(r);e.length>40&&(e=e.substring(0,36)+'..."'),o=n.doc.options.logLevel,i=`Keys with collection values will be stringified due to JS Object restrictions: ${e}. Set mapAsMap: true to use object keys.`,"debug"!==o&&"warn"!==o||console.warn(i),n.mapKeyWarned=!0}return r}var o,i;return JSON.stringify(t)}(n,i,e),s=B(o,r,e);r in t?Object.defineProperty(t,r,{value:s,writable:!0,enumerable:!0,configurable:!0}):t[r]=s}}return t}function de(e,t,n){const o=R(e,void 0,n),i=R(t,void 0,n);return new me(o,i)}class me{constructor(e,t=null){Object.defineProperty(this,c,{value:s}),this.key=e,this.value=t}clone(e){let{key:t,value:n}=this;return y(t)&&(t=t.clone(e)),y(n)&&(n=n.clone(e)),new me(t,n)}toJSON(e,t){return fe(t,t?.mapAsMap?new Map:{},this)}toString(e,t,n){return e?.doc?function({key:e,value:t},n,o,i){const{allNullValues:r,doc:s,indent:l,indentStep:a,options:{commentString:c,indentSeq:u,simpleKeys:f}}=n;let d=y(e)&&e.comment||null;if(f){if(d)throw new Error("With simple keys, key nodes cannot have comments");if(h(e)||!y(e)&&"object"==typeof e)throw new Error("With simple keys, collection cannot be used as a key value")}let m=!f&&(!e||d&&null==t&&!n.inFlow||h(e)||(p(e)?e.type===P.BLOCK_FOLDED||e.type===P.BLOCK_LITERAL:"object"==typeof e));n=Object.assign({},n,{allNullValues:!1,implicitKey:!m&&(f||!r),indent:l+a});let v,b,w,x=!1,S=!1,E=se(e,n,(()=>x=!0),(()=>S=!0));if(!m&&!n.inFlow&&E.length>1024){if(f)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");m=!0}if(n.inFlow){if(r||null==t)return x&&o&&o(),""===E?"?":m?`? ${E}`:E}else if(r&&!f||null==t&&m)return E=`? ${E}`,d&&!x?E+=W(E,n.indent,c(d)):S&&i&&i(),E;x&&(d=null),m?(d&&(E+=W(E,n.indent,c(d))),E=`? ${E}\n${l}:`):(E=`${E}:`,d&&(E+=W(E,n.indent,c(d)))),y(t)?(v=!!t.spaceBefore,b=t.commentBefore,w=t.comment):(v=!1,b=null,w=null,t&&"object"==typeof t&&(t=s.createNode(t))),n.implicitKey=!1,m||d||!p(t)||(n.indentAtStart=E.length+1),S=!1,u||!(a.length>=2)||n.inFlow||m||!g(t)||t.flow||t.tag||t.anchor||(n.indent=n.indent.substring(2));let _=!1;const O=se(t,n,(()=>_=!0),(()=>S=!0));let N=" ";if(d||v||b)N=v?"\n":"",b&&(N+=`\n${V(c(b),n.indent)}`),""!==O||n.inFlow?N+=`\n${n.indent}`:"\n"===N&&(N="\n\n");else if(!m&&h(t)){const e=O[0],o=O.indexOf("\n"),i=-1!==o,r=n.inFlow??t.flow??0===t.items.length;if(i||!r){let t=!1;if(i&&("&"===e||"!"===e)){let n=O.indexOf(" ");"&"===e&&-1!==n&&n<o&&"!"===O[n+1]&&(n=O.indexOf(" ",n+1)),(-1===n||o<n)&&(t=!0)}t||(N=`\n${n.indent}`)}}else""!==O&&"\n"!==O[0]||(N="");return E+=N+O,n.inFlow?_&&o&&o():w&&!_?E+=W(E,n.indent,c(w)):S&&i&&i(),E}(this,e,t,n):JSON.stringify(this)}}function pe(e,t,n){return(t.inFlow??e.flow?he:ge)(e,t,n)}function ge({comment:e,items:t},n,{blockItemPrefix:o,flowChars:i,itemIndent:r,onChompKeep:s,onComment:l}){const{indent:a,options:{commentString:c}}=n,u=Object.assign({},n,{indent:r,type:null});let f=!1;const d=[];for(let e=0;e<t.length;++e){const i=t[e];let s=null;if(y(i))!f&&i.spaceBefore&&d.push(""),ye(n,d,i.commentBefore,f),i.comment&&(s=i.comment);else if(m(i)){const e=y(i.key)?i.key:null;e&&(!f&&e.spaceBefore&&d.push(""),ye(n,d,e.commentBefore,f))}f=!1;let l=se(i,u,(()=>s=null),(()=>f=!0));s&&(l+=W(l,r,c(s))),f&&s&&(f=!1),d.push(o+l)}let p;if(0===d.length)p=i.start+i.end;else{p=d[0];for(let e=1;e<d.length;++e){const t=d[e];p+=t?`\n${a}${t}`:"\n"}}return e?(p+="\n"+V(c(e),a),l&&l()):f&&s&&s(),p}function he({items:e},t,{flowChars:n,itemIndent:o}){const{indent:i,indentStep:r,flowCollectionPadding:s,options:{commentString:l}}=t;o+=r;const a=Object.assign({},t,{indent:o,inFlow:!0,type:null});let c=!1,u=0;const f=[];for(let n=0;n<e.length;++n){const i=e[n];let r=null;if(y(i))i.spaceBefore&&f.push(""),ye(t,f,i.commentBefore,!1),i.comment&&(r=i.comment);else if(m(i)){const e=y(i.key)?i.key:null;e&&(e.spaceBefore&&f.push(""),ye(t,f,e.commentBefore,!1),e.comment&&(c=!0));const n=y(i.value)?i.value:null;n?(n.comment&&(r=n.comment),n.commentBefore&&(c=!0)):null==i.value&&e?.comment&&(r=e.comment)}r&&(c=!0);let s=se(i,a,(()=>r=null));n<e.length-1&&(s+=","),r&&(s+=W(s,o,l(r))),!c&&(f.length>u||s.includes("\n"))&&(c=!0),f.push(s),u=f.length}const{start:d,end:p}=n;if(0===f.length)return d+p;if(!c){const e=f.reduce(((e,t)=>e+t.length+2),2);c=t.options.lineWidth>0&&e>t.options.lineWidth}if(c){let e=d;for(const t of f)e+=t?`\n${r}${i}${t}`:"\n";return`${e}\n${i}${p}`}return`${d}${s}${f.join(" ")}${s}${p}`}function ye({indent:e,options:{commentString:t}},n,o,i){if(o&&i&&(o=o.replace(/^\n+/,"")),o){const i=V(t(o),e);n.push(i.trimStart())}}function ve(e,t){const n=p(t)?t.value:t;for(const o of e)if(m(o)){if(o.key===t||o.key===n)return o;if(p(o.key)&&o.key.value===n)return o}}class be extends J{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(r,e),this.items=[]}static from(e,t,n){const{keepUndefined:o,replacer:i}=n,r=new this(e),s=(e,s)=>{if("function"==typeof i)s=i.call(t,e,s);else if(Array.isArray(i)&&!i.includes(e))return;(void 0!==s||o)&&r.items.push(de(e,s,n))};if(t instanceof Map)for(const[e,n]of t)s(e,n);else if(t&&"object"==typeof t)for(const e of Object.keys(t))s(e,t[e]);return"function"==typeof e.sortMapEntries&&r.items.sort(e.sortMapEntries),r}add(e,t){let n;n=m(e)?e:e&&"object"==typeof e&&"key"in e?new me(e.key,e.value):new me(e,e?.value);const o=ve(this.items,n.key),i=this.schema?.sortMapEntries;if(o){if(!t)throw new Error(`Key ${n.key} already set`);p(o.value)&&D(n.value)?o.value.value=n.value:o.value=n.value}else if(i){const e=this.items.findIndex((e=>i(n,e)<0));-1===e?this.items.push(n):this.items.splice(e,0,n)}else this.items.push(n)}delete(e){const t=ve(this.items,e);if(!t)return!1;return this.items.splice(this.items.indexOf(t),1).length>0}get(e,t){const n=ve(this.items,e),o=n?.value;return(!t&&p(o)?o.value:o)??void 0}has(e){return!!ve(this.items,e)}set(e,t){this.add(new me(e,t),!0)}toJSON(e,t,n){const o=n?new n:t?.mapAsMap?new Map:{};t?.onCreate&&t.onCreate(o);for(const e of this.items)fe(t,o,e);return o}toString(e,t,n){if(!e)return JSON.stringify(this);for(const e of this.items)if(!m(e))throw new Error(`Map items must all be pairs; found ${JSON.stringify(e)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),pe(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:n,onComment:t})}}const we={collection:"map",default:!0,nodeClass:be,tag:"tag:yaml.org,2002:map",resolve:(e,t)=>(d(e)||t("Expected a mapping for this tag"),e),createNode:(e,t,n)=>be.from(e,t,n)};class xe extends J{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(a,e),this.items=[]}add(e){this.items.push(e)}delete(e){const t=Se(e);if("number"!=typeof t)return!1;return this.items.splice(t,1).length>0}get(e,t){const n=Se(e);if("number"!=typeof n)return;const o=this.items[n];return!t&&p(o)?o.value:o}has(e){const t=Se(e);return"number"==typeof t&&t<this.items.length}set(e,t){const n=Se(e);if("number"!=typeof n)throw new Error(`Expected a valid index, not ${e}.`);const o=this.items[n];p(o)&&D(t)?o.value=t:this.items[n]=t}toJSON(e,t){const n=[];t?.onCreate&&t.onCreate(n);let o=0;for(const e of this.items)n.push(B(e,String(o++),t));return n}toString(e,t,n){return e?pe(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:n,onComment:t}):JSON.stringify(this)}static from(e,t,n){const{replacer:o}=n,i=new this(e);if(t&&Symbol.iterator in Object(t)){let e=0;for(let r of t){if("function"==typeof o){const n=t instanceof Set?r:String(e++);r=o.call(t,n,r)}i.items.push(R(r,void 0,n))}}return i}}function Se(e){let t=p(e)?e.value:e;return t&&"string"==typeof t&&(t=Number(t)),"number"==typeof t&&Number.isInteger(t)&&t>=0?t:null}const Ee={collection:"seq",default:!0,nodeClass:xe,tag:"tag:yaml.org,2002:seq",resolve:(e,t)=>(g(e)||t("Expected a sequence for this tag"),e),createNode:(e,t,n)=>xe.from(e,t,n)},_e={identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:(e,t,n,o)=>re(e,t=Object.assign({actualString:!0},t),n,o)},Oe={identify:e=>null==e,createNode:()=>new P(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new P(null),stringify:({source:e},t)=>"string"==typeof e&&Oe.test.test(e)?e:t.options.nullStr},Ne={identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new P("t"===e[0]||"T"===e[0]),stringify({source:e,value:t},n){if(e&&Ne.test.test(e)){if(t===("t"===e[0]||"T"===e[0]))return e}return t?n.options.trueStr:n.options.falseStr}};function $e({format:e,minFractionDigits:t,tag:n,value:o}){if("bigint"==typeof o)return String(o);const i="number"==typeof o?o:Number(o);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let r=JSON.stringify(o);if(!e&&t&&(!n||"tag:yaml.org,2002:float"===n)&&/^\d/.test(r)){let e=r.indexOf(".");e<0&&(e=r.length,r+=".");let n=t-(r.length-e-1);for(;n-- >0;)r+="0"}return r}const ke={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:$e},Ce={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():$e(e)}},Ae={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const t=new P(parseFloat(e)),n=e.indexOf(".");return-1!==n&&"0"===e[e.length-1]&&(t.minFractionDigits=e.length-n-1),t},stringify:$e},Ie=e=>"bigint"==typeof e||Number.isInteger(e),Le=(e,t,n,{intAsBigInt:o})=>o?BigInt(e):parseInt(e.substring(t),n);function je(e,t,n){const{value:o}=e;return Ie(o)&&o>=0?n+o.toString(t):$e(e)}const Be={identify:e=>Ie(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,t,n)=>Le(e,2,8,n),stringify:e=>je(e,8,"0o")},Te={identify:Ie,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,t,n)=>Le(e,0,10,n),stringify:$e},Me={identify:e=>Ie(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,t,n)=>Le(e,2,16,n),stringify:e=>je(e,16,"0x")},Fe=[we,Ee,_e,Oe,Ne,Be,Te,Me,ke,Ce,Ae];function De(e){return"bigint"==typeof e||Number.isInteger(e)}const Pe=({value:e})=>JSON.stringify(e),qe=[we,Ee].concat([{identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:Pe},{identify:e=>null==e,createNode:()=>new P(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Pe},{identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:e=>"true"===e,stringify:Pe},{identify:De,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,t,{intAsBigInt:n})=>n?BigInt(e):parseInt(e,10),stringify:({value:e})=>De(e)?e.toString():JSON.stringify(e)},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:Pe}],{default:!0,tag:"",test:/^/,resolve:(e,t)=>(t(`Unresolved plain scalar ${JSON.stringify(e)}`),e)}),Re={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,t){if("function"==typeof atob){const t=atob(e.replace(/[\n\r]/g,"")),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n[e]=t.charCodeAt(e);return n}return t("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:t,value:n},o,i,r){if(!n)return"";const s=n;let l;if("function"!=typeof btoa)throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");{let e="";for(let t=0;t<s.length;++t)e+=String.fromCharCode(s[t]);l=btoa(e)}if(t||(t=P.BLOCK_LITERAL),t!==P.QUOTE_DOUBLE){const e=Math.max(o.options.lineWidth-o.indent.length,o.options.minContentWidth),n=Math.ceil(l.length/e),i=new Array(n);for(let t=0,o=0;t<n;++t,o+=e)i[t]=l.substr(o,e);l=i.join(t===P.BLOCK_LITERAL?"\n":" ")}return re({comment:e,type:t,value:l},o,i,r)}};function Ke(e,t){if(g(e))for(let n=0;n<e.items.length;++n){let o=e.items[n];if(!m(o)){if(d(o)){o.items.length>1&&t("Each pair must have its own sequence indicator");const e=o.items[0]||new me(new P(null));if(o.commentBefore&&(e.key.commentBefore=e.key.commentBefore?`${o.commentBefore}\n${e.key.commentBefore}`:o.commentBefore),o.comment){const t=e.value??e.key;t.comment=t.comment?`${o.comment}\n${t.comment}`:o.comment}o=e}e.items[n]=m(o)?o:new me(o)}}else t("Expected a sequence for this tag");return e}function Je(e,t,n){const{replacer:o}=n,i=new xe(e);i.tag="tag:yaml.org,2002:pairs";let r=0;if(t&&Symbol.iterator in Object(t))for(let e of t){let s,l;if("function"==typeof o&&(e=o.call(t,String(r++),e)),Array.isArray(e)){if(2!==e.length)throw new TypeError(`Expected [key, value] tuple: ${e}`);s=e[0],l=e[1]}else if(e&&e instanceof Object){const t=Object.keys(e);if(1!==t.length)throw new TypeError(`Expected tuple with one key, not ${t.length} keys`);s=t[0],l=e[s]}else s=e;i.items.push(de(s,l,n))}return i}const Ue={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:Ke,createNode:Je};class Ve extends xe{constructor(){super(),this.add=be.prototype.add.bind(this),this.delete=be.prototype.delete.bind(this),this.get=be.prototype.get.bind(this),this.has=be.prototype.has.bind(this),this.set=be.prototype.set.bind(this),this.tag=Ve.tag}toJSON(e,t){if(!t)return super.toJSON(e);const n=new Map;t?.onCreate&&t.onCreate(n);for(const e of this.items){let o,i;if(m(e)?(o=B(e.key,"",t),i=B(e.value,o,t)):o=B(e,"",t),n.has(o))throw new Error("Ordered maps must not include duplicate keys");n.set(o,i)}return n}static from(e,t,n){const o=Je(e,t,n),i=new this;return i.items=o.items,i}}Ve.tag="tag:yaml.org,2002:omap";const We={collection:"seq",identify:e=>e instanceof Map,nodeClass:Ve,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,t){const n=Ke(e,t),o=[];for(const{key:e}of n.items)p(e)&&(o.includes(e.value)?t(`Ordered maps must not include duplicate keys: ${e.value}`):o.push(e.value));return Object.assign(new Ve,n)},createNode:(e,t,n)=>Ve.from(e,t,n)};function Ye({value:e,source:t},n){return t&&(e?Qe:ze).test.test(t)?t:e?n.options.trueStr:n.options.falseStr}const Qe={identify:e=>!0===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new P(!0),stringify:Ye},ze={identify:e=>!1===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new P(!1),stringify:Ye},He={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:$e},Ge={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():$e(e)}},Xe={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const t=new P(parseFloat(e.replace(/_/g,""))),n=e.indexOf(".");if(-1!==n){const o=e.substring(n+1).replace(/_/g,"");"0"===o[o.length-1]&&(t.minFractionDigits=o.length)}return t},stringify:$e},Ze=e=>"bigint"==typeof e||Number.isInteger(e);function et(e,t,n,{intAsBigInt:o}){const i=e[0];if("-"!==i&&"+"!==i||(t+=1),e=e.substring(t).replace(/_/g,""),o){switch(n){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`}const t=BigInt(e);return"-"===i?BigInt(-1)*t:t}const r=parseInt(e,n);return"-"===i?-1*r:r}function tt(e,t,n){const{value:o}=e;if(Ze(o)){const e=o.toString(t);return o<0?"-"+n+e.substr(1):n+e}return $e(e)}const nt={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,t,n)=>et(e,2,2,n),stringify:e=>tt(e,2,"0b")},ot={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,t,n)=>et(e,1,8,n),stringify:e=>tt(e,8,"0")},it={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,t,n)=>et(e,0,10,n),stringify:$e},rt={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,t,n)=>et(e,2,16,n),stringify:e=>tt(e,16,"0x")};class st extends be{constructor(e){super(e),this.tag=st.tag}add(e){let t;t=m(e)?e:e&&"object"==typeof e&&"key"in e&&"value"in e&&null===e.value?new me(e.key,null):new me(e,null);ve(this.items,t.key)||this.items.push(t)}get(e,t){const n=ve(this.items,e);return!t&&m(n)?p(n.key)?n.key.value:n.key:n}set(e,t){if("boolean"!=typeof t)throw new Error("Expected boolean value for set(key, value) in a YAML set, not "+typeof t);const n=ve(this.items,e);n&&!t?this.items.splice(this.items.indexOf(n),1):!n&&t&&this.items.push(new me(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,n){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,n);throw new Error("Set items must all have null values")}static from(e,t,n){const{replacer:o}=n,i=new this(e);if(t&&Symbol.iterator in Object(t))for(let e of t)"function"==typeof o&&(e=o.call(t,e,e)),i.items.push(de(e,null,n));return i}}st.tag="tag:yaml.org,2002:set";const lt={collection:"map",identify:e=>e instanceof Set,nodeClass:st,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,t,n)=>st.from(e,t,n),resolve(e,t){if(d(e)){if(e.hasAllNullValues(!0))return Object.assign(new st,e);t("Set items must all have null values")}else t("Expected a mapping for this tag");return e}};function at(e,t){const n=e[0],o="-"===n||"+"===n?e.substring(1):e,i=e=>t?BigInt(e):Number(e),r=o.replace(/_/g,"").split(":").reduce(((e,t)=>e*i(60)+i(t)),i(0));return"-"===n?i(-1)*r:r}function ct(e){let{value:t}=e,n=e=>e;if("bigint"==typeof t)n=e=>BigInt(e);else if(isNaN(t)||!isFinite(t))return $e(e);let o="";t<0&&(o="-",t*=n(-1));const i=n(60),r=[t%i];return t<60?r.unshift(0):(t=(t-r[0])/i,r.unshift(t%i),t>=60&&(t=(t-r[0])/i,r.unshift(t))),o+r.map((e=>String(e).padStart(2,"0"))).join(":").replace(/000000\d*$/,"")}const ut={identify:e=>"bigint"==typeof e||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,t,{intAsBigInt:n})=>at(e,n),stringify:ct},ft={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>at(e,!1),stringify:ct},dt={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const t=e.match(dt.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,o,i,r,s,l]=t.map(Number),a=t[7]?Number((t[7]+"00").substr(1,3)):0;let c=Date.UTC(n,o-1,i,r||0,s||0,l||0,a);const u=t[8];if(u&&"Z"!==u){let e=at(u,!1);Math.abs(e)<30&&(e*=60),c-=6e4*e}return new Date(c)},stringify:({value:e})=>e?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""},mt=[we,Ee,_e,Oe,Qe,ze,nt,ot,it,rt,He,Ge,Xe,Re,ae,We,Ue,lt,ut,ft,dt];new Map([["core",Fe],["failsafe",[we,Ee,_e]],["json",qe],["yaml11",mt],["yaml-1.1",mt]]);Error;const pt=Symbol("break visit"),gt=Symbol("skip children"),ht=Symbol("remove item");function yt(e,t){"type"in e&&"document"===e.type&&(e={start:e.start,value:e.value}),vt(Object.freeze([]),e,t)}function vt(e,t,n){let o=n(t,e);if("symbol"==typeof o)return o;for(const i of["key","value"]){const r=t[i];if(r&&"items"in r){for(let t=0;t<r.items.length;++t){const o=vt(Object.freeze(e.concat([[i,t]])),r.items[t],n);if("number"==typeof o)t=o-1;else{if(o===pt)return pt;o===ht&&(r.items.splice(t,1),t-=1)}}"function"==typeof o&&"key"===i&&(o=o(t,e))}}return"function"==typeof o?o(t,e):o}yt.BREAK=pt,yt.SKIP=gt,yt.REMOVE=ht,yt.itemAtPath=(e,t)=>{let n=e;for(const[e,o]of t){const t=n?.[e];if(!t||!("items"in t))return;n=t.items[o]}return n},yt.parentCollection=(e,t)=>{const n=yt.itemAtPath(e,t.slice(0,-1)),o=t[t.length-1][0],i=n?.[o];if(i&&"items"in i)return i;throw new Error("Parent collection not found")};new Set("0123456789ABCDEFabcdef"),new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),new Set(",[]{}"),new Set(" ,[]{}\n\r\t");var bt=n(72),wt=n.n(bt),xt=n(825),St=n.n(xt),Et=n(659),_t=n.n(Et),Ot=n(56),Nt=n.n(Ot),$t=n(540),kt=n.n($t),Ct=n(113),At=n.n(Ct),It=n(208),Lt={};Lt.styleTagTransform=At(),Lt.setAttributes=Nt(),Lt.insert=_t().bind(null,"head"),Lt.domAPI=St(),Lt.insertStyleElement=kt();wt()(It.A,Lt);It.A&&It.A.locals&&It.A.locals;const jt='<div class="flex-container flexFlowColumn flexNoGap"> <div class="flex-container justifyContentFlexEnd"> <label class="checkbox_label"> <input type="checkbox" name="enabled"> <small>Enabled</small> </label> </div> <div class="flex-container alignItemsBaseline"> <small class="flex1 textAlignRight">Name</small> <input class="flex2 text_pole textarea_compact" type="text" name="name" placeholder="e.g. Macro Slider A"> </div> <div class="flex-container alignItemsBaseline"> <small class="flex1 textAlignRight">Macro Var</small> <input class="flex2 text_pole textarea_compact" type="text" name="property" placeholder="e.g. macroVarA"> </div> <div class="flex-container alignItemsBaseline"> <small class="flex1 textAlignRight">Slider Type</small> <select class="flex2 text_pole textarea_compact" name="type"> <option value="Numeric" selected="selected">Numeric</option> <option value="Boolean">Boolean</option> <option value="MultiSelect">MultiSelect</option> </select> </div> <div class="numeric-only"> <div class="flex-container alignItemsBaseline"> <small class="flex1 textAlignRight">Min Value</small> <input class="flex2 text_pole textarea_compact" type="text" name="min" placeholder="e.g. 0"> </div> <div class="flex-container alignItemsBaseline"> <small class="flex1 textAlignRight">Max Value</small> <input class="flex2 text_pole textarea_compact" type="text" name="max" placeholder="e.g. 1"> </div> <div class="flex-container alignItemsBaseline"> <small class="flex1 textAlignRight">Step</small> <input class="flex2 text_pole textarea_compact" type="text" name="step" placeholder="e.g. 0.01"> </div> </div> <div class="boolean-only"> <div class="flex-container alignItemsBaseline"> <small class="flex1 textAlignRight">Default Value</small> <select class="flex2 text_pole textarea_compact" name="defaultBoolean"> <option value="true">True</option> <option value="false">False</option> </select> </div> </div> <div class="multiselect-only"> <div class="flex-container alignItemsBaseline"> <small class="flex1 textAlignRight">Option 1</small> <input class="flex2 text_pole textarea_compact" type="text" name="option1" placeholder="e.g. Red"> </div> <div class="flex-container alignItemsBaseline"> <small class="flex1 textAlignRight">Option 2</small> <input class="flex2 text_pole textarea_compact" type="text" name="option2" placeholder="e.g. Blue"> </div> <div class="flex-container alignItemsBaseline optional-option"> <small class="flex1 textAlignRight">Option 3</small> <input class="flex2 text_pole textarea_compact" type="text" name="option3" placeholder="Optional"> </div> <div class="flex-container alignItemsBaseline optional-option"> <small class="flex1 textAlignRight">Option 4</small> <input class="flex2 text_pole textarea_compact" type="text" name="option4" placeholder="Optional"> </div> </div> <div class="flex-container justifyCenter"> <button class="menu_button menu_button_icon" name="up" type="button"> <i class="fa-solid fa-chevron-up"></i> <span data-i18n="Move Up">Move Up</span> </button> <button class="menu_button menu_button_icon" name="down" type="button"> <i class="fa-solid fa-chevron-down"></i> <span data-i18n="Move Down">Move Down</span> </button> <button class="menu_button menu_button_icon" name="delete" type="button"> <i class="fa-solid fa-trash-alt"></i> <span data-i18n="Delete">Delete</span> </button> </div> </div>';const Bt='<div class="range-block" data-source="openai,claude,aimlapi,openrouter,ai21,makersuite,vertexai,mistralai,custom,cohere,perplexity,groq,siliconflow,electronhub,chutes,nanogpt,deepseek,xai,pollinations,moonshot,fireworks,cometapi,azure_openai,zai"> <div class="range-block-title"></div> <div class="range-block-range-and-counter"> <div class="range-block-range"> <input type="range"> </div> <div class="range-block-counter"> <input type="number"> </div> </div> </div>';var Tt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}a((o=o.apply(e,t||[])).next())}))};const{saveSettingsDebounced:Mt,event_types:Ft,eventSource:Dt,chatCompletionSettings:Pt,Popup:qt,powerUserSettings:Rt,macros:Kt,MacrosParser:Jt}=SillyTavern.getContext(),Ut="sliderMacros",Vt=Object.freeze({collections:[{active:!0,name:"Default",sliders:[],presets:[]}]});function Wt(){const e=SillyTavern.getContext().extensionSettings;e[Ut]||(e[Ut]=structuredClone(Vt));for(const t in Vt)void 0===e[Ut][t]&&(e[Ut][t]=Vt[t]);const t=e[Ut];return 0===t.collections.length&&t.collections.push(Vt.collections[0]),t.collections.some((e=>e.active))||(t.collections[0].active=!0),t}function Yt(){return{create:document.getElementById("slider_macros_create"),list:document.getElementById("slider_macros_list"),rangeBlock:document.getElementById("range_block_openai"),collections:document.getElementById("slider_macros_collections"),createCollection:document.getElementById("slider_macros_create_collection"),deleteCollection:document.getElementById("slider_macros_delete_collection"),bindToPreset:document.getElementById("slider_macros_bind_to_preset"),hint:document.getElementById("slider_macros_hint"),importFile:document.getElementById("slider_macros_import_file"),importCollection:document.getElementById("slider_macros_import_collection"),exportCollection:document.getElementById("slider_macros_export_collection")}}function Qt(e){var t;const n=null!==(t=document.getElementById("slider_macros_container"))&&void 0!==t?t:document.getElementById("extensions_settings");if(!n)return;const o=document.createElement("template");o.innerHTML='<div id="slider_macros_settings"> <div class="inline-drawer"> <div class="inline-drawer-toggle inline-drawer-header"> <b> <span>Slider Macros</span> </b> <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div> </div> <div class="inline-drawer-content"> <div class="flex-container"> <input type="file" id="slider_macros_import_file" hidden accept=".json"> <select class="text_pole flex1" id="slider_macros_collections"></select> <div id="slider_macros_create_collection" class="menu_button menu_button_icon" title="Create New Collection"> <i class="fa-solid fa-file-circle-plus"></i> </div> <div id="slider_macros_bind_to_preset" class="menu_button menu_button_icon" title="Bind collection to Preset"> <i class="fa-solid fa-link"></i> </div> <div id="slider_macros_import_collection" class="menu_button menu_button_icon" title="Import Collection"> <i class="fa-solid fa-file-import"></i> </div> <div id="slider_macros_export_collection" class="menu_button menu_button_icon" title="Export Collection"> <i class="fa-solid fa-file-export"></i> </div> <div id="slider_macros_delete_collection" class="menu_button menu_button_icon" title="Delete Collection"> <i class="fa-solid fa-trash-alt"></i> </div> </div> <div class="flex-container"> <div id="slider_macros_create" class="menu_button menu_button_icon"> <i class="fa-solid fa-plus"></i> <span data-i18n="Create Slider"> Create Slider </span> </div> </div> <hr> <div id="slider_macros_list"></div> </div> </div> </div>',n.appendChild(o.content);const i=Yt();i.create.addEventListener("click",Xt),i.createCollection.addEventListener("click",Ht),i.deleteCollection.addEventListener("click",zt),i.bindToPreset.addEventListener("click",Gt),i.collections.addEventListener("change",(t=>{const n=i.collections.value;e.collections.forEach((e=>{e.active=e.name===n})),Mt(),Zt(e)})),i.importCollection.addEventListener("click",(()=>Tt(this,void 0,void 0,(function*(){i.importFile.click()})))),i.exportCollection.addEventListener("click",(()=>Tt(this,void 0,void 0,(function*(){const t=e.collections.find((e=>e.active));if(!t)return;const n=t.name+".json",o=JSON.stringify(t.sliders,null,4),i=new Blob([o],{type:"application/json"}),r=URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.download=n,s.click(),URL.revokeObjectURL(r)})))),i.importFile.addEventListener("change",(t=>{var n;const o=null===(n=i.importFile.files)||void 0===n?void 0:n[0];if(!o)return;const r=new FileReader;r.onload=t=>{var n;try{const i=o.name.split(".").shift()||"imported",r=null===(n=t.target)||void 0===n?void 0:n.result,s=JSON.parse(r);if(!Array.isArray(s))return void toastr.error("Invalid JSON file format.");!function(e,t,n){Tt(this,void 0,void 0,(function*(){const o=yield qt.show.input("Import Collection","Enter the name of the new collection:",e);if(!o)return;if(n.collections.find((e=>e.name===o)))return void toastr.warning("Collection with this name already exists.");const i={active:!0,name:o,sliders:t,presets:[]};n.collections.forEach((e=>{e.active=!1})),n.collections.push(i),Mt(),Zt(n),toastr.success(`Imported ${t.length} sliders into collection "${o}".`)}))}(i,s,e)}catch(e){return void toastr.error("Failed to parse JSON file.")}},r.readAsText(o),i.importFile.value=""}))}function zt(){return Tt(this,void 0,void 0,(function*(){const e=Wt();if(1===e.collections.length)return void toastr.warning("Cannot delete the last collection.");const t=e.collections.find((e=>e.active));if(!t)return;if(!(yield qt.show.confirm("Delete Collection",`Are you sure you want to delete the collection "${t.name}"?`)))return;const n=e.collections.indexOf(t);e.collections.splice(n,1);const o=e.collections[0];o&&(o.active=!0),Mt(),Zt(e)}))}function Ht(){return Tt(this,void 0,void 0,(function*(){const e=Wt(),t=yield qt.show.input("New Collection Name","Enter the name of the new collection:");if(!t)return;e.collections.find((e=>e.name===t))?toastr.warning("Collection with this name already exists."):(e.collections.forEach((e=>{e.active=!1})),e.collections.push({active:!0,name:t,sliders:[],presets:[]}),Mt(),Zt(e))}))}function Gt(){const e=Wt(),t=Pt.preset_settings_openai;if(!t)return void toastr.warning("No Chat Completion preset selected.");const n=e.collections.find((e=>e.active));if(!n)return;const o=e.collections.find((e=>e.presets.includes(t)));o?(o.presets.splice(o.presets.indexOf(t),1),o!==n&&(toastr.warning(`The preset will be unbound from another collection "${o.name}".`),n.presets.push(t))):(n.presets.push(t),toastr.info(`Selecting the preset "${t}" will now automatically pick the sliders collection "${n.name}".`)),Mt(),Zt(e)}function Xt(){const e=Wt(),t=e.collections.find((e=>e.active));t&&(t.sliders.unshift({name:"New Slider",property:"",type:"Numeric",min:"0",max:"1",step:"0.01",value:0,enabled:!0,options:[]}),Zt(e))}function Zt(e){const t=Yt();t.list.innerHTML="";const n=e.collections.find((e=>e.active));if(!n)return;t.collections.innerHTML="",e.collections.forEach((e=>{const n=document.createElement("option");n.value=e.name,n.textContent=e.name,n.selected=e.active,t.collections.appendChild(n)}));const o=Pt.preset_settings_openai;if(t.bindToPreset.classList.toggle("toggleEnabled",n.presets.includes(o)),n.sliders.forEach(((n,o)=>{const i=document.createElement("template");i.innerHTML=jt;const r=i.content.querySelector('input[name="name"]'),s=i.content.querySelector('input[name="property"]'),l=i.content.querySelector('input[name="min"]'),a=i.content.querySelector('input[name="max"]'),c=i.content.querySelector('input[name="step"]'),u=i.content.querySelector('input[name="enabled"]'),f=i.content.querySelector('select[name="type"]'),d=i.content.querySelector('button[name="delete"]'),m=i.content.querySelector('button[name="up"]'),p=i.content.querySelector('button[name="down"]'),g=i.content.querySelector(".numeric-only"),h=i.content.querySelector(".boolean-only"),y=i.content.querySelector(".multiselect-only");r.value=n.name,s.value=n.property,l.value=n.min,a.value=n.max,c.value=n.step,u.checked=n.enabled,f.value=n.type||"Numeric";const v=[i.content.querySelector('input[name="option1"]'),i.content.querySelector('input[name="option2"]'),i.content.querySelector('input[name="option3"]'),i.content.querySelector('input[name="option4"]')];n.options||(n.options=["","","",""]),v.forEach(((t,o)=>{t&&(t.value=n.options[o]||"",t.addEventListener("input",(()=>{n.options[o]=t.value,en(e),Mt()})))}));const b=()=>{const e=f.value;g&&(g.style.display="Numeric"===e?"block":"none"),h&&(h.style.display="Boolean"===e?"block":"none"),y&&(y.style.display="MultiSelect"===e?"block":"none")};b(),f.addEventListener("change",(()=>{n.type=f.value,b(),Mt(),en(e)})),r.addEventListener("input",(t=>{n.name=r.value,en(e),Mt()})),s.addEventListener("input",(t=>{n.property=s.value,en(e),Mt()})),l.addEventListener("input",(t=>{n.min=l.value,en(e),Mt()})),a.addEventListener("input",(t=>{n.max=a.value,en(e),Mt()})),c.addEventListener("input",(t=>{n.step=c.value,en(e),Mt()})),u.addEventListener("change",(t=>{n.enabled=u.checked,en(e),Mt()})),d.addEventListener("click",(()=>Tt(this,void 0,void 0,(function*(){if(!(yield qt.show.confirm("Delete Slider",`Are you sure you want to delete the slider "${n.name}"?`)))return;const t=e.collections.find((e=>e.active));t&&(t.sliders.splice(o,1),Zt(e),Mt())})))),m.addEventListener("click",(()=>{if(o>0){const t=e.collections.find((e=>e.active));if(!t)return;const n=t.sliders[o-1];t.sliders[o-1]=t.sliders[o],t.sliders[o]=n,Zt(e),Mt()}})),p.addEventListener("click",(()=>{const t=e.collections.find((e=>e.active));if(t&&o<t.sliders.length-1){const n=t.sliders[o+1];t.sliders[o+1]=t.sliders[o],t.sliders[o]=n,Zt(e),Mt()}})),t.list.appendChild(i.content),t.list.appendChild(document.createElement("hr"))})),0===n.sliders.length){const e=document.createElement("div");e.classList.add("empty-message"),e.textContent='No custom sliders. Click "Create" to add one.',t.list.appendChild(e)}en(e)}function en(e){const t=Yt(),n="slider_macros_main_container";let o=document.getElementById(n);if(!o){o=document.createElement("div"),o.id=n,o.classList.add("slider_macros_container");const e=Array.from(t.rangeBlock.querySelectorAll(".range-block")).pop();e?e.insertAdjacentElement("afterend",o):t.rangeBlock.appendChild(o)}o.innerHTML="";const i=e.collections.find((e=>e.active));i&&(i.sliders.forEach((t=>{if(!t.enabled||!t.property||!t.name)return;const n=document.createElement("template");n.innerHTML=Bt;const i=CSS.escape("slider_macro_"+t.property),r=(n.content.querySelector(".range-block"),n.content.querySelector(".range-block-title"));if(document.getElementById(i))return toastr.warning("Duplicate slider property name: "+t.property),void console.warn("Duplicate slider detected:",i);if(r.textContent=t.name,console.log(`Rendering slider: ${t.name} (${t.type})`),"Numeric"!==t.type&&t.type){if("Boolean"===t.type){const o=n.content.querySelector(".range-block-range"),r=n.content.querySelector(".range-block-counter"),s=n.content.querySelector('input[type="range"]');o&&(o.style.display="",o.style.flex="1",o.style.width="100%");const l=document.createElement("span");l.style.marginLeft="10px",l.style.fontWeight="bold",r&&(r.style.display="",r.innerHTML="",r.appendChild(l)),s.id=i,s.min="0",s.max="1",s.step="1",s.value=(1-(t.value?1:0)).toString(),l.textContent=1==(t.value?1:0)?"True":"False";const a=()=>{const n=0===parseInt(s.value,10);t.value=n?1:0,l.textContent=n?"True":"False",Mt(),tn(e)};s.addEventListener("input",a),$(s).on("input",a)}else if("MultiSelect"===t.type){n.content.querySelector(".range-block-range");const o=n.content.querySelector(".range-block-counter"),s=n.content.querySelector('input[type="range"]'),l=n.content.querySelector('input[type="number"]'),a=(t.options||[]).filter((e=>""!==e.trim()));if(a.length<2)return void(r.textContent+=" (Config Error: < 2 Options)");const c=document.createElement("span");c.style.marginLeft="10px",c.style.fontWeight="bold",o&&l&&(o.innerHTML="",o.appendChild(c)),s.id=i,s.min="0",s.max=(a.length-1).toString(),s.step="1",(t.value<0||t.value>=a.length)&&(t.value=0);const u=e=>e.length>10?e.substring(0,10)+"...":e;s.value=t.value.toString(),c.textContent=u(a[t.value]),c.title=a[t.value];const f=()=>{const n=parseInt(s.value,10);t.value=n;const o=a[n]||"";c.textContent=u(o),c.title=o,Mt(),tn(e)};s.addEventListener("input",f),$(s).on("input",f)}}else{t.value<parseFloat(t.min)&&(t.value=parseFloat(t.min)),t.value>parseFloat(t.max)&&(t.value=parseFloat(t.max));const o=n.content.querySelector('input[type="range"]'),r=n.content.querySelector('input[type="number"]');o.id=i,o.min=t.min,o.max=t.max,o.step=t.step,o.value=t.value.toString(),r.id=i+"_number",r.min=t.min,r.max=t.max,r.step=t.step,r.value=t.value.toString(),r.dataset.for=i;const s=()=>{t.value=parseFloat(o.value),r.value=o.value,Mt(),tn(e)};o.addEventListener("input",s),$(o).on("input",s)}o.appendChild(n.content)})),tn(e))}function tn(e){const t=e.collections.find((e=>e.active));t&&t.sliders.forEach((e=>{if(!e.enabled||!e.property)return;let t;if("MultiSelect"===e.type){const n=(e.options||[]).filter((e=>""!==e.trim()));t=()=>n[e.value]||""}else t="Boolean"===e.type?()=>1===e.value?"true":"false":()=>e.value.toString();const n=`Slider Macro: ${e.name}`;Rt.experimental_macro_engine?Kt.register(e.property,{category:Kt.category.PROMPTS,description:n,handler:t}):Jt.registerMacro(e.property,t,n)}))}!function(){Tt(this,void 0,void 0,(function*(){const e=Wt();Qt(e),Zt(e),function(e){Dt.on(Ft.OAI_PRESET_CHANGED_AFTER,(()=>{const t=Pt.preset_settings_openai,n=e.collections.find((e=>e.active));if(!n)return;const o=e.collections.find((e=>e.presets.includes(t)));o&&o!==n&&(o.active=!0,n.active=!1,Mt(),Zt(e),en(e))}))}(e),Mt()}))}()})();