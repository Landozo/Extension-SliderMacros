(()=>{"use strict";var e={208:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(601),o=n.n(r),s=n(314),a=n.n(s)()(o());a.push([e.id,'/* ============================================\n   SLIDER MACROS - SETTINGS PANEL STYLES\n   ============================================ */\n\n/* --- Settings Drawer Background --- */\n#slider_macros_settings .inline-drawer-content {\n    background: var(--SmartThemeBlurTintColor, rgba(0,0,0,0.15));\n    padding: 12px;\n    border-radius: 0 0 8px 8px;\n}\n\n/* --- Toolbar --- */\n.slider_macros_toolbar {\n    margin-bottom: 12px;\n}\n\n.slider_macros_toolbar_row {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.slider_macros_toolbar_row > select {\n    flex: 1;\n    min-width: 0;\n}\n\n.slider_macros_toolbar_actions {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n}\n\n.slider_macros_toolbar_divider {\n    width: 1px;\n    height: 20px;\n    background: var(--SmartThemeBorderColor, #444);\n    margin: 0 4px;\n}\n\n/* --- Create Buttons --- */\n.slider_macros_create_row {\n    display: flex;\n    gap: 8px;\n    margin-bottom: 16px;\n}\n\n.slider_macros_btn_create {\n    flex: 1;\n    justify-content: center;\n    padding: 10px 16px;\n    border: 2px dashed var(--SmartThemeBorderColor, #555);\n    background: transparent;\n    transition: all 0.2s ease;\n}\n\n.slider_macros_btn_create_group {\n    border-color: var(--SmartThemeQuoteColor, #666);\n}\n\n.slider_macros_btn_create:hover {\n    border-color: var(--SmartThemeQuoteColor, #888);\n    background: rgba(255,255,255,0.05);\n}\n\n/* --- Slider List --- */\n.slider_macros_list {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n\n.slider_macros_list .empty-message {\n    text-align: center;\n    opacity: 0.6;\n    font-size: 0.9em;\n    padding: 24px 16px;\n    border: 1px dashed var(--SmartThemeBorderColor, #444);\n    border-radius: 8px;\n    background: rgba(0,0,0,0.2);\n}\n\n/* ============================================\n   COLLAPSIBLE SLIDER CARDS\n   ============================================ */\n\n.slider_macros_card {\n    background: var(--SmartThemeChatTintColor, rgba(20,20,30,0.95));\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 8px;\n    overflow: hidden;\n    transition: border-color 0.2s ease, box-shadow 0.2s ease;\n}\n\n.slider_macros_card:hover {\n    border-color: var(--SmartThemeQuoteColor, #666);\n}\n\n/* --- Card Header (Always Visible) --- */\n.slider_macros_card_header {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    padding: 10px 12px;\n    background: rgba(255,255,255,0.03);\n    cursor: pointer;\n    user-select: none;\n}\n\n.slider_macros_card_header:hover {\n    background: rgba(255,255,255,0.06);\n}\n\n/* Toggle Chevron */\n.slider_macros_card_toggle {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 20px;\n    flex-shrink: 0;\n}\n\n.slider_macros_card_chevron {\n    font-size: 0.85em;\n    color: var(--SmartThemeQuoteColor, #888);\n    transition: transform 0.2s ease;\n}\n\n.slider_macros_card[data-expanded="true"] .slider_macros_card_chevron {\n    transform: rotate(90deg);\n}\n\n/* Summary Info */\n.slider_macros_card_summary {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    flex: 1;\n    min-width: 0;\n    overflow: hidden;\n}\n\n.slider_macros_card_name {\n    font-weight: 600;\n    font-size: 0.95em;\n    color: var(--SmartThemeBodyColor, #eee);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.slider_macros_card_macro {\n    font-size: 0.8em;\n    color: var(--SmartThemeQuoteColor, #888);\n    font-family: monospace;\n    background: rgba(0,0,0,0.3);\n    padding: 2px 6px;\n    border-radius: 4px;\n    white-space: nowrap;\n}\n\n.slider_macros_card_macro:empty {\n    display: none;\n}\n\n.slider_macros_card_macro:not(:empty)::before {\n    content: \'{{\';\n}\n\n.slider_macros_card_macro:not(:empty)::after {\n    content: \'}}\';\n}\n\n.slider_macros_card_type_badge {\n    font-size: 0.7em;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    color: var(--SmartThemeQuoteColor, #777);\n    background: rgba(255,255,255,0.08);\n    padding: 3px 8px;\n    border-radius: 10px;\n    white-space: nowrap;\n}\n\n/* Group Badge on Slider Cards */\n.slider_macros_card_group_badge {\n    display: none;\n    align-items: center;\n    gap: 4px;\n    font-size: 0.7em;\n    color: var(--SmartThemeEmColor, #7b9fcf);\n    background: rgba(100, 150, 220, 0.15);\n    padding: 3px 8px;\n    border-radius: 10px;\n    white-space: nowrap;\n    border: 1px solid rgba(100, 150, 220, 0.3);\n}\n\n.slider_macros_card_group_badge[data-visible="true"] {\n    display: flex;\n}\n\n.slider_macros_card_group_badge i {\n    font-size: 0.9em;\n    opacity: 0.8;\n}\n\n.slider_macros_card_group_name {\n    max-width: 100px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n/* Header Controls */\n.slider_macros_card_controls {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    flex-shrink: 0;\n}\n\n.slider_macros_toggle {\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n    margin-right: 8px;\n}\n\n.slider_macros_btn_icon {\n    opacity: 0.5;\n    padding: 4px 6px;\n    min-width: unset;\n}\n\n.slider_macros_btn_icon:hover {\n    opacity: 1;\n}\n\n/* --- Card Body (Collapsible) --- */\n.slider_macros_card_body {\n    display: none;\n    padding: 12px;\n    border-top: 1px solid var(--SmartThemeBorderColor, #333);\n    background: rgba(0,0,0,0.15);\n}\n\n.slider_macros_card[data-expanded="true"] .slider_macros_card_body {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n/* --- Field Styles --- */\n.slider_macros_field_group {\n    display: flex;\n    gap: 10px;\n}\n\n.slider_macros_field_group > .slider_macros_field {\n    flex: 1;\n}\n\n.slider_macros_field {\n    display: flex;\n    flex-direction: column;\n    gap: 4px;\n}\n\n.slider_macros_field_row {\n    display: flex;\n    gap: 10px;\n}\n\n.slider_macros_field_compact {\n    flex: 1;\n    min-width: 0;\n}\n\n.slider_macros_field_half {\n    flex: 1;\n    min-width: 0;\n}\n\n.slider_macros_label {\n    font-size: 0.8em;\n    color: var(--SmartThemeQuoteColor, #aaa);\n    font-weight: 500;\n}\n\n.slider_macros_optional {\n    opacity: 0.6;\n    font-weight: 400;\n}\n\n/* Macro Variable Input with decorators */\n.slider_macros_macro_input_row {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.slider_macros_macro_input {\n    display: flex;\n    align-items: center;\n    gap: 0;\n    flex: 1;\n}\n\n.slider_macros_macro_input input {\n    flex: 1;\n    border-radius: 0;\n    text-align: center;\n    font-family: monospace;\n}\n\n.slider_macros_macro_prefix,\n.slider_macros_macro_suffix {\n    padding: 6px 8px;\n    background: rgba(0,0,0,0.4);\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    font-family: monospace;\n    font-size: 0.9em;\n    color: var(--SmartThemeQuoteColor, #888);\n}\n\n.slider_macros_macro_prefix {\n    border-right: none;\n    border-radius: 4px 0 0 4px;\n}\n\n.slider_macros_macro_suffix {\n    border-left: none;\n    border-radius: 0 4px 4px 0;\n}\n\n.slider_macros_btn_search_macro {\n    flex-shrink: 0;\n    padding: 6px 10px;\n}\n\n.slider_macros_macro_status {\n    margin-top: 4px;\n    font-size: 0.85em;\n    min-height: 1.2em;\n}\n\n.slider_macros_macro_status.exists {\n    color: var(--SmartThemeQuoteColor, #f90);\n}\n\n.slider_macros_macro_status.exists::before {\n    content: "⚠ ";\n}\n\n.slider_macros_macro_status.available {\n    color: var(--SmartThemeChatTintColor, #4a4);\n}\n\n.slider_macros_macro_status.available::before {\n    content: "✓ ";\n}\n\n/* Macro Search Popup */\n.slider_macros_search_container {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    min-width: 400px;\n    max-width: 600px;\n}\n\n.slider_macros_search_input_row {\n    display: flex;\n    gap: 8px;\n}\n\n.slider_macros_search_input_row input {\n    flex: 1;\n}\n\n.slider_macros_search_results {\n    max-height: 300px;\n    overflow-y: auto;\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 4px;\n    background: rgba(0,0,0,0.2);\n}\n\n.slider_macros_search_result {\n    padding: 10px 12px;\n    cursor: pointer;\n    border-bottom: 1px solid var(--SmartThemeBorderColor, #333);\n    transition: background 0.15s ease;\n}\n\n.slider_macros_search_result:last-child {\n    border-bottom: none;\n}\n\n.slider_macros_search_result:hover {\n    background: rgba(255,255,255,0.05);\n}\n\n.slider_macros_search_result_name {\n    font-family: monospace;\n    font-weight: 600;\n    color: var(--SmartThemeBodyColor, #fff);\n}\n\n.slider_macros_search_result_source {\n    font-size: 0.75em;\n    padding: 2px 6px;\n    border-radius: 3px;\n    margin-left: 8px;\n    background: rgba(100,100,255,0.3);\n    color: var(--SmartThemeQuoteColor, #aaa);\n}\n\n.slider_macros_search_result_source.legacy {\n    background: rgba(255,150,50,0.3);\n}\n\n.slider_macros_search_result_desc {\n    font-size: 0.85em;\n    color: var(--SmartThemeQuoteColor, #888);\n    margin-top: 4px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.slider_macros_search_result_value {\n    font-size: 0.8em;\n    color: var(--SmartThemeChatTintColor, #4a4);\n    margin-top: 2px;\n    font-family: monospace;\n}\n\n.slider_macros_search_empty {\n    padding: 20px;\n    text-align: center;\n    color: var(--SmartThemeQuoteColor, #888);\n}\n\n/* Type sections */\n.slider_macros_type_section {\n    padding-top: 10px;\n    border-top: 1px dashed var(--SmartThemeBorderColor, #333);\n    margin-top: 4px;\n}\n\n/* Delete Row */\n.slider_macros_card_delete_row {\n    padding-top: 12px;\n    margin-top: 8px;\n    border-top: 1px solid var(--SmartThemeBorderColor, #333);\n    display: flex;\n    justify-content: flex-end;\n}\n\n.slider_macros_btn_danger_full {\n    color: var(--SmartThemeQuoteColor, #888);\n    transition: color 0.2s ease, background 0.2s ease;\n}\n\n.slider_macros_btn_danger_full:hover {\n    color: #e74c3c;\n    background: rgba(231, 76, 60, 0.1);\n}\n\n/* --- Disabled State --- */\n.slider_macros_card[data-disabled="true"] {\n    opacity: 0.5;\n}\n\n.slider_macros_card[data-disabled="true"] .slider_macros_card_header {\n    background: rgba(0,0,0,0.1);\n}\n\n/* ============================================\n   COMPLETION PANEL SLIDER STYLES\n   ============================================ */\n\n.slider_macros_container .range-block {\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n    width: 100%;\n}\n\n.slider_macros_container .range-block-range-and-counter {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    width: 100%;\n}\n\n.slider_macros_container .range-block-range {\n    flex: 1;\n    width: 100%;\n    display: flex;\n    align-items: center;\n}\n\n.slider_macros_container .range-block-range input[type="range"] {\n    width: 100% !important;\n    margin: 0;\n    margin-right: 10px;\n    max-width: none;\n    flex-grow: 1;\n}\n\n.slider_macros_container .range-block-counter {\n    width: 60px;\n    min-width: 60px;\n    flex: 0 0 60px;\n    text-align: right;\n    display: flex;\n    justify-content: flex-end;\n}\n\n/* ============================================\n   DROPDOWN OPTIONS CONFIG (Settings Panel)\n   ============================================ */\n\n.slider_macros_dropdown_options {\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n    margin-bottom: 8px;\n}\n\n.slider_macros_dropdown_option_row {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.slider_macros_dropdown_key {\n    flex: 1;\n    min-width: 0;\n}\n\n.slider_macros_dropdown_arrow {\n    color: var(--SmartThemeQuoteColor, #888);\n    font-size: 0.9em;\n    flex-shrink: 0;\n}\n\n.slider_macros_dropdown_value {\n    flex: 1.5;\n    min-width: 0;\n    font-family: monospace;\n}\n\n.slider_macros_btn_remove_option {\n    opacity: 0.5;\n    padding: 4px 8px;\n    min-width: unset;\n}\n\n.slider_macros_btn_remove_option:hover {\n    opacity: 1;\n    color: #e74c3c;\n}\n\n.slider_macros_btn_add_option {\n    width: 100%;\n    justify-content: center;\n    padding: 6px 12px;\n    border: 1px dashed var(--SmartThemeBorderColor, #555);\n    background: transparent;\n    opacity: 0.7;\n}\n\n.slider_macros_btn_add_option:hover {\n    opacity: 1;\n    border-color: var(--SmartThemeQuoteColor, #888);\n}\n\n/* ============================================\n   COLOR INPUT CONFIG (Settings Panel)\n   ============================================ */\n\n.slider_macros_color_default {\n    width: 60px;\n    height: 32px;\n    padding: 2px;\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 4px;\n    cursor: pointer;\n}\n\n/* ============================================\n   COMPLETION PANEL - DROPDOWN SELECT\n   ============================================ */\n\n.slider_macros_dropdown_select {\n    width: 100%;\n    flex: 1;\n}\n\n/* ============================================\n   COMPLETION PANEL - COLOR PICKER\n   ============================================ */\n\n.slider_macros_color_input {\n    width: 48px;\n    height: 32px;\n    padding: 2px;\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 4px;\n    cursor: pointer;\n    flex-shrink: 0;\n}\n\n.slider_macros_color_hex {\n    width: 80px;\n    text-align: center;\n    font-family: monospace;\n    text-transform: uppercase;\n}\n\n/* ============================================\n   COMPLETION PANEL - CHECKBOX\n   ============================================ */\n\n.slider_macros_checkbox_label {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    cursor: pointer;\n}\n\n.slider_macros_checkbox_label input[type="checkbox"] {\n    width: 18px;\n    height: 18px;\n    cursor: pointer;\n}\n\n.slider_macros_checkbox_text {\n    font-weight: 500;\n    color: var(--SmartThemeBodyColor, #eee);\n}\n\n/* ============================================\n   SETTINGS PANEL - GROUP CARDS\n   ============================================ */\n\n.slider_macros_group_card {\n    background: var(--SmartThemeChatTintColor, rgba(20,20,30,0.95));\n    border: 2px solid var(--SmartThemeQuoteColor, #666);\n    border-radius: 8px;\n    overflow: hidden;\n    transition: border-color 0.2s ease, box-shadow 0.2s ease;\n}\n\n.slider_macros_group_card:hover {\n    border-color: var(--SmartThemeBodyColor, #888);\n}\n\n.slider_macros_group_card_header {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    padding: 12px 14px;\n    background: rgba(255,255,255,0.05);\n    cursor: pointer;\n    user-select: none;\n}\n\n.slider_macros_group_card_header:hover {\n    background: rgba(255,255,255,0.08);\n}\n\n.slider_macros_group_card_summary {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    flex: 1;\n    min-width: 0;\n    overflow: hidden;\n}\n\n.slider_macros_group_icon {\n    color: var(--SmartThemeQuoteColor, #888);\n    font-size: 1em;\n}\n\n.slider_macros_group_card_name {\n    font-weight: 600;\n    font-size: 1em;\n    color: var(--SmartThemeBodyColor, #eee);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.slider_macros_group_card_count {\n    font-size: 0.85em;\n    color: var(--SmartThemeQuoteColor, #888);\n    white-space: nowrap;\n}\n\n.slider_macros_group_card[data-expanded="true"] .slider_macros_card_chevron {\n    transform: rotate(90deg);\n}\n\n.slider_macros_group_card_body {\n    display: none;\n    padding: 12px;\n    border-top: 1px solid var(--SmartThemeBorderColor, #333);\n    background: rgba(0,0,0,0.15);\n}\n\n.slider_macros_group_card[data-expanded="true"] .slider_macros_group_card_body {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.slider_macros_group_sliders {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    margin-top: 8px;\n}\n\n/* ============================================\n   COMPLETION PANEL - COLLAPSIBLE GROUPS\n   ============================================ */\n\n.slider_macros_group {\n    border: 1px solid var(--SmartThemeBorderColor, #444);\n    border-radius: 8px;\n    margin-bottom: 8px;\n    overflow: hidden;\n    background: rgba(0,0,0,0.1);\n}\n\n.slider_macros_group_header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px 12px;\n    background: rgba(255,255,255,0.03);\n    cursor: pointer;\n    user-select: none;\n    transition: background 0.2s ease;\n}\n\n.slider_macros_group_header:hover {\n    background: rgba(255,255,255,0.06);\n}\n\n.slider_macros_group_chevron {\n    font-size: 0.85em;\n    color: var(--SmartThemeQuoteColor, #888);\n    transition: transform 0.2s ease;\n}\n\n.slider_macros_group[data-collapsed="true"] .slider_macros_group_chevron {\n    transform: rotate(-90deg);\n}\n\n.slider_macros_group_name {\n    font-weight: 600;\n    font-size: 0.95em;\n    color: var(--SmartThemeBodyColor, #eee);\n    flex: 1;\n}\n\n.slider_macros_group_count {\n    font-size: 0.8em;\n    color: var(--SmartThemeQuoteColor, #888);\n}\n\n.slider_macros_group_content {\n    padding: 8px;\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    border-top: 1px solid var(--SmartThemeBorderColor, #333);\n}\n\n.slider_macros_group[data-collapsed="true"] .slider_macros_group_content {\n    display: none;\n}\n',""]);const i=a},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);r&&a[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),t.push(d))}},t}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var s={},a=[],i=0;i<e.length;i++){var l=e[i],c=r.base?l[0]+r.base:l[0],d=s[c]||0,u="".concat(c," ").concat(d);s[c]=d+1;var p=n(u),m={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(m);else{var f=o(m,r);r.byIndex=i,t.splice(i,0,{identifier:u,updater:f,references:1})}a.push(u)}return a}function o(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var s=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<s.length;a++){var i=n(s[a]);t[i].references--}for(var l=r(e,o),c=0;c<s.length;c++){var d=n(s[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=l}}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={id:r,exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;const r=Symbol.for("yaml.alias"),o=Symbol.for("yaml.document"),s=Symbol.for("yaml.map"),a=Symbol.for("yaml.pair"),i=Symbol.for("yaml.scalar"),l=Symbol.for("yaml.seq"),c=Symbol.for("yaml.node.type"),d=e=>!!e&&"object"==typeof e&&e[c]===r,u=e=>!!e&&"object"==typeof e&&e[c]===o,p=e=>!!e&&"object"==typeof e&&e[c]===s,m=e=>!!e&&"object"==typeof e&&e[c]===a,f=e=>!!e&&"object"==typeof e&&e[c]===i,_=e=>!!e&&"object"==typeof e&&e[c]===l;function g(e){if(e&&"object"==typeof e)switch(e[c]){case s:case l:return!0}return!1}function h(e){if(e&&"object"==typeof e)switch(e[c]){case r:case s:case i:case l:return!0}return!1}const y=e=>(f(e)||g(e))&&!!e.anchor,v=Symbol("break visit"),b=Symbol("skip children"),x=Symbol("remove node");function w(e,t){const n=k(t);if(u(e)){S(null,e.contents,n,Object.freeze([e]))===x&&(e.contents=null)}else S(null,e,n,Object.freeze([]))}function S(e,t,n,r){const o=N(e,t,n,r);if(h(o)||m(o))return O(e,r,o),S(e,o,n,r);if("symbol"!=typeof o)if(g(t)){r=Object.freeze(r.concat(t));for(let e=0;e<t.items.length;++e){const o=S(e,t.items[e],n,r);if("number"==typeof o)e=o-1;else{if(o===v)return v;o===x&&(t.items.splice(e,1),e-=1)}}}else if(m(t)){r=Object.freeze(r.concat(t));const e=S("key",t.key,n,r);if(e===v)return v;e===x&&(t.key=null);const o=S("value",t.value,n,r);if(o===v)return v;o===x&&(t.value=null)}return o}async function C(e,t){const n=k(t);if(u(e)){await E(null,e.contents,n,Object.freeze([e]))===x&&(e.contents=null)}else await E(null,e,n,Object.freeze([]))}async function E(e,t,n,r){const o=await N(e,t,n,r);if(h(o)||m(o))return O(e,r,o),E(e,o,n,r);if("symbol"!=typeof o)if(g(t)){r=Object.freeze(r.concat(t));for(let e=0;e<t.items.length;++e){const o=await E(e,t.items[e],n,r);if("number"==typeof o)e=o-1;else{if(o===v)return v;o===x&&(t.items.splice(e,1),e-=1)}}}else if(m(t)){r=Object.freeze(r.concat(t));const e=await E("key",t.key,n,r);if(e===v)return v;e===x&&(t.key=null);const o=await E("value",t.value,n,r);if(o===v)return v;o===x&&(t.value=null)}return o}function k(e){return"object"==typeof e&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function N(e,t,n,r){return"function"==typeof n?n(e,t,r):p(t)?n.Map?.(e,t,r):_(t)?n.Seq?.(e,t,r):m(t)?n.Pair?.(e,t,r):f(t)?n.Scalar?.(e,t,r):d(t)?n.Alias?.(e,t,r):void 0}function O(e,t,n){const r=t[t.length-1];if(g(r))r.items[e]=n;else if(m(r))"key"===e?r.key=n:r.value=n;else{if(!u(r)){const e=d(r)?"alias":"scalar";throw new Error(`Cannot replace node with ${e} parent`)}r.contents=n}}w.BREAK=v,w.SKIP=b,w.REMOVE=x,C.BREAK=v,C.SKIP=b,C.REMOVE=x;const T={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"};class I{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},I.defaultYaml,e),this.tags=Object.assign({},I.defaultTags,t)}clone(){const e=new I(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new I(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:I.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},I.defaultTags)}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:I.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},I.defaultTags),this.atNextDocument=!1);const n=e.trim().split(/[ \t]+/),r=n.shift();switch(r){case"%TAG":{if(2!==n.length&&(t(0,"%TAG directive should contain exactly two parts"),n.length<2))return!1;const[e,r]=n;return this.tags[e]=r,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==n.length)return t(0,"%YAML directive should contain exactly one part"),!1;const[e]=n;if("1.1"===e||"1.2"===e)return this.yaml.version=e,!0;return t(6,`Unsupported YAML version ${e}`,/^\d+\.\d+$/.test(e)),!1}default:return t(0,`Unknown directive ${r}`,!0),!1}}tagName(e,t){if("!"===e)return"!";if("!"!==e[0])return t(`Not a valid tag: ${e}`),null;if("<"===e[1]){const n=e.slice(2,-1);return"!"===n||"!!"===n?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(">"!==e[e.length-1]&&t("Verbatim tags must end with a >"),n)}const[,n,r]=e.match(/^(.*!)([^!]*)$/s);r||t(`The ${e} tag has no suffix`);const o=this.tags[n];if(o)try{return o+decodeURIComponent(r)}catch(e){return t(String(e)),null}return"!"===n?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[t,n]of Object.entries(this.tags))if(e.startsWith(n))return t+e.substring(n.length).replace(/[!,[\]{}]/g,(e=>T[e]));return"!"===e[0]?e:`!<${e}>`}toString(e){const t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],n=Object.entries(this.tags);let r;if(e&&n.length>0&&h(e.contents)){const t={};w(e.contents,((e,n)=>{h(n)&&n.tag&&(t[n.tag]=!0)})),r=Object.keys(t)}else r=[];for(const[o,s]of n)"!!"===o&&"tag:yaml.org,2002:"===s||e&&!r.some((e=>e.startsWith(s)))||t.push(`%TAG ${o} ${s}`);return t.join("\n")}}function L(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const t=JSON.stringify(e);throw new Error(`Anchor must not contain whitespace or control characters: ${t}`)}return!0}function A(e,t,n,r){if(r&&"object"==typeof r)if(Array.isArray(r))for(let t=0,n=r.length;t<n;++t){const n=r[t],o=A(e,r,String(t),n);void 0===o?delete r[t]:o!==n&&(r[t]=o)}else if(r instanceof Map)for(const t of Array.from(r.keys())){const n=r.get(t),o=A(e,r,t,n);void 0===o?r.delete(t):o!==n&&r.set(t,o)}else if(r instanceof Set)for(const t of Array.from(r)){const n=A(e,r,t,t);void 0===n?r.delete(t):n!==t&&(r.delete(t),r.add(n))}else for(const[t,n]of Object.entries(r)){const o=A(e,r,t,n);void 0===o?delete r[t]:o!==n&&(r[t]=o)}return e.call(t,n,r)}function B(e,t,n){if(Array.isArray(e))return e.map(((e,t)=>B(e,String(t),n)));if(e&&"function"==typeof e.toJSON){if(!n||!y(e))return e.toJSON(t,n);const r={aliasCount:0,count:1,res:void 0};n.anchors.set(e,r),n.onCreate=e=>{r.res=e,delete n.onCreate};const o=e.toJSON(t,n);return n.onCreate&&n.onCreate(o),o}return"bigint"!=typeof e||n?.keep?e:Number(e)}I.defaultYaml={explicit:!1,version:"1.2"},I.defaultTags={"!!":"tag:yaml.org,2002:"};class M{constructor(e){Object.defineProperty(this,c,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:n,onAnchor:r,reviver:o}={}){if(!u(e))throw new TypeError("A document argument is required");const s={anchors:new Map,doc:e,keep:!0,mapAsMap:!0===t,mapKeyWarned:!1,maxAliasCount:"number"==typeof n?n:100},a=B(this,"",s);if("function"==typeof r)for(const{count:e,res:t}of s.anchors.values())r(t,e);return"function"==typeof o?A(o,{"":a},"",a):a}}class j extends M{constructor(e){super(r),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let t;return w(e,{Node:(e,n)=>{if(n===this)return w.BREAK;n.anchor===this.source&&(t=n)}}),t}toJSON(e,t){if(!t)return{source:this.source};const{anchors:n,doc:r,maxAliasCount:o}=t,s=this.resolve(r);if(!s){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(e)}let a=n.get(s);if(a||(B(s,null,t),a=n.get(s)),!a||void 0===a.res){throw new ReferenceError("This should not happen: Alias anchor was not resolved?")}if(o>=0&&(a.count+=1,0===a.aliasCount&&(a.aliasCount=F(r,s,n)),a.count*a.aliasCount>o)){throw new ReferenceError("Excessive alias count indicates a resource exhaustion attack")}return a.res}toString(e,t,n){const r=`*${this.source}`;if(e){if(L(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(e)}if(e.implicitKey)return`${r} `}return r}}function F(e,t,n){if(d(t)){const r=t.resolve(e),o=n&&r&&n.get(r);return o?o.count*o.aliasCount:0}if(g(t)){let r=0;for(const o of t.items){const t=F(e,o,n);t>r&&(r=t)}return r}if(m(t)){const r=F(e,t.key,n),o=F(e,t.value,n);return Math.max(r,o)}return 1}const q=e=>!e||"function"!=typeof e&&"object"!=typeof e;class D extends M{constructor(e){super(i),this.value=e}toJSON(e,t){return t?.keep?this.value:B(this.value,e,t)}toString(){return String(this.value)}}D.BLOCK_FOLDED="BLOCK_FOLDED",D.BLOCK_LITERAL="BLOCK_LITERAL",D.PLAIN="PLAIN",D.QUOTE_DOUBLE="QUOTE_DOUBLE",D.QUOTE_SINGLE="QUOTE_SINGLE";const P="tag:yaml.org,2002:";function R(e,t,n){if(u(e)&&(e=e.contents),h(e))return e;if(m(e)){const t=n.schema[s].createNode?.(n.schema,null,n);return t.items.push(e),t}(e instanceof String||e instanceof Number||e instanceof Boolean||"undefined"!=typeof BigInt&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:r,onAnchor:o,onTagObj:a,schema:i,sourceObjects:c}=n;let d;if(r&&e&&"object"==typeof e){if(d=c.get(e),d)return d.anchor||(d.anchor=o(e)),new j(d.anchor);d={anchor:null,node:null},c.set(e,d)}t?.startsWith("!!")&&(t=P+t.slice(2));let p=function(e,t,n){if(t){const e=n.filter((e=>e.tag===t)),r=e.find((e=>!e.format))??e[0];if(!r)throw new Error(`Tag ${t} not found`);return r}return n.find((t=>t.identify?.(e)&&!t.format))}(e,t,i.tags);if(!p){if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),!e||"object"!=typeof e){const t=new D(e);return d&&(d.node=t),t}p=e instanceof Map?i[s]:Symbol.iterator in Object(e)?i[l]:i[s]}a&&(a(p),delete n.onTagObj);const f=p?.createNode?p.createNode(n.schema,e,n):"function"==typeof p?.nodeClass?.from?p.nodeClass.from(n.schema,e,n):new D(e);return t?f.tag=t:p.default||(f.tag=p.tag),d&&(d.node=f),f}function V(e,t,n){let r=n;for(let e=t.length-1;e>=0;--e){const n=t[e];if("number"==typeof n&&Number.isInteger(n)&&n>=0){const e=[];e[n]=r,r=e}else r=new Map([[n,r]])}return R(r,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}class U extends M{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map((t=>h(t)||m(t)?t.clone(e):t)),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if((e=>null==e||"object"==typeof e&&!!e[Symbol.iterator]().next().done)(e))this.add(t);else{const[n,...r]=e,o=this.get(n,!0);if(g(o))o.addIn(r,t);else{if(void 0!==o||!this.schema)throw new Error(`Expected YAML collection at ${n}. Remaining path: ${r}`);this.set(n,V(this.schema,r,t))}}}deleteIn(e){const[t,...n]=e;if(0===n.length)return this.delete(t);const r=this.get(t,!0);if(g(r))return r.deleteIn(n);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${n}`)}getIn(e,t){const[n,...r]=e,o=this.get(n,!0);return 0===r.length?!t&&f(o)?o.value:o:g(o)?o.getIn(r,t):void 0}hasAllNullValues(e){return this.items.every((t=>{if(!m(t))return!1;const n=t.value;return null==n||e&&f(n)&&null==n.value&&!n.commentBefore&&!n.comment&&!n.tag}))}hasIn(e){const[t,...n]=e;if(0===n.length)return this.has(t);const r=this.get(t,!0);return!!g(r)&&r.hasIn(n)}setIn(e,t){const[n,...r]=e;if(0===r.length)this.set(n,t);else{const e=this.get(n,!0);if(g(e))e.setIn(r,t);else{if(void 0!==e||!this.schema)throw new Error(`Expected YAML collection at ${n}. Remaining path: ${r}`);this.set(n,V(this.schema,r,t))}}}}const G=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function K(e,t){return/^\n+$/.test(e)?e.substring(1):t?e.replace(/^(?! *$)/gm,t):e}const J=(e,t,n)=>e.endsWith("\n")?K(n,t):n.includes("\n")?"\n"+K(n,t):(e.endsWith(" ")?"":" ")+n,Q="flow",z="block",W="quoted";function H(e,t,n="flow",{indentAtStart:r,lineWidth:o=80,minContentWidth:s=20,onFold:a,onOverflow:i}={}){if(!o||o<0)return e;o<s&&(s=0);const l=Math.max(1+s,1+o-t.length);if(e.length<=l)return e;const c=[],d={};let u,p,m=o-t.length;"number"==typeof r&&(r>o-Math.max(2,s)?c.push(0):m=o-r);let f=!1,_=-1,g=-1,h=-1;n===z&&(_=Y(e,_,t.length),-1!==_&&(m=_+l));for(let r;r=e[_+=1];){if(n===W&&"\\"===r){switch(g=_,e[_+1]){case"x":_+=3;break;case"u":_+=5;break;case"U":_+=9;break;default:_+=1}h=_}if("\n"===r)n===z&&(_=Y(e,_,t.length)),m=_+t.length+l,u=void 0;else{if(" "===r&&p&&" "!==p&&"\n"!==p&&"\t"!==p){const t=e[_+1];t&&" "!==t&&"\n"!==t&&"\t"!==t&&(u=_)}if(_>=m)if(u)c.push(u),m=u+l,u=void 0;else if(n===W){for(;" "===p||"\t"===p;)p=r,r=e[_+=1],f=!0;const t=_>h+1?_-2:g-1;if(d[t])return e;c.push(t),d[t]=!0,m=t+l,u=void 0}else f=!0}p=r}if(f&&i&&i(),0===c.length)return e;a&&a();let y=e.slice(0,c[0]);for(let r=0;r<c.length;++r){const o=c[r],s=c[r+1]||e.length;0===o?y=`\n${t}${e.slice(0,s)}`:(n===W&&d[o]&&(y+=`${e[o]}\\`),y+=`\n${t}${e.slice(o+1,s)}`)}return y}function Y(e,t,n){let r=t,o=t+1,s=e[o];for(;" "===s||"\t"===s;)if(t<o+n)s=e[++t];else{do{s=e[++t]}while(s&&"\n"!==s);r=t,o=t+1,s=e[o]}return r}const X=(e,t)=>({indentAtStart:t?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),Z=e=>/^(%|---|\.\.\.)/m.test(e);function ee(e,t){const n=JSON.stringify(e);if(t.options.doubleQuotedAsJSON)return n;const{implicitKey:r}=t,o=t.options.doubleQuotedMinMultiLineLength,s=t.indent||(Z(e)?"  ":"");let a="",i=0;for(let e=0,t=n[e];t;t=n[++e])if(" "===t&&"\\"===n[e+1]&&"n"===n[e+2]&&(a+=n.slice(i,e)+"\\ ",e+=1,i=e,t="\\"),"\\"===t)switch(n[e+1]){case"u":{a+=n.slice(i,e);const t=n.substr(e+2,4);switch(t){case"0000":a+="\\0";break;case"0007":a+="\\a";break;case"000b":a+="\\v";break;case"001b":a+="\\e";break;case"0085":a+="\\N";break;case"00a0":a+="\\_";break;case"2028":a+="\\L";break;case"2029":a+="\\P";break;default:"00"===t.substr(0,2)?a+="\\x"+t.substr(2):a+=n.substr(e,6)}e+=5,i=e+1}break;case"n":if(r||'"'===n[e+2]||n.length<o)e+=1;else{for(a+=n.slice(i,e)+"\n\n";"\\"===n[e+2]&&"n"===n[e+3]&&'"'!==n[e+4];)a+="\n",e+=2;a+=s," "===n[e+2]&&(a+="\\"),e+=1,i=e+1}break;default:e+=1}return a=i?a+n.slice(i):n,r?a:H(a,s,W,X(t,!1))}function te(e,t){if(!1===t.options.singleQuote||t.implicitKey&&e.includes("\n")||/[ \t]\n|\n[ \t]/.test(e))return ee(e,t);const n=t.indent||(Z(e)?"  ":""),r="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&\n${n}`)+"'";return t.implicitKey?r:H(r,n,Q,X(t,!1))}function ne(e,t){const{singleQuote:n}=t.options;let r;if(!1===n)r=ee;else{const t=e.includes('"'),o=e.includes("'");r=t&&!o?te:o&&!t?ee:n?te:ee}return r(e,t)}let re;try{re=new RegExp("(^|(?<!\n))\n+(?!\n|$)","g")}catch{re=/\n+(?!\n|$)/g}function oe({comment:e,type:t,value:n},r,o,s){const{blockQuote:a,commentString:i,lineWidth:l}=r.options;if(!a||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return ne(n,r);const c=r.indent||(r.forceBlockIndent||Z(n)?"  ":""),d="literal"===a||"folded"!==a&&t!==D.BLOCK_FOLDED&&(t===D.BLOCK_LITERAL||!function(e,t,n){if(!t||t<0)return!1;const r=t-n,o=e.length;if(o<=r)return!1;for(let t=0,n=0;t<o;++t)if("\n"===e[t]){if(t-n>r)return!0;if(n=t+1,o-n<=r)return!1}return!0}(n,l,c.length));if(!n)return d?"|\n":">\n";let u,p;for(p=n.length;p>0;--p){const e=n[p-1];if("\n"!==e&&"\t"!==e&&" "!==e)break}let m=n.substring(p);const f=m.indexOf("\n");-1===f?u="-":n===m||f!==m.length-1?(u="+",s&&s()):u="",m&&(n=n.slice(0,-m.length),"\n"===m[m.length-1]&&(m=m.slice(0,-1)),m=m.replace(re,`$&${c}`));let _,g=!1,h=-1;for(_=0;_<n.length;++_){const e=n[_];if(" "===e)g=!0;else{if("\n"!==e)break;h=_}}let y=n.substring(0,h<_?h+1:_);y&&(n=n.substring(y.length),y=y.replace(/\n+/g,`$&${c}`));let v=(g?c?"2":"1":"")+u;if(e&&(v+=" "+i(e.replace(/ ?[\r\n]+/g," ")),o&&o()),!d){const e=n.replace(/\n+/g,"\n$&").replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`);let o=!1;const s=X(r,!0);"folded"!==a&&t!==D.BLOCK_FOLDED&&(s.onOverflow=()=>{o=!0});const i=H(`${y}${e}${m}`,c,z,s);if(!o)return`>${v}\n${c}${i}`}return`|${v}\n${c}${y}${n=n.replace(/\n+/g,`$&${c}`)}${m}`}function se(e,t,n,r){const{implicitKey:o,inFlow:s}=t,a="string"==typeof e.value?e:Object.assign({},e,{value:String(e.value)});let{type:i}=e;i!==D.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(a.value)&&(i=D.QUOTE_DOUBLE);const l=e=>{switch(e){case D.BLOCK_FOLDED:case D.BLOCK_LITERAL:return o||s?ne(a.value,t):oe(a,t,n,r);case D.QUOTE_DOUBLE:return ee(a.value,t);case D.QUOTE_SINGLE:return te(a.value,t);case D.PLAIN:return function(e,t,n,r){const{type:o,value:s}=e,{actualString:a,implicitKey:i,indent:l,indentStep:c,inFlow:d}=t;if(i&&s.includes("\n")||d&&/[[\]{},]/.test(s))return ne(s,t);if(!s||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(s))return i||d||!s.includes("\n")?ne(s,t):oe(e,t,n,r);if(!i&&!d&&o!==D.PLAIN&&s.includes("\n"))return oe(e,t,n,r);if(Z(s)){if(""===l)return t.forceBlockIndent=!0,oe(e,t,n,r);if(i&&l===c)return ne(s,t)}const u=s.replace(/\n+/g,`$&\n${l}`);if(a){const e=e=>e.default&&"tag:yaml.org,2002:str"!==e.tag&&e.test?.test(u),{compat:n,tags:r}=t.doc.schema;if(r.some(e)||n?.some(e))return ne(s,t)}return i?u:H(u,l,Q,X(t,!1))}(a,t,n,r);default:return null}};let c=l(i);if(null===c){const{defaultKeyType:e,defaultStringType:n}=t.options,r=o&&e||n;if(c=l(r),null===c)throw new Error(`Unsupported default string type ${r}`)}return c}function ae(e,t,n,r){if(m(e))return e.toString(t,n,r);if(d(e)){if(t.doc.directives)return e.toString(t);if(t.resolvedAliases?.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(e):t.resolvedAliases=new Set([e]),e=e.resolve(t.doc)}let o;const s=h(e)?e:t.doc.createNode(e,{onTagObj:e=>o=e});o||(o=function(e,t){if(t.tag){const n=e.filter((e=>e.tag===t.tag));if(n.length>0)return n.find((e=>e.format===t.format))??n[0]}let n,r;if(f(t)){r=t.value;let o=e.filter((e=>e.identify?.(r)));if(o.length>1){const e=o.filter((e=>e.test));e.length>0&&(o=e)}n=o.find((e=>e.format===t.format))??o.find((e=>!e.format))}else r=t,n=e.find((e=>e.nodeClass&&r instanceof e.nodeClass));if(!n)throw new Error(`Tag not resolved for ${r?.constructor?.name??typeof r} value`);return n}(t.doc.schema.tags,s));const a=function(e,t,{anchors:n,doc:r}){if(!r.directives)return"";const o=[],s=(f(e)||g(e))&&e.anchor;s&&L(s)&&(n.add(s),o.push(`&${s}`));const a=e.tag?e.tag:t.default?null:t.tag;return a&&o.push(r.directives.tagString(a)),o.join(" ")}(s,o,t);a.length>0&&(t.indentAtStart=(t.indentAtStart??0)+a.length+1);const i="function"==typeof o.stringify?o.stringify(s,t,n,r):f(s)?se(s,t,n,r):s.toString(t,n,r);return a?f(s)||"{"===i[0]||"["===i[0]?`${a} ${i}`:`${a}\n${t.indent}${i}`:i}const ie="<<",le={identify:e=>e===ie||"symbol"==typeof e&&e.description===ie,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new D(Symbol(ie)),{addToJSMap:ce}),stringify:()=>ie};function ce(e,t,n){if(n=e&&d(n)?n.resolve(e.doc):n,_(n))for(const r of n.items)de(e,t,r);else if(Array.isArray(n))for(const r of n)de(e,t,r);else de(e,t,n)}function de(e,t,n){const r=e&&d(n)?n.resolve(e.doc):n;if(!p(r))throw new Error("Merge sources must be maps or map aliases");const o=r.toJSON(null,e,Map);for(const[e,n]of o)t instanceof Map?t.has(e)||t.set(e,n):t instanceof Set?t.add(e):Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0});return t}function ue(e,t,{key:n,value:r}){if(h(n)&&n.addToJSMap)n.addToJSMap(e,t,r);else if(((e,t)=>(le.identify(t)||f(t)&&(!t.type||t.type===D.PLAIN)&&le.identify(t.value))&&e?.doc.schema.tags.some((e=>e.tag===le.tag&&e.default)))(e,n))ce(e,t,r);else{const o=B(n,"",e);if(t instanceof Map)t.set(o,B(r,o,e));else if(t instanceof Set)t.add(o);else{const s=function(e,t,n){if(null===t)return"";if("object"!=typeof t)return String(t);if(h(e)&&n?.doc){const t=function(e,t){const n=Object.assign({blockQuote:!0,commentString:G,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,t);let r;switch(n.collectionStyle){case"block":r=!1;break;case"flow":r=!0;break;default:r=null}return{anchors:new Set,doc:e,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:"number"==typeof n.indent?" ".repeat(n.indent):"  ",inFlow:r,options:n}}(n.doc,{});t.anchors=new Set;for(const e of n.anchors.keys())t.anchors.add(e.anchor);t.inFlow=!0,t.inStringifyKey=!0;const s=e.toString(t);if(!n.mapKeyWarned){let e=JSON.stringify(s);e.length>40&&(e=e.substring(0,36)+'..."'),r=n.doc.options.logLevel,o=`Keys with collection values will be stringified due to JS Object restrictions: ${e}. Set mapAsMap: true to use object keys.`,"debug"!==r&&"warn"!==r||console.warn(o),n.mapKeyWarned=!0}return s}var r,o;return JSON.stringify(t)}(n,o,e),a=B(r,s,e);s in t?Object.defineProperty(t,s,{value:a,writable:!0,enumerable:!0,configurable:!0}):t[s]=a}}return t}function pe(e,t,n){const r=R(e,void 0,n),o=R(t,void 0,n);return new me(r,o)}class me{constructor(e,t=null){Object.defineProperty(this,c,{value:a}),this.key=e,this.value=t}clone(e){let{key:t,value:n}=this;return h(t)&&(t=t.clone(e)),h(n)&&(n=n.clone(e)),new me(t,n)}toJSON(e,t){return ue(t,t?.mapAsMap?new Map:{},this)}toString(e,t,n){return e?.doc?function({key:e,value:t},n,r,o){const{allNullValues:s,doc:a,indent:i,indentStep:l,options:{commentString:c,indentSeq:d,simpleKeys:u}}=n;let p=h(e)&&e.comment||null;if(u){if(p)throw new Error("With simple keys, key nodes cannot have comments");if(g(e)||!h(e)&&"object"==typeof e)throw new Error("With simple keys, collection cannot be used as a key value")}let m=!u&&(!e||p&&null==t&&!n.inFlow||g(e)||(f(e)?e.type===D.BLOCK_FOLDED||e.type===D.BLOCK_LITERAL:"object"==typeof e));n=Object.assign({},n,{allNullValues:!1,implicitKey:!m&&(u||!s),indent:i+l});let y,v,b,x=!1,w=!1,S=ae(e,n,(()=>x=!0),(()=>w=!0));if(!m&&!n.inFlow&&S.length>1024){if(u)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");m=!0}if(n.inFlow){if(s||null==t)return x&&r&&r(),""===S?"?":m?`? ${S}`:S}else if(s&&!u||null==t&&m)return S=`? ${S}`,p&&!x?S+=J(S,n.indent,c(p)):w&&o&&o(),S;x&&(p=null),m?(p&&(S+=J(S,n.indent,c(p))),S=`? ${S}\n${i}:`):(S=`${S}:`,p&&(S+=J(S,n.indent,c(p)))),h(t)?(y=!!t.spaceBefore,v=t.commentBefore,b=t.comment):(y=!1,v=null,b=null,t&&"object"==typeof t&&(t=a.createNode(t))),n.implicitKey=!1,m||p||!f(t)||(n.indentAtStart=S.length+1),w=!1,d||!(l.length>=2)||n.inFlow||m||!_(t)||t.flow||t.tag||t.anchor||(n.indent=n.indent.substring(2));let C=!1;const E=ae(t,n,(()=>C=!0),(()=>w=!0));let k=" ";if(p||y||v)k=y?"\n":"",v&&(k+=`\n${K(c(v),n.indent)}`),""!==E||n.inFlow?k+=`\n${n.indent}`:"\n"===k&&(k="\n\n");else if(!m&&g(t)){const e=E[0],r=E.indexOf("\n"),o=-1!==r,s=n.inFlow??t.flow??0===t.items.length;if(o||!s){let t=!1;if(o&&("&"===e||"!"===e)){let n=E.indexOf(" ");"&"===e&&-1!==n&&n<r&&"!"===E[n+1]&&(n=E.indexOf(" ",n+1)),(-1===n||r<n)&&(t=!0)}t||(k=`\n${n.indent}`)}}else""!==E&&"\n"!==E[0]||(k="");return S+=k+E,n.inFlow?C&&r&&r():b&&!C?S+=J(S,n.indent,c(b)):w&&o&&o(),S}(this,e,t,n):JSON.stringify(this)}}function fe(e,t,n){return(t.inFlow??e.flow?ge:_e)(e,t,n)}function _e({comment:e,items:t},n,{blockItemPrefix:r,flowChars:o,itemIndent:s,onChompKeep:a,onComment:i}){const{indent:l,options:{commentString:c}}=n,d=Object.assign({},n,{indent:s,type:null});let u=!1;const p=[];for(let e=0;e<t.length;++e){const o=t[e];let a=null;if(h(o))!u&&o.spaceBefore&&p.push(""),he(n,p,o.commentBefore,u),o.comment&&(a=o.comment);else if(m(o)){const e=h(o.key)?o.key:null;e&&(!u&&e.spaceBefore&&p.push(""),he(n,p,e.commentBefore,u))}u=!1;let i=ae(o,d,(()=>a=null),(()=>u=!0));a&&(i+=J(i,s,c(a))),u&&a&&(u=!1),p.push(r+i)}let f;if(0===p.length)f=o.start+o.end;else{f=p[0];for(let e=1;e<p.length;++e){const t=p[e];f+=t?`\n${l}${t}`:"\n"}}return e?(f+="\n"+K(c(e),l),i&&i()):u&&a&&a(),f}function ge({items:e},t,{flowChars:n,itemIndent:r}){const{indent:o,indentStep:s,flowCollectionPadding:a,options:{commentString:i}}=t;r+=s;const l=Object.assign({},t,{indent:r,inFlow:!0,type:null});let c=!1,d=0;const u=[];for(let n=0;n<e.length;++n){const o=e[n];let s=null;if(h(o))o.spaceBefore&&u.push(""),he(t,u,o.commentBefore,!1),o.comment&&(s=o.comment);else if(m(o)){const e=h(o.key)?o.key:null;e&&(e.spaceBefore&&u.push(""),he(t,u,e.commentBefore,!1),e.comment&&(c=!0));const n=h(o.value)?o.value:null;n?(n.comment&&(s=n.comment),n.commentBefore&&(c=!0)):null==o.value&&e?.comment&&(s=e.comment)}s&&(c=!0);let a=ae(o,l,(()=>s=null));n<e.length-1&&(a+=","),s&&(a+=J(a,r,i(s))),!c&&(u.length>d||a.includes("\n"))&&(c=!0),u.push(a),d=u.length}const{start:p,end:f}=n;if(0===u.length)return p+f;if(!c){const e=u.reduce(((e,t)=>e+t.length+2),2);c=t.options.lineWidth>0&&e>t.options.lineWidth}if(c){let e=p;for(const t of u)e+=t?`\n${s}${o}${t}`:"\n";return`${e}\n${o}${f}`}return`${p}${a}${u.join(" ")}${a}${f}`}function he({indent:e,options:{commentString:t}},n,r,o){if(r&&o&&(r=r.replace(/^\n+/,"")),r){const o=K(t(r),e);n.push(o.trimStart())}}function ye(e,t){const n=f(t)?t.value:t;for(const r of e)if(m(r)){if(r.key===t||r.key===n)return r;if(f(r.key)&&r.key.value===n)return r}}class ve extends U{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(s,e),this.items=[]}static from(e,t,n){const{keepUndefined:r,replacer:o}=n,s=new this(e),a=(e,a)=>{if("function"==typeof o)a=o.call(t,e,a);else if(Array.isArray(o)&&!o.includes(e))return;(void 0!==a||r)&&s.items.push(pe(e,a,n))};if(t instanceof Map)for(const[e,n]of t)a(e,n);else if(t&&"object"==typeof t)for(const e of Object.keys(t))a(e,t[e]);return"function"==typeof e.sortMapEntries&&s.items.sort(e.sortMapEntries),s}add(e,t){let n;n=m(e)?e:e&&"object"==typeof e&&"key"in e?new me(e.key,e.value):new me(e,e?.value);const r=ye(this.items,n.key),o=this.schema?.sortMapEntries;if(r){if(!t)throw new Error(`Key ${n.key} already set`);f(r.value)&&q(n.value)?r.value.value=n.value:r.value=n.value}else if(o){const e=this.items.findIndex((e=>o(n,e)<0));-1===e?this.items.push(n):this.items.splice(e,0,n)}else this.items.push(n)}delete(e){const t=ye(this.items,e);if(!t)return!1;return this.items.splice(this.items.indexOf(t),1).length>0}get(e,t){const n=ye(this.items,e),r=n?.value;return(!t&&f(r)?r.value:r)??void 0}has(e){return!!ye(this.items,e)}set(e,t){this.add(new me(e,t),!0)}toJSON(e,t,n){const r=n?new n:t?.mapAsMap?new Map:{};t?.onCreate&&t.onCreate(r);for(const e of this.items)ue(t,r,e);return r}toString(e,t,n){if(!e)return JSON.stringify(this);for(const e of this.items)if(!m(e))throw new Error(`Map items must all be pairs; found ${JSON.stringify(e)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),fe(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:n,onComment:t})}}const be={collection:"map",default:!0,nodeClass:ve,tag:"tag:yaml.org,2002:map",resolve:(e,t)=>(p(e)||t("Expected a mapping for this tag"),e),createNode:(e,t,n)=>ve.from(e,t,n)};class xe extends U{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(l,e),this.items=[]}add(e){this.items.push(e)}delete(e){const t=we(e);if("number"!=typeof t)return!1;return this.items.splice(t,1).length>0}get(e,t){const n=we(e);if("number"!=typeof n)return;const r=this.items[n];return!t&&f(r)?r.value:r}has(e){const t=we(e);return"number"==typeof t&&t<this.items.length}set(e,t){const n=we(e);if("number"!=typeof n)throw new Error(`Expected a valid index, not ${e}.`);const r=this.items[n];f(r)&&q(t)?r.value=t:this.items[n]=t}toJSON(e,t){const n=[];t?.onCreate&&t.onCreate(n);let r=0;for(const e of this.items)n.push(B(e,String(r++),t));return n}toString(e,t,n){return e?fe(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:n,onComment:t}):JSON.stringify(this)}static from(e,t,n){const{replacer:r}=n,o=new this(e);if(t&&Symbol.iterator in Object(t)){let e=0;for(let s of t){if("function"==typeof r){const n=t instanceof Set?s:String(e++);s=r.call(t,n,s)}o.items.push(R(s,void 0,n))}}return o}}function we(e){let t=f(e)?e.value:e;return t&&"string"==typeof t&&(t=Number(t)),"number"==typeof t&&Number.isInteger(t)&&t>=0?t:null}const Se={collection:"seq",default:!0,nodeClass:xe,tag:"tag:yaml.org,2002:seq",resolve:(e,t)=>(_(e)||t("Expected a sequence for this tag"),e),createNode:(e,t,n)=>xe.from(e,t,n)},Ce={identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:(e,t,n,r)=>se(e,t=Object.assign({actualString:!0},t),n,r)},Ee={identify:e=>null==e,createNode:()=>new D(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new D(null),stringify:({source:e},t)=>"string"==typeof e&&Ee.test.test(e)?e:t.options.nullStr},ke={identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new D("t"===e[0]||"T"===e[0]),stringify({source:e,value:t},n){if(e&&ke.test.test(e)){if(t===("t"===e[0]||"T"===e[0]))return e}return t?n.options.trueStr:n.options.falseStr}};function Ne({format:e,minFractionDigits:t,tag:n,value:r}){if("bigint"==typeof r)return String(r);const o="number"==typeof r?r:Number(r);if(!isFinite(o))return isNaN(o)?".nan":o<0?"-.inf":".inf";let s=JSON.stringify(r);if(!e&&t&&(!n||"tag:yaml.org,2002:float"===n)&&/^\d/.test(s)){let e=s.indexOf(".");e<0&&(e=s.length,s+=".");let n=t-(s.length-e-1);for(;n-- >0;)s+="0"}return s}const Oe={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ne},Te={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():Ne(e)}},Ie={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const t=new D(parseFloat(e)),n=e.indexOf(".");return-1!==n&&"0"===e[e.length-1]&&(t.minFractionDigits=e.length-n-1),t},stringify:Ne},Le=e=>"bigint"==typeof e||Number.isInteger(e),$e=(e,t,n,{intAsBigInt:r})=>r?BigInt(e):parseInt(e.substring(t),n);function Ae(e,t,n){const{value:r}=e;return Le(r)&&r>=0?n+r.toString(t):Ne(e)}const Be={identify:e=>Le(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,t,n)=>$e(e,2,8,n),stringify:e=>Ae(e,8,"0o")},Me={identify:Le,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,t,n)=>$e(e,0,10,n),stringify:Ne},je={identify:e=>Le(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,t,n)=>$e(e,2,16,n),stringify:e=>Ae(e,16,"0x")},Fe=[be,Se,Ce,Ee,ke,Be,Me,je,Oe,Te,Ie];function qe(e){return"bigint"==typeof e||Number.isInteger(e)}const De=({value:e})=>JSON.stringify(e),Pe=[be,Se].concat([{identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:De},{identify:e=>null==e,createNode:()=>new D(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:De},{identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:e=>"true"===e,stringify:De},{identify:qe,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,t,{intAsBigInt:n})=>n?BigInt(e):parseInt(e,10),stringify:({value:e})=>qe(e)?e.toString():JSON.stringify(e)},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:De}],{default:!0,tag:"",test:/^/,resolve:(e,t)=>(t(`Unresolved plain scalar ${JSON.stringify(e)}`),e)}),Re={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,t){if("function"==typeof atob){const t=atob(e.replace(/[\n\r]/g,"")),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n[e]=t.charCodeAt(e);return n}return t("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:t,value:n},r,o,s){if(!n)return"";const a=n;let i;if("function"!=typeof btoa)throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");{let e="";for(let t=0;t<a.length;++t)e+=String.fromCharCode(a[t]);i=btoa(e)}if(t||(t=D.BLOCK_LITERAL),t!==D.QUOTE_DOUBLE){const e=Math.max(r.options.lineWidth-r.indent.length,r.options.minContentWidth),n=Math.ceil(i.length/e),o=new Array(n);for(let t=0,r=0;t<n;++t,r+=e)o[t]=i.substr(r,e);i=o.join(t===D.BLOCK_LITERAL?"\n":" ")}return se({comment:e,type:t,value:i},r,o,s)}};function Ve(e,t){if(_(e))for(let n=0;n<e.items.length;++n){let r=e.items[n];if(!m(r)){if(p(r)){r.items.length>1&&t("Each pair must have its own sequence indicator");const e=r.items[0]||new me(new D(null));if(r.commentBefore&&(e.key.commentBefore=e.key.commentBefore?`${r.commentBefore}\n${e.key.commentBefore}`:r.commentBefore),r.comment){const t=e.value??e.key;t.comment=t.comment?`${r.comment}\n${t.comment}`:r.comment}r=e}e.items[n]=m(r)?r:new me(r)}}else t("Expected a sequence for this tag");return e}function Ue(e,t,n){const{replacer:r}=n,o=new xe(e);o.tag="tag:yaml.org,2002:pairs";let s=0;if(t&&Symbol.iterator in Object(t))for(let e of t){let a,i;if("function"==typeof r&&(e=r.call(t,String(s++),e)),Array.isArray(e)){if(2!==e.length)throw new TypeError(`Expected [key, value] tuple: ${e}`);a=e[0],i=e[1]}else if(e&&e instanceof Object){const t=Object.keys(e);if(1!==t.length)throw new TypeError(`Expected tuple with one key, not ${t.length} keys`);a=t[0],i=e[a]}else a=e;o.items.push(pe(a,i,n))}return o}const Ge={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:Ve,createNode:Ue};class Ke extends xe{constructor(){super(),this.add=ve.prototype.add.bind(this),this.delete=ve.prototype.delete.bind(this),this.get=ve.prototype.get.bind(this),this.has=ve.prototype.has.bind(this),this.set=ve.prototype.set.bind(this),this.tag=Ke.tag}toJSON(e,t){if(!t)return super.toJSON(e);const n=new Map;t?.onCreate&&t.onCreate(n);for(const e of this.items){let r,o;if(m(e)?(r=B(e.key,"",t),o=B(e.value,r,t)):r=B(e,"",t),n.has(r))throw new Error("Ordered maps must not include duplicate keys");n.set(r,o)}return n}static from(e,t,n){const r=Ue(e,t,n),o=new this;return o.items=r.items,o}}Ke.tag="tag:yaml.org,2002:omap";const Je={collection:"seq",identify:e=>e instanceof Map,nodeClass:Ke,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,t){const n=Ve(e,t),r=[];for(const{key:e}of n.items)f(e)&&(r.includes(e.value)?t(`Ordered maps must not include duplicate keys: ${e.value}`):r.push(e.value));return Object.assign(new Ke,n)},createNode:(e,t,n)=>Ke.from(e,t,n)};function Qe({value:e,source:t},n){return t&&(e?ze:We).test.test(t)?t:e?n.options.trueStr:n.options.falseStr}const ze={identify:e=>!0===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new D(!0),stringify:Qe},We={identify:e=>!1===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new D(!1),stringify:Qe},He={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ne},Ye={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():Ne(e)}},Xe={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const t=new D(parseFloat(e.replace(/_/g,""))),n=e.indexOf(".");if(-1!==n){const r=e.substring(n+1).replace(/_/g,"");"0"===r[r.length-1]&&(t.minFractionDigits=r.length)}return t},stringify:Ne},Ze=e=>"bigint"==typeof e||Number.isInteger(e);function et(e,t,n,{intAsBigInt:r}){const o=e[0];if("-"!==o&&"+"!==o||(t+=1),e=e.substring(t).replace(/_/g,""),r){switch(n){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`}const t=BigInt(e);return"-"===o?BigInt(-1)*t:t}const s=parseInt(e,n);return"-"===o?-1*s:s}function tt(e,t,n){const{value:r}=e;if(Ze(r)){const e=r.toString(t);return r<0?"-"+n+e.substr(1):n+e}return Ne(e)}const nt={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,t,n)=>et(e,2,2,n),stringify:e=>tt(e,2,"0b")},rt={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,t,n)=>et(e,1,8,n),stringify:e=>tt(e,8,"0")},ot={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,t,n)=>et(e,0,10,n),stringify:Ne},st={identify:Ze,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,t,n)=>et(e,2,16,n),stringify:e=>tt(e,16,"0x")};class at extends ve{constructor(e){super(e),this.tag=at.tag}add(e){let t;t=m(e)?e:e&&"object"==typeof e&&"key"in e&&"value"in e&&null===e.value?new me(e.key,null):new me(e,null);ye(this.items,t.key)||this.items.push(t)}get(e,t){const n=ye(this.items,e);return!t&&m(n)?f(n.key)?n.key.value:n.key:n}set(e,t){if("boolean"!=typeof t)throw new Error("Expected boolean value for set(key, value) in a YAML set, not "+typeof t);const n=ye(this.items,e);n&&!t?this.items.splice(this.items.indexOf(n),1):!n&&t&&this.items.push(new me(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,n){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,n);throw new Error("Set items must all have null values")}static from(e,t,n){const{replacer:r}=n,o=new this(e);if(t&&Symbol.iterator in Object(t))for(let e of t)"function"==typeof r&&(e=r.call(t,e,e)),o.items.push(pe(e,null,n));return o}}at.tag="tag:yaml.org,2002:set";const it={collection:"map",identify:e=>e instanceof Set,nodeClass:at,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,t,n)=>at.from(e,t,n),resolve(e,t){if(p(e)){if(e.hasAllNullValues(!0))return Object.assign(new at,e);t("Set items must all have null values")}else t("Expected a mapping for this tag");return e}};function lt(e,t){const n=e[0],r="-"===n||"+"===n?e.substring(1):e,o=e=>t?BigInt(e):Number(e),s=r.replace(/_/g,"").split(":").reduce(((e,t)=>e*o(60)+o(t)),o(0));return"-"===n?o(-1)*s:s}function ct(e){let{value:t}=e,n=e=>e;if("bigint"==typeof t)n=e=>BigInt(e);else if(isNaN(t)||!isFinite(t))return Ne(e);let r="";t<0&&(r="-",t*=n(-1));const o=n(60),s=[t%o];return t<60?s.unshift(0):(t=(t-s[0])/o,s.unshift(t%o),t>=60&&(t=(t-s[0])/o,s.unshift(t))),r+s.map((e=>String(e).padStart(2,"0"))).join(":").replace(/000000\d*$/,"")}const dt={identify:e=>"bigint"==typeof e||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,t,{intAsBigInt:n})=>lt(e,n),stringify:ct},ut={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>lt(e,!1),stringify:ct},pt={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const t=e.match(pt.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,r,o,s,a,i]=t.map(Number),l=t[7]?Number((t[7]+"00").substr(1,3)):0;let c=Date.UTC(n,r-1,o,s||0,a||0,i||0,l);const d=t[8];if(d&&"Z"!==d){let e=lt(d,!1);Math.abs(e)<30&&(e*=60),c-=6e4*e}return new Date(c)},stringify:({value:e})=>e?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""},mt=[be,Se,Ce,Ee,ze,We,nt,rt,ot,st,He,Ye,Xe,Re,le,Je,Ge,it,dt,ut,pt];new Map([["core",Fe],["failsafe",[be,Se,Ce]],["json",Pe],["yaml11",mt],["yaml-1.1",mt]]);Error;const ft=Symbol("break visit"),_t=Symbol("skip children"),gt=Symbol("remove item");function ht(e,t){"type"in e&&"document"===e.type&&(e={start:e.start,value:e.value}),yt(Object.freeze([]),e,t)}function yt(e,t,n){let r=n(t,e);if("symbol"==typeof r)return r;for(const o of["key","value"]){const s=t[o];if(s&&"items"in s){for(let t=0;t<s.items.length;++t){const r=yt(Object.freeze(e.concat([[o,t]])),s.items[t],n);if("number"==typeof r)t=r-1;else{if(r===ft)return ft;r===gt&&(s.items.splice(t,1),t-=1)}}"function"==typeof r&&"key"===o&&(r=r(t,e))}}return"function"==typeof r?r(t,e):r}ht.BREAK=ft,ht.SKIP=_t,ht.REMOVE=gt,ht.itemAtPath=(e,t)=>{let n=e;for(const[e,r]of t){const t=n?.[e];if(!t||!("items"in t))return;n=t.items[r]}return n},ht.parentCollection=(e,t)=>{const n=ht.itemAtPath(e,t.slice(0,-1)),r=t[t.length-1][0],o=n?.[r];if(o&&"items"in o)return o;throw new Error("Parent collection not found")};new Set("0123456789ABCDEFabcdef"),new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),new Set(",[]{}"),new Set(" ,[]{}\n\r\t");var vt=n(72),bt=n.n(vt),xt=n(825),wt=n.n(xt),St=n(659),Ct=n.n(St),Et=n(56),kt=n.n(Et),Nt=n(540),Ot=n.n(Nt),Tt=n(113),It=n.n(Tt),Lt=n(208),$t={};$t.styleTagTransform=It(),$t.setAttributes=kt(),$t.insert=Ct().bind(null,"head"),$t.domAPI=wt(),$t.insertStyleElement=Ot();bt()(Lt.A,$t);Lt.A&&Lt.A.locals&&Lt.A.locals;const At='<div class="slider_macros_card" data-expanded="false"> <div class="slider_macros_card_header"> <div class="slider_macros_card_toggle"> <i class="fa-solid fa-chevron-right slider_macros_card_chevron"></i> </div> <div class="slider_macros_card_summary"> <span class="slider_macros_card_name" data-field="name">New Slider</span> <span class="slider_macros_card_macro" data-field="property"></span> <span class="slider_macros_card_type_badge" data-field="type">Numeric</span> <span class="slider_macros_card_group_badge" data-field="group" title="Assigned group"> <i class="fa-solid fa-layer-group"></i> <span class="slider_macros_card_group_name"></span> </span> </div> <div class="slider_macros_card_controls"> <label class="checkbox_label slider_macros_toggle" title="Enable/Disable Slider"> <input type="checkbox" name="enabled"> </label> <button class="menu_button menu_button_icon slider_macros_btn_icon" name="up" type="button" title="Move Up"> <i class="fa-solid fa-chevron-up"></i> </button> <button class="menu_button menu_button_icon slider_macros_btn_icon" name="down" type="button" title="Move Down"> <i class="fa-solid fa-chevron-down"></i> </button> </div> </div> <div class="slider_macros_card_body"> <div class="slider_macros_field_group"> <div class="slider_macros_field"> <label class="slider_macros_label">Name</label> <input class="text_pole" type="text" name="name" placeholder="e.g. Temperature"> </div> <div class="slider_macros_field"> <label class="slider_macros_label">Macro Variable</label> <div class="slider_macros_macro_input_row"> <div class="slider_macros_macro_input"> <span class="slider_macros_macro_prefix">{{</span> <input class="text_pole" type="text" name="property" placeholder="myVar"> <span class="slider_macros_macro_suffix">}}</span> </div> <button class="menu_button menu_button_icon slider_macros_btn_search_macro" name="searchMacro" type="button" title="Search existing macros to override"> <i class="fa-solid fa-search"></i> </button> </div> <div class="slider_macros_macro_status" name="macroStatus"></div> </div> </div> <div class="slider_macros_field"> <label class="slider_macros_label">Type</label> <select class="text_pole" name="type"> <option value="Numeric" selected="selected">Numeric</option> <option value="Boolean">Boolean</option> <option value="MultiSelect">MultiSelect</option> <option value="Dropdown">Dropdown</option> <option value="Color">Color</option> <option value="Checkbox">Checkbox</option> </select> </div> <div class="slider_macros_field"> <label class="slider_macros_label">Group <span class="slider_macros_optional">(optional)</span></label> <select class="text_pole" name="groupId"> <option value="">No Group</option> </select> </div> <div class="numeric-only slider_macros_type_section"> <div class="slider_macros_field_row"> <div class="slider_macros_field slider_macros_field_compact"> <label class="slider_macros_label">Min</label> <input class="text_pole" type="text" name="min" placeholder="0"> </div> <div class="slider_macros_field slider_macros_field_compact"> <label class="slider_macros_label">Max</label> <input class="text_pole" type="text" name="max" placeholder="1"> </div> <div class="slider_macros_field slider_macros_field_compact"> <label class="slider_macros_label">Step</label> <input class="text_pole" type="text" name="step" placeholder="0.01"> </div> </div> </div> <div class="boolean-only slider_macros_type_section"> <div class="slider_macros_field"> <label class="slider_macros_label">Default Value</label> <select class="text_pole" name="defaultBoolean"> <option value="true">True</option> <option value="false">False</option> </select> </div> </div> <div class="multiselect-only slider_macros_type_section"> <div class="slider_macros_field_row"> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">Option 1</label> <input class="text_pole" type="text" name="option1" placeholder="e.g. Low"> </div> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">Option 2</label> <input class="text_pole" type="text" name="option2" placeholder="e.g. High"> </div> </div> <div class="slider_macros_field_row"> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">Option 3 <span class="slider_macros_optional">(optional)</span></label> <input class="text_pole" type="text" name="option3" placeholder=""> </div> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">Option 4 <span class="slider_macros_optional">(optional)</span></label> <input class="text_pole" type="text" name="option4" placeholder=""> </div> </div> </div> <div class="dropdown-only slider_macros_type_section"> <div class="slider_macros_field"> <label class="slider_macros_label">Dropdown Options <span class="slider_macros_optional">(key → macro value)</span></label> <div class="slider_macros_dropdown_options" data-name="dropdownOptions"> </div> <button class="menu_button menu_button_icon slider_macros_btn_add_option" name="addDropdownOption" type="button"> <i class="fa-solid fa-plus"></i> <span>Add Option</span> </button> </div> </div> <div class="color-only slider_macros_type_section"> <div class="slider_macros_field"> <label class="slider_macros_label">Output Format</label> <select class="text_pole" name="colorFormat"> <option value="hex" selected="selected">HEX (#RRGGBB)</option> <option value="rgb">RGB (rgb(r, g, b))</option> <option value="hsv">HSV (hsv(h, s%, v%))</option> </select> </div> <div class="slider_macros_field"> <label class="slider_macros_label">Default Color</label> <input class="text_pole slider_macros_color_default" type="color" name="defaultColor" value="#ffffff"> </div> </div> <div class="checkbox-only slider_macros_type_section"> <div class="slider_macros_field_row"> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">True Value <span class="slider_macros_optional">(macro output when checked)</span></label> <input class="text_pole" type="text" name="checkboxTrueValue" placeholder="true"> </div> <div class="slider_macros_field slider_macros_field_half"> <label class="slider_macros_label">False Value <span class="slider_macros_optional">(macro output when unchecked)</span></label> <input class="text_pole" type="text" name="checkboxFalseValue" placeholder="false"> </div> </div> <div class="slider_macros_field"> <label class="slider_macros_label">Default State</label> <select class="text_pole" name="defaultCheckbox"> <option value="false" selected="selected">Unchecked</option> <option value="true">Checked</option> </select> </div> </div> <div class="slider_macros_card_delete_row"> <button class="menu_button menu_button_icon slider_macros_btn_danger_full" name="delete" type="button"> <i class="fa-solid fa-trash-alt"></i> <span>Delete Slider</span> </button> </div> </div> </div> ';const Bt='<div class="range-block" data-source="openai,claude,aimlapi,openrouter,ai21,makersuite,vertexai,mistralai,custom,cohere,perplexity,groq,siliconflow,electronhub,chutes,nanogpt,deepseek,xai,pollinations,moonshot,fireworks,cometapi,azure_openai,zai"> <div class="range-block-title"></div> <div class="range-block-range-and-counter"> <div class="range-block-range"> <input type="range"> </div> <div class="range-block-counter"> <input type="number"> </div> </div> </div>';const Mt='<div class="slider_macros_group_card" data-expanded="false"> <div class="slider_macros_group_card_header"> <div class="slider_macros_card_toggle"> <i class="fa-solid fa-chevron-right slider_macros_card_chevron"></i> </div> <div class="slider_macros_group_card_summary"> <i class="fa-solid fa-layer-group slider_macros_group_icon"></i> <span class="slider_macros_group_card_name" data-field="name">New Group</span> <span class="slider_macros_group_card_count">(0 sliders)</span> </div> <div class="slider_macros_card_controls"> <button class="menu_button menu_button_icon slider_macros_btn_icon" name="up" type="button" title="Move Up"> <i class="fa-solid fa-chevron-up"></i> </button> <button class="menu_button menu_button_icon slider_macros_btn_icon" name="down" type="button" title="Move Down"> <i class="fa-solid fa-chevron-down"></i> </button> </div> </div> <div class="slider_macros_group_card_body"> <div class="slider_macros_field"> <label class="slider_macros_label">Group Name</label> <input class="text_pole" type="text" name="groupName" placeholder="e.g. Temperature Settings"> </div> <div class="slider_macros_group_sliders"></div> <div class="slider_macros_card_delete_row"> <button class="menu_button menu_button_icon slider_macros_btn_danger_full" name="deleteGroup" type="button"> <i class="fa-solid fa-trash-alt"></i> <span>Delete Group</span> </button> </div> </div> </div> ';var jt=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{l(r.next(e))}catch(e){s(e)}}function i(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}l((r=r.apply(e,t||[])).next())}))};const{saveSettingsDebounced:Ft,event_types:qt,eventSource:Dt,chatCompletionSettings:Pt,Popup:Rt,powerUserSettings:Vt,macros:Ut,MacrosParser:Gt,substituteParams:Kt}=SillyTavern.getContext(),Jt="sliderMacros";function Qt(e,t){let n=null;return(...r)=>{n&&clearTimeout(n),n=setTimeout((()=>{e(...r),n=null}),t)}}const zt=Qt((()=>Ft()),300),Wt=e=>Qt((()=>dn(e)),300);function Ht(e){var t,n;const r=`{{${e}}}`;if((null==Vt?void 0:Vt.experimental_macro_engine)&&(null==Ut?void 0:Ut.engine))try{const e=null===(t=Ut.envBuilder)||void 0===t?void 0:t.buildFromRawEnv({});if(e){const t=Ut.engine.evaluate(r,e);if(t!==r)return t}}catch(e){console.warn("[SliderMacros] Failed to retrieve macro from new engine:",e)}if("function"==typeof Kt){const e=Kt(r);if(e!==r)return e}if(!(null==Vt?void 0:Vt.experimental_macro_engine)&&(null==Ut?void 0:Ut.registry)&&(null==Ut?void 0:Ut.engine))try{if(Ut.registry.hasMacro(e)){const e=null===(n=Ut.envBuilder)||void 0===n?void 0:n.buildFromRawEnv({});if(e){const t=Ut.engine.evaluate(r,e);if(t!==r)return t}}}catch(e){console.warn("[SliderMacros] Failed to retrieve macro from new engine fallback:",e)}return r}function Yt(e,t=20){const n=function(){var e;const t=new Map;if(null===(e=null==Ut?void 0:Ut.registry)||void 0===e?void 0:e.getAllMacros)try{const e=Ut.registry.getAllMacros({excludeHiddenAliases:!0});for(const n of e)t.set(n.name,{name:n.name,description:n.description||"",source:"v2",category:n.category})}catch(e){console.warn("[SliderMacros] Failed to get macros from new registry:",e)}if(Gt)try{for(const{key:e,description:n}of Gt)t.has(e)||t.set(e,{name:e,description:n||"",source:"legacy"})}catch(e){console.warn("[SliderMacros] Failed to get macros from legacy parser:",e)}return Array.from(t.values())}(),r=e.toLowerCase().trim();return r?n.filter((e=>e.name.toLowerCase().includes(r)||e.description.toLowerCase().includes(r))).slice(0,t):n.slice(0,t)}const Xt=Object.freeze({collections:[{active:!0,name:"Default",sliders:[],presets:[],groups:[]}]});function Zt(e){const t=[...e.groups.map((e=>e.order)),...e.sliders.filter((e=>!e.groupId)).map((e=>e.order))];return t.length>0?Math.max(...t)+1:0}function en(){const e=SillyTavern.getContext().extensionSettings;e[Jt]||(e[Jt]=structuredClone(Xt));for(const t in Xt)void 0===e[Jt][t]&&(e[Jt][t]=Xt[t]);const t=e[Jt];0===t.collections.length&&t.collections.push(Xt.collections[0]),t.collections.some((e=>e.active))||(t.collections[0].active=!0);for(const e of t.collections){e.groups||(e.groups=[]);let t=-1;for(const n of e.groups)void 0===n.order&&(n.order=e.groups.indexOf(n)),t=Math.max(t,n.order);let n=t;for(const t of e.sliders)void 0===t.groupId&&(t.groupId=null),void 0===t.order?(n++,t.order=n):n=Math.max(n,t.order)}return t}function tn(){return{create:document.getElementById("slider_macros_create"),createGroup:document.getElementById("slider_macros_create_group"),list:document.getElementById("slider_macros_list"),collections:document.getElementById("slider_macros_collections"),createCollection:document.getElementById("slider_macros_create_collection"),deleteCollection:document.getElementById("slider_macros_delete_collection"),bindToPreset:document.getElementById("slider_macros_bind_to_preset"),hint:document.getElementById("slider_macros_hint"),importFile:document.getElementById("slider_macros_import_file"),importCollection:document.getElementById("slider_macros_import_collection"),exportCollection:document.getElementById("slider_macros_export_collection")}}function nn(e){var t;const n=null!==(t=document.getElementById("slider_macros_container"))&&void 0!==t?t:document.getElementById("extensions_settings");if(!n)return;const r=document.createElement("template");r.innerHTML='<div id="slider_macros_settings"> <div class="inline-drawer"> <div class="inline-drawer-toggle inline-drawer-header"> <b> <i class="fa-solid fa-sliders"></i> <span>Slider Macros</span> </b> <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div> </div> <div class="inline-drawer-content"> <div class="slider_macros_toolbar"> <input type="file" id="slider_macros_import_file" hidden accept=".json"> <div class="slider_macros_toolbar_row"> <select class="text_pole" id="slider_macros_collections"></select> <div class="slider_macros_toolbar_actions"> <div id="slider_macros_create_collection" class="menu_button menu_button_icon" title="Create New Collection"> <i class="fa-solid fa-folder-plus"></i> </div> <div id="slider_macros_bind_to_preset" class="menu_button menu_button_icon" title="Bind to Current Preset"> <i class="fa-solid fa-link"></i> </div> <div class="slider_macros_toolbar_divider"></div> <div id="slider_macros_import_collection" class="menu_button menu_button_icon" title="Import Collection"> <i class="fa-solid fa-file-import"></i> </div> <div id="slider_macros_export_collection" class="menu_button menu_button_icon" title="Export Collection"> <i class="fa-solid fa-file-export"></i> </div> <div class="slider_macros_toolbar_divider"></div> <div id="slider_macros_delete_collection" class="menu_button menu_button_icon slider_macros_btn_danger" title="Delete Collection"> <i class="fa-solid fa-trash-alt"></i> </div> </div> </div> </div> <div class="slider_macros_create_row"> <div id="slider_macros_create" class="menu_button menu_button_icon slider_macros_btn_create"> <i class="fa-solid fa-plus"></i> <span>Create Slider</span> </div> <div id="slider_macros_create_group" class="menu_button menu_button_icon slider_macros_btn_create slider_macros_btn_create_group"> <i class="fa-solid fa-layer-group"></i> <span>Create Group</span> </div> </div> <div id="slider_macros_list" class="slider_macros_list"></div> </div> </div> </div> ',n.appendChild(r.content);const o=tn();o.create.addEventListener("click",an),o.createGroup.addEventListener("click",ln),o.createCollection.addEventListener("click",on),o.deleteCollection.addEventListener("click",rn),o.bindToPreset.addEventListener("click",sn),o.collections.addEventListener("change",(t=>{const n=o.collections.value;e.collections.forEach((e=>{e.active=e.name===n})),Ft(),cn(e)})),o.importCollection.addEventListener("click",(()=>jt(this,void 0,void 0,(function*(){o.importFile.click()})))),o.exportCollection.addEventListener("click",(()=>jt(this,void 0,void 0,(function*(){const t=e.collections.find((e=>e.active));if(!t)return;const n=t.name+".json",r=JSON.stringify(t.sliders,null,4),o=new Blob([r],{type:"application/json"}),s=URL.createObjectURL(o),a=document.createElement("a");a.href=s,a.download=n,a.click(),URL.revokeObjectURL(s)})))),o.importFile.addEventListener("change",(t=>{var n;const r=null===(n=o.importFile.files)||void 0===n?void 0:n[0];if(!r)return;const s=new FileReader;s.onload=t=>{var n;try{const o=r.name.split(".").shift()||"imported",s=null===(n=t.target)||void 0===n?void 0:n.result,a=JSON.parse(s);if(!Array.isArray(a))return void toastr.error("Invalid JSON file format.");!function(e,t,n){jt(this,void 0,void 0,(function*(){const r=yield Rt.show.input("Import Collection","Enter the name of the new collection:",e);if(!r)return;if(n.collections.find((e=>e.name===r)))return void toastr.warning("Collection with this name already exists.");const o={active:!0,name:r,sliders:t,presets:[]};n.collections.forEach((e=>{e.active=!1})),n.collections.push(o),Ft(),cn(n),toastr.success(`Imported ${t.length} sliders into collection "${r}".`)}))}(o,a,e)}catch(e){return void toastr.error("Failed to parse JSON file.")}},s.readAsText(r),o.importFile.value=""})),cn(e)}function rn(){return jt(this,void 0,void 0,(function*(){const e=en();if(1===e.collections.length)return void toastr.warning("Cannot delete the last collection.");const t=e.collections.find((e=>e.active));if(!t)return;if(!(yield Rt.show.confirm("Delete Collection",`Are you sure you want to delete the collection "${t.name}"?`)))return;const n=e.collections.indexOf(t);e.collections.splice(n,1);const r=e.collections[0];r&&(r.active=!0),Ft(),cn(e)}))}function on(){return jt(this,void 0,void 0,(function*(){const e=en(),t=yield Rt.show.input("New Collection Name","Enter the name of the new collection:");if(!t)return;e.collections.find((e=>e.name===t))?toastr.warning("Collection with this name already exists."):(e.collections.forEach((e=>{e.active=!1})),e.collections.push({active:!0,name:t,sliders:[],presets:[]}),Ft(),cn(e))}))}function sn(){const e=en(),t=Pt.preset_settings_openai;if(!t)return void toastr.warning("No Chat Completion preset selected.");const n=e.collections.find((e=>e.active));if(!n)return;const r=e.collections.find((e=>e.presets.includes(t)));r?(r.presets.splice(r.presets.indexOf(t),1),r!==n&&(toastr.warning(`The preset will be unbound from another collection "${r.name}".`),n.presets.push(t))):(n.presets.push(t),toastr.info(`Selecting the preset "${t}" will now automatically pick the sliders collection "${n.name}".`)),Ft(),cn(e)}function an(){const e=en(),t=e.collections.find((e=>e.active));t&&(t.sliders.unshift({name:"New Slider",property:"",type:"Numeric",min:"0",max:"1",step:"0.01",value:0,enabled:!0,options:[],dropdownOptions:[],colorFormat:"hex",checkboxTrueValue:"true",checkboxFalseValue:"false",groupId:null,order:Zt(t)}),Ft(),cn(e))}function ln(){const e=en(),t=e.collections.find((e=>e.active));t&&(t.groups.push({id:"group_"+Date.now()+"_"+Math.random().toString(36).substring(2,9),name:"New Group",collapsed:!1,order:Zt(t)}),Ft(),cn(e))}function cn(e){const t=tn(),n=Wt(e);t.list.innerHTML="";const r=e.collections.find((e=>e.active));if(!r)return;t.collections.innerHTML="",e.collections.forEach((e=>{const n=document.createElement("option");n.value=e.name,n.textContent=e.name,n.selected=e.active,t.collections.appendChild(n)}));const o=Pt.preset_settings_openai;t.bindToPreset.classList.toggle("toggleEnabled",r.presets.includes(o));const s=(t,o)=>{const s=document.createElement("template");s.innerHTML=At;const a=s.content.querySelector(".slider_macros_card"),i=s.content.querySelector(".slider_macros_card_header"),l=s.content.querySelector(".slider_macros_card_name"),c=s.content.querySelector(".slider_macros_card_macro"),d=s.content.querySelector(".slider_macros_card_type_badge"),u=s.content.querySelector(".slider_macros_card_group_badge"),p=(s.content.querySelector(".slider_macros_card_group_name"),s.content.querySelector('input[name="name"]')),m=s.content.querySelector('input[name="property"]'),f=s.content.querySelector('input[name="min"]'),_=s.content.querySelector('input[name="max"]'),g=s.content.querySelector('input[name="step"]'),h=s.content.querySelector('input[name="enabled"]'),y=s.content.querySelector('select[name="type"]'),v=s.content.querySelector('select[name="groupId"]'),b=s.content.querySelector('button[name="delete"]'),x=s.content.querySelector('button[name="up"]'),w=s.content.querySelector('button[name="down"]'),S=s.content.querySelector(".numeric-only"),C=s.content.querySelector(".boolean-only"),E=s.content.querySelector(".multiselect-only"),k=s.content.querySelector(".dropdown-only"),N=s.content.querySelector(".color-only"),O=s.content.querySelector(".checkbox-only"),T=s.content.querySelector('select[name="colorFormat"]'),I=s.content.querySelector('input[name="defaultColor"]'),L=s.content.querySelector('input[name="checkboxTrueValue"]'),$=s.content.querySelector('input[name="checkboxFalseValue"]'),A=s.content.querySelector('select[name="defaultCheckbox"]'),B=s.content.querySelector(".slider_macros_dropdown_options"),M=s.content.querySelector('button[name="addDropdownOption"]'),j=s.content.querySelector('button[name="searchMacro"]'),F=s.content.querySelector(".slider_macros_macro_status");t.dropdownOptions||(t.dropdownOptions=[]),t.colorFormat||(t.colorFormat="hex"),t.checkboxTrueValue||(t.checkboxTrueValue="true"),t.checkboxFalseValue||(t.checkboxFalseValue="false"),p.value=t.name,m.value=t.property,f.value=t.min,_.value=t.max,g.value=t.step,h.checked=t.enabled,y.value=t.type||"Numeric",T&&(T.value=t.colorFormat),I&&(I.value="string"==typeof t.value&&t.value.startsWith("#")?t.value:"#ffffff"),L&&(L.value=t.checkboxTrueValue),$&&($.value=t.checkboxFalseValue),A&&(A.value=!0===t.value?"true":"false"),v&&(v.innerHTML='<option value="">No Group</option>',r.groups.forEach((e=>{const n=document.createElement("option");n.value=e.id,n.textContent=e.name,n.selected=t.groupId===e.id,v.appendChild(n)}))),l.textContent=t.name||"New Slider",c.textContent=t.property||"",d.textContent=t.type||"Numeric",u&&(u.dataset.visible="false"),t.enabled||(a.dataset.disabled="true"),i.addEventListener("click",(e=>{if(e.target.closest(".slider_macros_card_controls"))return;const t="true"===a.dataset.expanded;a.dataset.expanded=t?"false":"true"}));const q=[s.content.querySelector('input[name="option1"]'),s.content.querySelector('input[name="option2"]'),s.content.querySelector('input[name="option3"]'),s.content.querySelector('input[name="option4"]')];t.options||(t.options=["","","",""]),q.forEach(((e,r)=>{e&&(e.value=t.options[r]||"",e.addEventListener("input",(()=>{t.options[r]=e.value,n(),zt()})))}));const D=()=>{const e=y.value;S&&(S.style.display="Numeric"===e?"block":"none"),C&&(C.style.display="Boolean"===e?"block":"none"),E&&(E.style.display="MultiSelect"===e?"block":"none"),k&&(k.style.display="Dropdown"===e?"block":"none"),N&&(N.style.display="Color"===e?"block":"none"),O&&(O.style.display="Checkbox"===e?"block":"none")},P=()=>{B&&(B.innerHTML="",t.dropdownOptions.forEach(((e,r)=>{const o=document.createElement("div");o.className="slider_macros_dropdown_option_row";const s=document.createElement("input");s.type="text",s.className="text_pole slider_macros_dropdown_key",s.placeholder="Display name",s.value=e.key,s.addEventListener("input",(()=>{t.dropdownOptions[r].key=s.value,n(),zt()}));const a=document.createElement("span");a.className="slider_macros_dropdown_arrow",a.textContent="→";const i=document.createElement("input");i.type="text",i.className="text_pole slider_macros_dropdown_value",i.placeholder="Macro value",i.value=e.value,i.addEventListener("input",(()=>{t.dropdownOptions[r].value=i.value,n(),zt()}));const l=document.createElement("button");l.type="button",l.className="menu_button menu_button_icon slider_macros_btn_remove_option",l.innerHTML='<i class="fa-solid fa-times"></i>',l.title="Remove option",l.addEventListener("click",(()=>{t.dropdownOptions.splice(r,1),P(),n(),zt()})),o.appendChild(s),o.appendChild(a),o.appendChild(i),o.appendChild(l),B.appendChild(o)})))};P(),M&&M.addEventListener("click",(()=>{t.dropdownOptions.push({key:"",value:""}),P(),zt()})),T&&T.addEventListener("change",(()=>{t.colorFormat=T.value,n(),zt()})),I&&I.addEventListener("input",(()=>{t.value=I.value,n(),zt()})),L&&L.addEventListener("input",(()=>{t.checkboxTrueValue=L.value,n(),zt()})),$&&$.addEventListener("input",(()=>{t.checkboxFalseValue=$.value,n(),zt()})),A&&A.addEventListener("change",(()=>{t.value="true"===A.value,n(),zt()})),D(),y.addEventListener("change",(()=>{t.type=y.value,d.textContent=t.type,D(),Ft(),dn(e)})),v&&v.addEventListener("change",(()=>{t.groupId=v.value||null,Ft(),cn(e)})),p.addEventListener("input",(()=>{t.name=p.value,l.textContent=t.name||"New Slider",n(),zt()})),m.addEventListener("input",(()=>{t.property=m.value,c.textContent=t.property||"",R(),n(),zt()}));const R=()=>{if(!F)return;const e=m.value.trim();if(!e)return F.textContent="",void(F.className="slider_macros_macro_status");if(function(e){var t,n;if(null===(n=null===(t=null==Ut?void 0:Ut.registry)||void 0===t?void 0:t.hasMacro)||void 0===n?void 0:n.call(t,e))return!0;if(Gt)for(const{key:t}of Gt)if(t===e)return!0;const r=`{{${e}}}`;return Ht(e)!==r}(e)){const t=Ht(e),n=t.length>30?t.substring(0,30)+"...":t;F.textContent=`Overrides existing macro (current: ${n})`,F.className="slider_macros_macro_status exists"}else F.textContent="New macro will be created",F.className="slider_macros_macro_status available"};return R(),j&&j.addEventListener("click",(()=>jt(this,void 0,void 0,(function*(){const n=yield function(){return jt(this,void 0,void 0,(function*(){return new Promise((e=>{const t=document.createElement("div");t.className="slider_macros_search_container";const n=document.createElement("div");n.className="slider_macros_search_input_row";const r=document.createElement("input");r.type="text",r.className="text_pole",r.placeholder="Search macros by name or description...",n.appendChild(r),t.appendChild(n);const o=document.createElement("div");o.className="slider_macros_search_results",t.appendChild(o);let s=null;const a=e=>{const t=Yt(e,50);if(o.innerHTML="",0===t.length){const t=document.createElement("div");return t.className="slider_macros_search_empty",t.textContent=e?"No macros found matching your search.":"No macros available.",void o.appendChild(t)}t.forEach((e=>{const t=document.createElement("div");t.className="slider_macros_search_result";const n=document.createElement("div"),r=document.createElement("span");r.className="slider_macros_search_result_name",r.textContent=`{{${e.name}}}`,n.appendChild(r);const a=document.createElement("span");if(a.className="slider_macros_search_result_source "+("legacy"===e.source?"legacy":""),a.textContent="v2"===e.source?"2.0":"Legacy",n.appendChild(a),t.appendChild(n),e.description){const n=document.createElement("div");n.className="slider_macros_search_result_desc",n.textContent=e.description,t.appendChild(n)}try{const n=Ht(e.name);if(n!==`{{${e.name}}}`){const e=document.createElement("div");e.className="slider_macros_search_result_value";const r=n.length>50?n.substring(0,50)+"...":n;e.textContent=`Current: ${r}`,t.appendChild(e)}}catch(e){}t.addEventListener("click",(()=>{s=e;const t=document.querySelector(".popup-button-ok");t&&t.click()})),o.appendChild(t)}))};a("");let i=null;r.addEventListener("input",(()=>{i&&clearTimeout(i),i=setTimeout((()=>{a(r.value)}),150)})),Rt.show.confirm("Search Existing Macros",t,{okButton:"Select",cancelButton:"Cancel"}).then((t=>{e(t&&s?s:null)})),setTimeout((()=>r.focus()),100)}))}))}();if(n){if(m.value=n.name,t.property=n.name,c.textContent=n.name,!t.name||"New Slider"===t.name){const e=n.name.replace(/[_-]/g," ").replace(/\b\w/g,(e=>e.toUpperCase()));p.value=e,t.name=e,l.textContent=e}R(),dn(e),Ft()}})))),f.addEventListener("input",(()=>{t.min=f.value,n(),zt()})),_.addEventListener("input",(()=>{t.max=_.value,n(),zt()})),g.addEventListener("input",(()=>{t.step=g.value,n(),zt()})),h.addEventListener("change",(()=>{t.enabled=h.checked,a.dataset.disabled=t.enabled?"false":"true",dn(e),Ft()})),b.addEventListener("click",(()=>jt(this,void 0,void 0,(function*(){if(!(yield Rt.show.confirm("Delete Slider",`Are you sure you want to delete the slider "${t.name}"?`)))return;const n=e.collections.find((e=>e.active));n&&(n.sliders.splice(o,1),cn(e),Ft())})))),x.addEventListener("click",(()=>{const n=e.collections.find((e=>e.active));if(n)if(t.groupId){const r=n.sliders.filter((e=>e.groupId===t.groupId)).sort(((e,t)=>e.order-t.order)),o=r.findIndex((e=>e===t));if(o>0){const n=r[o-1],s=t.order;t.order=n.order,n.order=s,cn(e),Ft()}}else{const r=[];n.groups.forEach((e=>r.push({order:e.order,isGroup:!0,ref:e}))),n.sliders.filter((e=>!e.groupId)).forEach((e=>r.push({order:e.order,isGroup:!1,ref:e}))),r.sort(((e,t)=>e.order-t.order));const o=r.findIndex((e=>!e.isGroup&&e.ref===t));if(o>0){const n=r[o-1],s=t.order;t.order=n.ref.order,n.ref.order=s,cn(e),Ft()}}})),w.addEventListener("click",(()=>{const n=e.collections.find((e=>e.active));if(n)if(t.groupId){const r=n.sliders.filter((e=>e.groupId===t.groupId)).sort(((e,t)=>e.order-t.order)),o=r.findIndex((e=>e===t));if(o<r.length-1){const n=r[o+1],s=t.order;t.order=n.order,n.order=s,cn(e),Ft()}}else{const r=[];n.groups.forEach((e=>r.push({order:e.order,isGroup:!0,ref:e}))),n.sliders.filter((e=>!e.groupId)).forEach((e=>r.push({order:e.order,isGroup:!1,ref:e}))),r.sort(((e,t)=>e.order-t.order));const o=r.findIndex((e=>!e.isGroup&&e.ref===t));if(o<r.length-1){const n=r[o+1],s=t.order;t.order=n.ref.order,n.ref.order=s,cn(e),Ft()}}})),s.content},a=[];r.groups.forEach(((e,t)=>{a.push({type:"group",group:e,groupIndex:t})})),r.sliders.forEach(((e,t)=>{e.groupId||a.push({type:"slider",slider:e,sliderIndex:t})})),a.sort(((e,t)=>("group"===e.type?e.group.order:e.slider.order)-("group"===t.type?t.group.order:t.slider.order)));const i=()=>{const e=[];return r.groups.forEach((t=>e.push({order:t.order,isGroup:!0,id:t.id}))),r.sliders.filter((e=>!e.groupId)).forEach((t=>e.push({order:t.order,isGroup:!1,id:t.property}))),e.sort(((e,t)=>e.order-t.order))};if(a.forEach((n=>{if("slider"===n.type){const e=s(n.slider,n.sliderIndex);t.list.appendChild(e)}else{const{group:o,groupIndex:a}=n,l=document.createElement("template");l.innerHTML=Mt;const c=l.content.querySelector(".slider_macros_group_card"),d=l.content.querySelector(".slider_macros_group_card_header"),u=l.content.querySelector(".slider_macros_group_card_name"),p=l.content.querySelector(".slider_macros_group_card_count"),m=l.content.querySelector(".slider_macros_group_sliders"),f=l.content.querySelector('input[name="groupName"]'),_=l.content.querySelector('button[name="deleteGroup"]'),g=l.content.querySelector('button[name="up"]'),h=l.content.querySelector('button[name="down"]'),y=r.sliders.map(((e,t)=>({slider:e,index:t}))).filter((e=>e.slider.groupId===o.id)).sort(((e,t)=>e.slider.order-t.slider.order));c.dataset.groupId=o.id,u.textContent=o.name||"New Group",p.textContent=`(${y.length} slider${1!==y.length?"s":""})`,f.value=o.name,y.forEach((({slider:e,index:t})=>{const n=s(e,t);m.appendChild(n)})),d.addEventListener("click",(e=>{if(e.target.closest(".slider_macros_card_controls"))return;const t="true"===c.dataset.expanded;c.dataset.expanded=t?"false":"true"})),f.addEventListener("input",(()=>{o.name=f.value,u.textContent=o.name||"New Group",zt()})),_.addEventListener("click",(()=>jt(this,void 0,void 0,(function*(){(yield Rt.show.confirm("Delete Group",`Are you sure you want to delete the group "${o.name}"? Sliders in this group will become ungrouped.`))&&(r.sliders.forEach((e=>{e.groupId===o.id&&(e.groupId=null)})),r.groups.splice(a,1),cn(e),Ft())})))),g.addEventListener("click",(t=>{t.stopPropagation();const n=i(),s=n.findIndex((e=>e.isGroup&&e.id===o.id));if(s>0){const t=n[s-1],a=o.order;if(t.isGroup){const e=r.groups.find((e=>e.id===t.id));e&&(o.order=e.order,e.order=a)}else{const e=r.sliders.find((e=>e.property===t.id&&!e.groupId));e&&(o.order=e.order,e.order=a)}cn(e),Ft()}})),h.addEventListener("click",(t=>{t.stopPropagation();const n=i(),s=n.findIndex((e=>e.isGroup&&e.id===o.id));if(s<n.length-1){const t=n[s+1],a=o.order;if(t.isGroup){const e=r.groups.find((e=>e.id===t.id));e&&(o.order=e.order,e.order=a)}else{const e=r.sliders.find((e=>e.property===t.id&&!e.groupId));e&&(o.order=e.order,e.order=a)}cn(e),Ft()}})),t.list.appendChild(l.content)}})),0===r.sliders.length&&0===r.groups.length){const e=document.createElement("div");e.classList.add("empty-message"),e.textContent='No custom sliders or groups. Click "Create Slider" or "Create Group" to add one.',t.list.appendChild(e)}dn(e)}function dn(e){tn();const t="slider_macros_drawer",n="slider_macros_main_container",r="slider_macros_completion_collections";let o=document.getElementById(t),s=document.getElementById(n);if(!o){o=document.createElement("div"),o.id=t,o.className="inline-drawer m-t-1 wide100p";const a=document.createElement("div");a.className="inline-drawer-toggle inline-drawer-header";const i=document.createElement("b");i.textContent="Custom Sliders",a.appendChild(i);const l=document.createElement("div");l.className="inline-drawer-icon fa-solid fa-circle-chevron-down down",a.appendChild(l),o.appendChild(a);const c=document.createElement("div");c.id="slider_macros_drawer_content",c.className="inline-drawer-content";const d=document.createElement("div");d.className="flex-container m-b-1";const u=document.createElement("span");u.textContent="Collection:",u.className="flex0",u.style.marginRight="10px",d.appendChild(u);const p=document.createElement("select");p.id=r,p.className="text_pole flex1",p.addEventListener("change",(()=>{const t=p.value;e.collections.forEach((e=>{e.active=e.name===t})),Ft(),cn(e)})),d.appendChild(p),c.appendChild(d),s=document.createElement("div"),s.id=n,s.className="slider_macros_container",c.appendChild(s),o.appendChild(c)}const a=document.getElementById("completion_prompt_manager");a&&(o.parentElement===a&&a.firstChild===o||a.insertBefore(o,a.firstChild)),s=document.getElementById(n);const i=document.getElementById(r);i.innerHTML="",e.collections.forEach((e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,t.selected=e.active,i.appendChild(t)})),s.innerHTML="";const l=e.collections.find((e=>e.active));if(!l)return;const c=(t,n)=>{if(!t.enabled||!t.property||!t.name)return;const r=document.createElement("template");r.innerHTML=Bt;const o=CSS.escape("slider_macro_"+t.property),s=r.content.querySelector(".range-block-title");if(document.getElementById(o))return toastr.warning("Duplicate slider property name: "+t.property),void console.warn("Duplicate slider detected:",o);if(s.textContent=t.name,console.log(`Rendering slider: ${t.name} (${t.type})`),"Numeric"!==t.type&&t.type){if("Boolean"===t.type){const n=r.content.querySelector(".range-block-range"),s=r.content.querySelector(".range-block-counter"),a=r.content.querySelector('input[type="range"]');n&&(n.style.display="",n.style.flex="1",n.style.width="100%");const i=document.createElement("span");i.style.marginLeft="10px",i.style.fontWeight="bold",s&&(s.style.display="",s.innerHTML="",s.appendChild(i)),a.id=o,a.min="0",a.max="1",a.step="1",a.value=(1-(t.value?1:0)).toString(),i.textContent=1==(t.value?1:0)?"True":"False";const l=()=>{const n=0===parseInt(a.value,10);t.value=n?1:0,i.textContent=n?"True":"False",Ft(),un(e)};a.addEventListener("input",l),$(a).on("input",l)}else if("MultiSelect"===t.type){const n=r.content.querySelector(".range-block-counter"),a=r.content.querySelector('input[type="range"]'),i=r.content.querySelector('input[type="number"]'),l=(t.options||[]).filter((e=>""!==e.trim()));if(l.length<2)return void(s.textContent+=" (Config Error: < 2 Options)");const c=document.createElement("span");c.style.marginLeft="10px",c.style.fontWeight="bold",n&&i&&(n.innerHTML="",n.appendChild(c)),a.id=o,a.min="0",a.max=(l.length-1).toString(),a.step="1",(t.value<0||t.value>=l.length)&&(t.value=0);const d=e=>e.length>10?e.substring(0,10)+"...":e;a.value=t.value.toString(),c.textContent=d(l[t.value]),c.title=l[t.value];const u=()=>{const n=parseInt(a.value,10);t.value=n;const r=l[n]||"";c.textContent=d(r),c.title=r,Ft(),un(e)};a.addEventListener("input",u),$(a).on("input",u)}else if("Dropdown"===t.type){const n=r.content.querySelector(".range-block-range"),a=r.content.querySelector(".range-block-counter"),i=(t.dropdownOptions||[]).filter((e=>""!==e.key.trim()));if(i.length<1)return void(s.textContent+=" (Config Error: No Options)");if(n){n.innerHTML="",n.style.flex="1";const r=document.createElement("select");r.id=o,r.className="text_pole slider_macros_dropdown_select",i.forEach((e=>{const n=document.createElement("option");n.value=e.key,n.textContent=e.key,t.value===e.key&&(n.selected=!0),r.appendChild(n)})),t.value&&i.find((e=>e.key===t.value))||(t.value=i[0].key,r.value=i[0].key),r.addEventListener("change",(()=>{t.value=r.value,Ft(),un(e)})),n.appendChild(r)}a&&(a.style.display="none")}else if("Color"===t.type){const n=r.content.querySelector(".range-block-range"),s=r.content.querySelector(".range-block-counter");if(n){n.innerHTML="",n.style.flex="1",n.style.display="flex",n.style.alignItems="center",n.style.gap="10px";const r=document.createElement("input");r.type="color",r.id=o,r.className="slider_macros_color_input",r.value="string"==typeof t.value&&t.value.startsWith("#")?t.value:"#ffffff";const s=document.createElement("input");s.type="text",s.className="text_pole slider_macros_color_hex",s.value=r.value.toUpperCase(),s.maxLength=7;const a=()=>{t.value=r.value,s.value=r.value.toUpperCase(),Ft(),un(e)},i=()=>{let n=s.value.trim();n.startsWith("#")||(n="#"+n),/^#[0-9A-Fa-f]{6}$/.test(n)&&(r.value=n,t.value=n,Ft(),un(e))};r.addEventListener("input",a),s.addEventListener("change",i),n.appendChild(r),n.appendChild(s)}s&&(s.style.display="none")}else if("Checkbox"===t.type){const n=r.content.querySelector(".range-block-range"),s=r.content.querySelector(".range-block-counter");if(n){n.innerHTML="",n.style.flex="1",n.style.display="flex",n.style.alignItems="center";const r=document.createElement("label");r.className="checkbox_label slider_macros_checkbox_label";const s=document.createElement("input");s.type="checkbox",s.id=o,s.checked=!0===t.value;const a=document.createElement("span");a.className="slider_macros_checkbox_text",a.textContent=!0===t.value?t.checkboxTrueValue||"true":t.checkboxFalseValue||"false",s.addEventListener("change",(()=>{t.value=s.checked,a.textContent=s.checked?t.checkboxTrueValue||"true":t.checkboxFalseValue||"false",Ft(),un(e)})),r.appendChild(s),r.appendChild(a),n.appendChild(r)}s&&(s.style.display="none")}}else{t.value<parseFloat(t.min)&&(t.value=parseFloat(t.min)),t.value>parseFloat(t.max)&&(t.value=parseFloat(t.max));const n=r.content.querySelector('input[type="range"]'),s=r.content.querySelector('input[type="number"]');n.id=o,n.min=t.min,n.max=t.max,n.step=t.step,n.value=t.value.toString(),s.id=o+"_number",s.min=t.min,s.max=t.max,s.step=t.step,s.value=t.value.toString(),s.dataset.for=o;const a=()=>{t.value=parseFloat(n.value),s.value=n.value,Ft(),un(e)};n.addEventListener("input",a),$(n).on("input",a)}n.appendChild(r.content)},d=[];l.groups.forEach((e=>{l.sliders.filter((t=>t.groupId===e.id)).filter((e=>e.enabled&&e.property&&e.name)).length>0&&d.push({type:"group",group:e})})),l.sliders.forEach((e=>{!e.groupId&&e.enabled&&e.property&&e.name&&d.push({type:"slider",slider:e})})),d.sort(((e,t)=>("group"===e.type?e.group.order:e.slider.order)-("group"===t.type?t.group.order:t.slider.order))),d.forEach((e=>{if("slider"===e.type)c(e.slider,s);else{const t=e.group,n=l.sliders.filter((e=>e.groupId===t.id)).sort(((e,t)=>e.order-t.order)),r=document.createElement("div");r.className="slider_macros_group",r.dataset.groupId=t.id,r.dataset.collapsed=t.collapsed?"true":"false";const o=document.createElement("div");o.className="slider_macros_group_header";const a=document.createElement("i");a.className="fa-solid fa-chevron-down slider_macros_group_chevron";const i=document.createElement("span");i.className="slider_macros_group_name",i.textContent=t.name;const d=document.createElement("span");d.className="slider_macros_group_count";const u=n.filter((e=>e.enabled&&e.property&&e.name)).length;d.textContent=`(${u})`,o.appendChild(a),o.appendChild(i),o.appendChild(d),o.addEventListener("click",(()=>{const e="true"===r.dataset.collapsed;r.dataset.collapsed=e?"false":"true",t.collapsed=!e,Ft()})),r.appendChild(o);const p=document.createElement("div");p.className="slider_macros_group_content",n.forEach((e=>c(e,p))),r.appendChild(p),s.appendChild(r)}})),un(e)}function un(e){const t=e.collections.find((e=>e.active));t&&t.sliders.forEach((e=>{if(!e.enabled||!e.property)return;let t;if("MultiSelect"===e.type){const n=(e.options||[]).filter((e=>""!==e.trim()));t=()=>n[e.value]||""}else t="Boolean"===e.type?()=>1===e.value?"true":"false":"Dropdown"===e.type?()=>{const t=e.value,n=(e.dropdownOptions||[]).find((e=>e.key===t));return n?n.value:t}:"Color"===e.type?()=>function(e,t){/^#[0-9A-Fa-f]{6}$/.test(e)||(e="#ffffff");if("hex"===t)return e.toUpperCase();const n=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16);if("rgb"===t)return`rgb(${n}, ${r}, ${o})`;const s=n/255,a=r/255,i=o/255,l=Math.max(s,a,i),c=Math.min(s,a,i),d=l-c;let u=0;0!==d&&(u=l===s?(a-i)/d%6:l===a?(i-s)/d+2:(s-a)/d+4,u=Math.round(60*u),u<0&&(u+=360));const p=0===l?0:Math.round(d/l*100),m=Math.round(100*l);return`hsv(${u}, ${p}%, ${m}%)`}(e.value||"#ffffff",e.colorFormat||"hex"):"Checkbox"===e.type?()=>!0===e.value?e.checkboxTrueValue||"true":e.checkboxFalseValue||"false":()=>e.value.toString();const n=`Slider Macro: ${e.name}`;Vt.experimental_macro_engine?Ut.register(e.property,{category:Ut.category.PROMPTS,description:n,handler:t}):Gt.registerMacro(e.property,t,n)}))}const pn=new MutationObserver(Qt((()=>{const e=en(),t=document.getElementById("completion_prompt_manager"),n=document.getElementById("slider_macros_drawer");!t||n&&n.parentElement===t||dn(e)}),500));!function(){jt(this,void 0,void 0,(function*(){const e=en();nn(e),dn(e),function(e){Dt.on(qt.OAI_PRESET_CHANGED_AFTER,(()=>{const t=Pt.preset_settings_openai,n=e.collections.find((e=>e.active));if(!n)return;const r=e.collections.find((e=>e.presets.includes(t)));r&&r!==n&&(r.active=!0,n.active=!1,Ft(),cn(e)),setTimeout((()=>{dn(e)}),500)}))}(e),pn.observe(document.body,{childList:!0,subtree:!0}),Ft()}))}()})();